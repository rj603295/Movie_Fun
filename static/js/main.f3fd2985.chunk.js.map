{"version":3,"sources":["WebAPI.js","context.js","utils.js","components/Header.js","components/Carousel/Carousel.js","components/Rating.js","components/RatingLoading/ZZ5H.gif","components/RatingLoading/RatingLoading.js","components/Movie.js","components/Person.js","components/Loading/giphy.gif","components/Loading/Loading.js","components/Comments.js","pages/HomePage/HomePage.js","pages/MovieDetailPage/MovieDetailPage.js","pages/SearchGenrePage/SearchGenrePage.js","pages/SearchPage/SearchPage.js","pages/CreditPage/CreditPage.js","pages/LoginPage/LoginPage.js","pages/RegisterPage/RegisterPage.js","pages/MemberPage/MemberPage.js","pages/AboutPage/AboutPage.js","config.js","components/Footer.js","App.js","reportWebVitals.js","index.js"],"names":["getMovieRating","id","fetch","then","res","json","getIMDBID","getSearchData","value","page","getMovieDeatil","getTrend","getGenre","getGenreSearch","getPeopleDetail","AuthContext","createContext","getUserDeviceType","navigator","userAgent","match","HeaderContainer","styled","div","Brand","Link","NavbarList","Nav","props","$active","Wrapper","Search","SearchIcon","button","HamList","Header","isHide","location","useLocation","history","useHistory","useState","search","setSearch","isHamOpen","setIsHamOpen","isHamSearchOpen","setIsHamSearchOpen","useContext","user","setUser","userDevice","useRef","useEffect","current","handleSearch","e","push","handleValueChange","target","handleLogout","auth","getAuth","signOut","catch","error","style","top","to","className","placeholder","onKeyPress","key","handleKeyPressSearch","onChange","onClick","icon","faSearch","pathname","faUserCircle","preventDefault","faBars","right","React","memo","prevProps","nextProps","Item","children","CAROUSEL_ITEM","Carousel","cols","gap","currentPage","setCurrentPage","startX","startY","endX","endY","itemList","Children","toArray","filter","child","type","displayName","itemSetList","reduce","result","item","i","length","Math","ceil","handlePrev","useCallback","p","handleNext","onTouchStart","console","log","touches","pageX","pageY","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","X","Y","abs","handleTouchEnd","hidden","gridTemplateColumns","left","gridColumnGap","map","set","display","gridGap","RatingList","Score","span","Rating","Ratings","logoWidth","IMDB","tomatoes","Metacritic","Source","Value","alt","src","Container","ImgContainer","Loading","isLoading","loadingImg","MovieContainer","RatingListRow","Heart","Movie","movie","rating","isRating","isRatingLoading","imgUrl","poster_path","userFavorite","db","getDatabase","keysArr","Object","keys","backgroundImage","includes","toString","runTransaction","ref","uid","checkData","onValue","snapshot","data","val","obj","faCheck","faPlus","CreditName","Person","person","isName","profile_path","name","CommentContainer","isMobileDevice","TitleWrapper","ThumbWrapper","Date","Thumb","TitleSection","column","RWDS_column","ButtonSection","TitleAndDate","TitleMargin","EditButton","Content","Comments","comment","handleCommentOpen","isPosterOpen","isThumbsUpOpen","setMovie","isEdit","setIsEdit","titleValue","setTitleValue","contentValue","setContentValue","thumbsUpUsers","thumbs_up_user","movie_id","handleThumbsUp","thumbs_up","title","handleTitleValue","display_name","date","content","window","confirm","faThumbsUp","handleContentValue","update","Title","h2","CarouselConatiner","Section","RecommendationSection","Recommedation","RecommendationTitle","RecommedationContent","RecommedationRating","PopularSection","TypeSection","UpcommingSection","SubTitle","HotPeopleSection","HotCommentsSection","Credits","credits","index","HomePage","movies","setMovies","setRating","trend","setTrend","upcomming","setUpcomming","genres","setGenre","hotPeople","setHotPeople","hotComments","setHotComments","setIsLoading","Array","fill","setIsRatingLoading","a","imdb_id","results","sort","b","popularity","trendData","err","ratingArr","prevState","getFirstHotMovie","genreArr","mostThumbsUpPosts","query","orderByValue","limitToFirst","keyArr","arr","arr2","prevCount","prev","getPopularMovieRating","backgroundColor","backdrop_path","overview","genre","LeftContainer","RightContainer","DetailContainer","Recommendations","RecommendImgContainer","MovieDetailContent","ul","MovieVideoSection","MovieImgSection","MovieImg","img","Keyword","CommentSection","Pagination","AddCommentSection","AddCommentColumn","NoComment","MovieDetailPage","recommendations","setRecommendations","setCredits","director","setDirector","video","setVideo","images","setImages","comments","setComments","commentTitle","setcommentTitle","commentContent","setcommentContent","isCommentInputOpen","setisCommentInputOpen","currentCommentPage","setCurrentCommentPage","totalCommentPage","settotalCommentPage","useParams","posts","orderByChild","equalTo","len","totalPage","reverse","getComments","useColor","crossOrigin","quality","backgroundMask","colorStr","str","red","green","blue","getVideo","videoArr","getSimilar","getCredits","crew","job","cast","getMovieImage","imgArr","backdrops","handleCommentPage","isNextPage","color","release_date","substr","runtime","homepage","keywords","border","file_path","frameborder","allow","allowfullscreen","Today","month","day","getMonth","getDate","getFullYear","created_at","getTime","providerData","writeUserData","alert","ResultContainer","TypeTitle","PageContainer","ItemContainer","SearchGenrePage","setTotalPage","total_pages","getMoviesRatings","handlePageChange","scrollTo","ContentContainer","ClassificationList","NotFoundMessage","Filter","li","People","known_for","SearchMovie","SearchPage","searchItemGenreID","setsearchItemGenreID","currentType","setCurrentType","allCount","movieCount","peopleCount","typesCount","settypesCount","isTypeListOpen","setIsTypeListOpen","currentGenre","setCurrentGenre","forEach","media_type","genre_ids","genreID","find","itemID","getSearchMovieRating","nodeName","dataset","handleCurrentType","handleCurrentGenre","genreFilter","some","PersonContainer","PersonContent","FamousMovieSection","Biography","LanguageButton","CreditPage","setPerson","biography","setBiography","biographyLang","setBiographyLang","famousMovie","setfamousMovie","otherMovie","setotherMovie","getPeopleMovies","slice","handleBioLanguage","language","getPeopleDetailEng","birthday","place_of_birth","LoginSection","ErrorMessage","LoginPage","username","setUsername","password","setPassword","errorMessage","setErrorMessage","setPersistence","browserLocalPersistence","signInWithEmailAndPassword","userCredential","currentUser","errorCode","code","nickname","setNickname","createUserWithEmailAndPassword","updateProfile","MemberDetailSection","FavoriteMovieSection","FavoriteContainer","PhoneSection","PersonalCommentSection","MemberPage","favoriteID","setFavoriteID","favoriteMovie","setFavoriteMovie","personalComments","setPersonalComments","isNicknameEdit","setIsNicknameEdit","nicknameValue","setNicknameValue","memberFavoriteRef","fetchData","handleNicknameInputOpen","email","emailVerified","handleNicknameInputChange","trim","AboutSection","LogoSection","AboutPage","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","FooterContainer","BrandSection","Footer","href","rel","faGithub","faFacebook","faInstagram","faTwitter","faYoutube","faCopyright","App","setIsHide","setUserFavorite","lastScrollY","initializeApp","onAuthStateChanged","addEventListener","st","scrollY","handleScroll","movieRef","getFavorite","Provider","exact","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"gOAGaA,EAAiB,SAACC,GAAD,OAAQC,MAAM,8BAAD,OAA+BD,EAA/B,kCAC1CE,MAAK,SAACC,GAAD,OAASA,EAAIC,WAENC,EAAY,SAACL,GAAD,OAAQC,MAAM,sCAAD,OAAuCD,EAAvC,2DACrCE,MAAK,SAACC,GAAD,OAASA,EAAIC,WAENE,EAAgB,SAACC,GAAD,IAAQC,EAAR,uDAAa,EAAb,OAAmBP,MAAM,2GAAD,OAA4GM,EAA5G,iBAA0HC,IAC9KN,MAAK,SAACC,GAAD,OAASA,EAAIC,WAENK,EAAiB,SAACT,GAAD,OAAQC,MAAM,sCAAD,OAAuCD,EAAvC,sGAC1CE,MAAK,SAACC,GAAD,OAASA,EAAIC,WAWNM,EAAW,kBAAMT,MAAM,4GACnCC,MAAK,SAACC,GAAD,OAASA,EAAIC,WAENO,EAAW,kBAAMV,MAAM,yGACnCC,MAAK,SAACC,GAAD,OAASA,EAAIC,WAENQ,EAAiB,SAACZ,GAAD,IAAKQ,EAAL,uDAAU,EAAV,OAAgBP,MAAM,6HAAD,OAA8HD,EAA9H,iBAAyIQ,IAC3LN,MAAK,SAACC,GAAD,OAASA,EAAIC,WAWNS,EAAkB,SAACb,GAAD,OAAQC,MAAM,uCAAD,OAAwCD,EAAxC,qGAC3CE,MAAK,SAACC,GAAD,OAASA,EAAIC,W,wBCzCbU,EAAcC,wBAAc,MC0BrBC,EAAoB,WAC/B,SAAIC,UAAUC,UAAUC,MAAM,aAC5BF,UAAUC,UAAUC,MAAM,WAC1BF,UAAUC,UAAUC,MAAM,YAC1BF,UAAUC,UAAUC,MAAM,UAC1BF,UAAUC,UAAUC,MAAM,UAC1BF,UAAUC,UAAUC,MAAM,gBAC1BF,UAAUC,UAAUC,MAAM,oB,OCzBxBC,EAAkBC,IAAOC,IAAV,6XAsBfC,EAAQF,YAAOG,IAAPH,CAAH,2NAWLI,EAAaJ,IAAOC,IAAV,iRAkBVI,EAAML,YAAOG,IAAPH,CAAH,uUAWL,SAACM,GAAD,OAAWA,EAAMC,SAAN,8CASTC,EAAUR,IAAOC,IAAV,mPAaPQ,EAAST,IAAOC,IAAV,2oBAmCNS,EAAaV,IAAOW,OAAV,maAqBVC,EAAUZ,IAAOC,IAAV,knBAqCb,SAASY,EAAT,GAA6B,IAAXC,EAAU,EAAVA,OACVC,EAAWC,cACXC,EAAUC,cAChB,EAA4BC,mBAAS,IAArC,mBAAOC,EAAP,KAAeC,EAAf,KACA,EAAkCF,oBAAS,GAA3C,mBAAOG,EAAP,KAAkBC,EAAlB,KACA,EAA8CJ,oBAAS,GAAvD,mBAAOK,EAAP,KAAwBC,EAAxB,KACA,EAA0BC,qBAAWjC,GAA7BkC,EAAR,EAAQA,KAAMC,EAAd,EAAcA,QACRC,EAAaC,mBAEnBC,qBAAU,WACRF,EAAWG,QAAUrC,MACpB,IAEH,IAaMsC,EAAe,SAACC,GACpBb,EAAU,IACVpC,EAAcmC,GAAQvC,MAAK,SAACC,GAC1BmC,EAAQkB,KAAR,wBAA8Bf,QAG5BgB,EAAoB,SAACF,GACzBb,EAAUa,EAAEG,OAAOnD,QAGfoD,EAAe,WACnB,IAAMC,EAAOC,cACbC,YAAQF,GAAM1D,MAAK,WACjB+C,EAAQ,SAEPc,OAAM,SAACC,GACR,OAAOA,MAmBX,OALAZ,qBAAU,YACO,IAAXjB,GACFS,GAAa,KAEf,CAACT,IAED,eAACf,EAAD,CAAiB6C,MAAQf,EAAWG,QAA6C,CAACa,IAAK,OAAzC,CAACA,IAAK/B,EAAS,SAAW,OAAxE,UACE,eAACN,EAAD,WACE,cAACN,EAAD,CAAO4C,GAAG,IAAV,6BACA,eAACrC,EAAD,CAAQsC,UAAU,QAAlB,UACA,uBAAO7D,MAAOkC,EAAQ4B,YAAY,qEAAmBC,WAAY,SAACf,IArD3C,SAACA,GACf,UAAVA,EAAEgB,MACH7B,EAAU,IACVpC,EAAcmC,GAAQvC,MAAK,SAACC,GAC1BmC,EAAQkB,KAAR,wBAA8Bf,OAEhCK,GAAmB,IA+CwD0B,CAAqBjB,IAAKkB,SAAU,SAAClB,GAAOE,EAAkBF,MACvI,cAACxB,EAAD,CAAY2C,QAASpB,EAArB,SAAoC,cAAC,IAAD,CAAiBqB,KAAMC,WAE3D,eAACnD,EAAD,WACE,cAACC,EAAD,CAAK0C,UAAU,QAAQD,GAAG,SAASvC,QAA+B,WAAtBQ,EAASyC,SAArD,oBACE7B,GAAQ,cAACtB,EAAD,CAAK0C,UAAU,QAAQD,GAAG,SAA1B,0BACTnB,GAAQ,cAACtB,EAAD,CAAK0C,UAAU,QAAQD,GAAG,SAASO,QAASf,EAA5C,0BACT,cAACjC,EAAD,CAAKyC,GAAG,UAAUC,UAAU,QAA5B,SAAoC,cAAC,IAAD,CAAiBO,KAAMG,QAC1D,cAACpD,EAAD,CAAKyC,GAAG,GAAGC,UAAU,QAAQM,QA5BT,SAACnB,GAC5BA,EAAEwB,iBACFnC,GAAa,GACbE,GAAoBD,IAyBb,SAA4D,cAAC,IAAD,CAAiB8B,KAAMC,QACpF,cAAClD,EAAD,CAAK0C,UAAU,MAAMD,GAAG,GAAGO,QAxBT,SAACnB,GACzBA,EAAEwB,iBACFnC,GAAcD,GACdG,GAAmB,IAqBb,SAAuD,cAAC,IAAD,CAAiB6B,KAAMK,cAIlF,eAAC/C,EAAD,CAASgC,MAAO,CAACgB,MAAOtC,EAAY,KAAO,UAA3C,WACIK,GAAQ,cAACtB,EAAD,CAAKyC,GAAG,SAAR,0BACTnB,GAAQ,cAACtB,EAAD,CAAKyC,GAAG,SAASO,QAASf,EAA1B,0BACT,cAACjC,EAAD,CAAKyC,GAAG,UAAR,SAAmB,cAAC,IAAD,CAAiBQ,KAAMG,QAC1C,cAACpD,EAAD,CAAKyC,GAAG,SAASvC,QAA+B,WAAtBQ,EAASyC,SAAnC,sBAEF,cAAC/C,EAAD,CAAQsC,UAAU,QAAlB,SACKvB,GAAmB,uBAAOtC,MAAOkC,EAAQ4B,YAAY,qEAAmBC,WAAY,SAACf,GAAOD,KAAkBmB,SAAU,SAAClB,GAAOE,EAAkBF,WAS9I2B,UAAMC,KAAKjD,GAAQ,SAACkD,EAAWC,GAE5C,OAAID,EAAUjD,SAAWkD,EAAUlD,U,+CCzR/BmD,G,MAAO,SAAC,GAAD,IAAGC,EAAH,EAAGA,SAAH,OAAkB,8BAAMA,MAE/BC,EAAgB,gBAChBC,EAAW,SAAC,GAAsC,IAAD,IAAnCC,YAAmC,MAA5B,EAA4B,MAAzBC,WAAyB,MAAnB,GAAmB,EAAfJ,EAAe,EAAfA,SACtC,EAAsC/C,mBAAS,GAA/C,mBAAOoD,EAAP,KAAoBC,EAApB,KAYIC,EAAS,EACTC,EAAS,EACTC,EAAO,EACPC,EAAO,EAELC,EAAWhB,IAAMiB,SAASC,QAAQb,GAAUc,QAChD,SAAAC,GAAK,OAAIA,EAAMC,KAAKC,cAAgBhB,KAGhCiB,EAAcP,EAASQ,QAAO,SAACC,EAAQC,EAAMC,GAOjD,OANIA,EAAInB,IAAS,EACfiB,EAAOnD,KAAK,CAAC,cAAC,EAAD,UAAeoD,GAAJC,KAExBF,EAAOA,EAAOG,OAAS,GAAGtD,KAAK,cAAC,EAAD,UAAeoD,GAAJC,IAGrCF,IACN,IAEGnG,EAAOuG,KAAKC,KAAKd,EAASY,OAASpB,GAEnCuB,EAAaC,uBAAY,WAC7BrB,GAAe,SAAAsB,GAAC,OAAIA,EAAI,OACvB,IAEGC,EAAaF,uBAAY,WAC7BrB,GAAe,SAAAsB,GAAC,OAAIA,EAAI,OACvB,IAkDH,OACE,sBAAK/C,UAAU,WAAWiD,aAAc,SAAC9D,GAAD,OAhDjB,SAACA,GAExB+D,QAAQC,IAAI,QAAQhE,EAAEiE,QAAQ,GAAGC,OAGjC3B,EAASvC,EAAEiE,QAAQ,GAAGC,MACtB1B,EAASxC,EAAEiE,QAAQ,GAAGE,MA0CyBC,CAAiBpE,IAAIqE,YAAa,SAAArE,GAAC,OAxC5D,SAACA,GACvB+D,QAAQC,IAAI,OAAOhE,EAAEiE,QAAQ,GAAGC,OAIhCzB,EAAOzC,EAAEiE,QAAQ,GAAGC,MACpBxB,EAAO1C,EAAEiE,QAAQ,GAAGE,MAkCkEG,CAAgBtE,IAAIuE,WAAY,SAACvE,GAAD,OA/BjG,SAACA,GACtB,IAAIwE,EAAI/B,EAAOF,EACXkC,EAAI/B,EAAOF,EACfuB,QAAQC,IAAI,IAAKQ,GACbA,EAAI,GAAKhB,KAAKkB,IAAIF,GAAKhB,KAAKkB,IAAID,IAE9BpC,EAAc,GAChBC,GAAe,SAAAsB,GAAC,OAAIA,EAAI,KAG1BG,QAAQC,IAAI,iBACHQ,EAAI,GAAKhB,KAAKkB,IAAIF,GAAKhB,KAAKkB,IAAID,IAEzCV,QAAQC,IAAI,gBACT3B,IAAgBpF,EAAO,GACxBqF,GAAe,SAAAsB,GAAC,OAAIA,EAAI,MAGjBa,EAAI,GAAKjB,KAAKkB,IAAID,GAAKjB,KAAKkB,IAAIF,GAEzCT,QAAQC,IAAI,gBACHS,EAAI,GAAKjB,KAAKkB,IAAID,GAAKjB,KAAKkB,IAAIF,GAEzCT,QAAQC,IAAI,gBAGZD,QAAQC,IAAI,gBAK+GW,IAA7H,UACE,sBACE9D,UAAU,sBACV+D,OAAQvC,GAAe,EACvBlB,QAASuC,IAEX,qBAAK7C,UAAU,wBAAf,SACE,qBACEA,UAAU,iBACVH,MAAO,CACLmE,oBAAoB,UAAD,OAAY5H,EAAZ,WACnB6H,KAAK,QAAD,QAAW,IAAMzC,EAAjB,eAAmCD,EAAMC,EAAzC,OACJ0C,cAAc,GAAD,OAAK3C,EAAL,OALjB,SAQGc,EAAY8B,KAAI,SAACC,EAAK3B,GAAN,OACf,qBAEEzC,UAAU,oBACVH,MAAO,CACLwE,QAAS,OACTL,oBAAoB,UAAD,OAAY1C,EAAZ,UACnBgD,QAAQ,GAAD,OAAK/C,EAAL,OANX,SASG6C,GARI3B,UAab,sBACEzC,UAAU,sBACV+D,OAAQvC,IAAgBpF,EAAO,EAC/BkE,QAAS0C,SAMjB3B,EAASH,KAAO,qBAAGC,WACLiB,YAAchB,EACbC,I,KAAAA,KCvITkD,GAAatH,IAAOC,IAAV,2rBA0CVsH,GAAQvH,IAAOwH,KAAV,4EAKI,SAASC,GAAT,GAA8C,IAA7BC,EAA4B,EAA5BA,QAA4B,IAAnBC,iBAAmB,MAAT,OAAS,EAEtDC,EAAO,GACPC,EAAW,GACXC,EAAa,GACjB,GAAIJ,EACF,IAAI,IAAIlC,EAAI,EAAGA,EAAIkC,EAAQjC,OAAQD,IACP,4BAAtBkC,EAAQlC,GAAGuC,SACbH,EAAOF,EAAQlC,GAAGwC,OAEM,oBAAtBN,EAAQlC,GAAGuC,SACbF,EAAWH,EAAQlC,GAAGwC,OAEE,eAAtBN,EAAQlC,GAAGuC,SACbD,EAAaJ,EAAQlC,GAAGwC,OAI9B,OACE,eAACV,GAAD,CAAYK,UAAWA,EAAvB,UACE,+BAAI,qBAAK5E,UAAU,OAAf,SAAsB,qBAAKA,UAAU,cAAckF,IAAI,GAAGC,IAAI,6EAAgF,cAACX,GAAD,UAAiB,KAATK,EAAcA,EAAO,YAC/K,+BAAI,qBAAK7E,UAAU,OAAf,SAAsB,qBAAKA,UAAU,cAAckF,IAAI,GAAGC,IAAI,mFAAsF,cAACX,GAAD,UAAsB,KAAdM,EAAmBA,EAAW,YAC9L,+BAAI,qBAAK9E,UAAU,OAAf,SAAsB,qBAAKA,UAAU,cAAckF,IAAI,GAAGC,IAAI,8EAAiF,cAACX,GAAD,UAAwB,KAAhBO,EAAqBA,EAAa,eCxEpL,I,qBAAA,OAA0B,iCCInCK,GAAYnI,IAAOC,IAAV,mNAaTmI,GAAepI,IAAOC,IAAV,oHAMH,SAASoI,GAAT,GAAwC,IAAD,IAAnBC,iBAAmB,SAEpD,OACE,8BACGA,GAAa,cAACH,GAAD,UACZ,cAACC,GAAD,UACE,qBAAKF,IAAKK,GAAYN,IAAI,WCdpC,IAAMO,GAAiBxI,IAAOC,IAAV,+DAIdmI,GAAepI,YAAOG,IAAPH,CAAH,yQAYZyI,GAAgBzI,IAAOC,IAAV,4lBAoCbyI,GAAQ1I,IAAOC,IAAV,qdA4BLsH,GAAQvH,IAAOwH,KAAV,4EAIX,SAASmB,GAAT,GAI4B,IAH1BC,EAGyB,EAHzBA,MACAC,EAEyB,EAFzBA,OAEyB,IADzBC,gBACyB,aAAzBC,uBAAyB,SAEnBC,EAAM,yCAAqCJ,EAAMK,aACnDtK,EAAKiK,EAAMjK,GACPgD,EAASD,qBAAWjC,GAApBkC,KACAuH,EAAiBxH,qBAAWjC,GAA5ByJ,aACFC,EAAKC,cACPC,EAAU,GACO,OAAjBH,GAAgE,IAArCI,OAAOC,KAAKL,GAAczD,SACvD4D,EAAUC,OAAOC,KAAKL,IAExB,IAAItB,EAAO,GACPC,EAAW,GACXC,EAAa,GACjB,GAAIe,EACF,IAAI,IAAIrD,EAAI,EAAGA,EAAIqD,EAAOpD,OAAQD,IACP,4BAArBqD,EAAOrD,GAAGuC,SACZH,EAAOiB,EAAOrD,GAAGwC,OAEM,oBAArBa,EAAOrD,GAAGuC,SACZF,EAAWgB,EAAOrD,GAAGwC,OAEE,eAArBa,EAAOrD,GAAGuC,SACZD,EAAae,EAAOrD,GAAGwC,OAuC7B,OACE,cAACQ,GAAD,UACE,eAAC,GAAD,CACA5F,MAAO,CAAC4G,gBAAiBZ,EAAMK,YAAN,eAA4BD,EAA5B,6GAAgJlG,GAAE,iBAAYnE,GADvL,UAECgD,GACD,cAAC+G,GAAD,CAAOrF,QAvCiB,SAACnB,GAG3B,GAFAA,EAAEwB,iBAEC/B,GAAQ0H,EAAQI,SAAS9K,EAAG+K,YAC7BC,YAAeC,YAAIT,EAAI,YAAcxH,EAAKkI,MAAM,SAACjB,GAK/C,OAJA3C,QAAQC,IAAI,UACR0C,IACFA,EAAM,GAAD,OAAIjK,IAAQ,MAEZiK,UAEJ,GAAIjH,IAAS0H,EAAQI,SAAS9K,EAAG+K,YAAa,CACnD,IAAII,EAKJ,GAJAC,YAAQH,YAAIT,EAAI,YAAcxH,EAAKkI,MAAM,SAACG,GACxC,IAAMC,EAAOD,EAASE,MACtBJ,EAAYG,KAEVH,EAKFH,YAAeC,YAAIT,EAAI,YAAcxH,EAAKkI,MAAM,SAACjB,GAO/C,OANIA,IACoB,IAAnBS,EAAQ5D,SACTmD,EAAM,GAAD,OAAIjK,IAAQ,IAEnBiK,EAAM,GAAD,OAAIjK,IAAQ,GAEZiK,SAZI,CACb,IAAIuB,EAAM,GACVA,EAAI,GAAD,OAAIxL,IAAQ,EACfwI,YAAIyC,YAAIT,EAAI,YAAcxH,EAAKkI,KAAMM,MAmBvC,SACGd,EAAQI,SAAS9K,EAAG+K,YAAc,cAAC,IAAD,CAAiBpG,KAAM8G,MAAc,cAAC,IAAD,CAAiB9G,KAAM+G,QAE9FvB,GACD,eAACL,GAAD,WACE,cAAC,GAAD,CAAeH,UAAWS,IAC1B,+BAAI,qBAAKhG,UAAU,cAAckF,IAAI,GAAGC,IAAI,2EAA0E,cAAC,GAAD,UAAiB,KAATN,EAAcA,EAAO,YACnJ,+BAAI,qBAAK7E,UAAU,cAAckF,IAAI,GAAGC,IAAI,iFAAgF,cAAC,GAAD,UAAsB,KAAdL,EAAmBA,EAAW,YAClK,+BAAI,qBAAK9E,UAAU,cAAckF,IAAI,GAAGC,IAAI,4EAA2E,cAAC,GAAD,UAAwB,KAAhBJ,EAAqBA,EAAa,oBAO5JjE,I,MAAAA,OAAMC,KAAK6E,IAAO,SAAC5E,EAAWC,GAE3C,OAAID,EAAUgF,kBAAoB/E,EAAU+E,mBCvLxCX,GAAepI,YAAOG,IAAPH,CAAH,sPAYZsK,GAAatK,IAAO8F,EAAV,8HAOD,SAASyE,GAAT,GAA2C,IAAxBC,EAAuB,EAAvBA,OAAuB,IAAfC,cAAe,SACvD,OACE,gCACA,cAAC,GAAD,CAAc7H,MAAO,CACnB4G,gBAAiBgB,EAAOE,aAAP,8CAA6DF,EAAOE,aAApE,6GAChB5H,GAAE,kBAAa0H,EAAO7L,MAExB8L,GAAU,cAACH,GAAD,UAAaE,EAAOG,UC9BpB,I,uCAAA,OAA0B,kCCInCxC,GAAYnI,IAAOC,IAAV,+MAaTmI,GAAepI,IAAOC,IAAV,oHAMH,SAASoI,GAAT,GAAwC,IAAD,IAAnBC,iBAAmB,SAEpD,OACE,8BACGA,GAAa,cAAC,GAAD,UACZ,cAAC,GAAD,UACE,qBAAKJ,IAAKK,GAAYN,IAAI,WCnBpC,I,6CAAM2C,GAAmB5K,IAAOC,IAAV,oTAaL,SAAAK,GAAK,OAAIA,EAAMuK,eAAiB,UAAY,MAOvDC,GAAe9K,IAAOC,IAAV,iIAUZ8K,GAAe/K,IAAOC,IAAV,4TAgBZ+K,GAAOhL,IAAOwH,KAAV,kCAGJyD,GAAQjL,IAAOwH,KAAV,8SAgBL0D,GAAelL,IAAOC,IAAV,whBAMS,SAAAK,GAAK,OAAIA,EAAM6K,UAgBb,SAAA7K,GAAK,OAAIA,EAAM8K,eAGtChD,GAAepI,YAAOG,IAAPH,CAAH,4RAeZqL,GAAgBrL,IAAOC,IAAV,kEAKbqL,GAAetL,IAAOC,IAAV,gNAED,SAAAK,GAAK,OAAIA,EAAMiL,eAY1BC,GAAaxL,IAAOC,IAAV,iDAGVwL,GAAUzL,IAAO8F,EAAV,yKASE,SAAS4F,GAAT,GAA4F,IAAxEC,EAAuE,EAAvEA,QAASC,EAA8D,EAA9DA,kBAA8D,IAA3CC,oBAA2C,aAAvBC,sBAAuB,SAChGnK,EAASD,qBAAWjC,GAApBkC,KACFV,EAAUC,cAChB,EAA0BC,mBAAS,MAAnC,mBAAOyH,EAAP,KAAcmD,EAAd,KACA,EAA4B5K,oBAAS,GAArC,mBAAO6K,EAAP,KAAeC,EAAf,KACA,EAAoC9K,mBAAS,IAA7C,mBAAO+K,EAAP,KAAmBC,EAAnB,KACA,EAAwChL,mBAAS,IAAjD,mBAAOiL,EAAP,KAAqBC,EAArB,KACIC,EAAgB,GAEjBX,EAAQY,iBACTD,EAAgBhD,OAAOC,KAAKoC,EAAQY,iBAEtCxK,qBAAU,WACR3C,EAAeuM,EAAQa,UAAU3N,MAAK,SAACC,GACrCiN,EAASjN,QAEV,CAAC6M,EAAQa,WAGZ,IAAMC,EAAiB,WACrB,IAAMtD,EAAKC,cACPzH,GACFV,EAAQkB,KAAK,UAEZR,GAAQ2K,EAAc7C,SAAS9H,EAAKkI,KACrCF,YAAeC,YAAIT,EAAI,YAAcwC,EAAQhN,KAAK,SAACgN,GAKjD,OAJIA,IACFA,EAAQe,YACRf,EAAQY,eAAe5K,EAAKkI,KAAO,MAE9B8B,KAEAhK,IAAS2K,EAAc7C,SAAS9H,EAAKkI,MAC9CF,YAAeC,YAAIT,EAAI,YAAcwC,EAAQhN,KAAK,SAACgN,GAQjD,OAPIA,IACFA,EAAQe,YACoB,IAAzBJ,EAAc7G,SACfkG,EAAQY,eAAiB,IAE3BZ,EAAQY,eAAe5K,EAAKkI,KAAO,GAE9B8B,MAoCb,OACE,eAACf,GAAD,CAAkBC,eAAgBlL,IAAlC,UACE,cAACmL,GAAD,UACE,eAACI,GAAD,CAAcC,OAAQU,EAAgB,cAAgB,UAAWT,YAAaS,EAAgB,cAAgB,UAA9G,UAEKA,GAAgBjD,GACjB,cAAC,GAAD,CAAc9F,GAAE,gBAAW6I,EAAQa,UAAY5J,MAAO,CAAC4G,gBAAgB,uCAAD,OAAyCZ,EAAMK,YAA/C,SACtE,eAACqC,GAAD,CAAcC,YAAaM,EAAe,MAAQ,IAAlD,WACEG,GAAU,oBAAI3I,QAAS,kBAAMuI,EAAkBD,EAAQhN,KAA7C,SAAmDgN,EAAQgB,QACtEX,GAAU,uBAAO9G,KAAK,OAAOhG,MAAOgN,EAAY9I,SAAU,SAAClB,IAzC7C,SAACA,GACxBiK,EAAcjK,EAAEG,OAAOnD,OAwCoD0N,CAAiB1K,MAClF,iCAAM,+BAAOyJ,EAAQkB,eAArB,4BAA8C,cAAC,GAAD,UAAOlB,EAAQmB,UAC5DnL,GACAA,EAAKkI,MAAQ8B,EAAQ9B,KACtB,eAAC2B,GAAD,WACE,wBAAQnI,QAxCI,SAACnB,GACzB+J,GAAU,GACVE,EAAcR,EAAQgB,OACtBN,EAAgBV,EAAQoB,UAqCZ,0BACA,wBAAQ1J,QAvBM,WAC1B,IAAM8F,EAAKC,cACR4D,OAAOC,QAAQ,qDAChB9F,YAAIyC,YAAIT,EAAI,YAAcwC,EAAQhN,IAAK,KAoB7B,gCAMN,cAACoM,GAAD,UACGe,IAAmBnK,GAAQ2K,EAAc7C,SAAS9H,EAAKkI,KACxD,eAACoB,GAAD,CAAO5H,QAASoJ,EAAgB1J,UAAU,YAA1C,UAAsD,cAAC,IAAD,CAAiBO,KAAM4J,MAA7E,IAA6FvB,EAAQe,aAAqB,eAACzB,GAAD,CAAO5H,QAASoJ,EAAhB,UAAgC,cAAC,IAAD,CAAiBnJ,KAAM4J,MAAvD,IAAuEvB,EAAQe,sBAI7Mf,EAAQ7K,SAAWkL,GAAU,cAACP,GAAD,UAAUE,EAAQoB,UAChDf,GAAU,0BAAU9G,KAAK,OAAOhG,MAAOkN,EAAchJ,SAAU,SAAClB,IAzD1C,SAACA,GAC1BmK,EAAgBnK,EAAEG,OAAOnD,OAwDiDiO,CAAmBjL,MAC1F8J,GACD,eAACX,GAAD,WACI,wBAAQhI,QA/CY,SAACnB,GAC3B,IAAMiH,EAAKC,cACXgE,YAAOxD,YAAIT,EAAI,YAAcwC,EAAQhN,IAAK,CACxCgO,MAAOT,EACPa,QAASX,IAEXH,GAAU,IAyCJ,0BACA,wBAAQ5I,QArDgB,SAACnB,GAC/B+J,GAAU,GACVE,EAAc,IACdE,EAAgB,KAkDV,gCCpOV,IAAMgB,GAAQrN,IAAOsN,GAAV,mHAOL9E,GAAiBxI,IAAOC,IAAV,6UAqBdsN,GAAoBvN,IAAOC,IAAV,kUAoBjBuN,GAAUxN,IAAOC,IAAV,qDAGPwN,GAAwBzN,IAAOC,IAAV,yOAWrByN,GAAgB1N,IAAOC,IAAV,2NAYb0N,GAAsB3N,IAAOsN,GAAV,gLASnBM,GAAuB5N,IAAO8F,EAAV,2LAUpB+H,GAAsB7N,IAAOC,IAAV,sGAMnB6N,GAAiB9N,IAAOC,IAAV,4OAgBd8N,GAAc/N,IAAOC,IAAV,siBA4BX+N,GAAmBhO,IAAOC,IAAV,gCAGhBgO,GAAWjO,IAAO8F,EAAV,+CAGRoI,GAAmBlO,IAAOC,IAAV,4EAIhBkO,GAAqBnO,IAAOC,IAAV,oLAUxB,SAASmO,GAAT,GAA+B,IAAZC,EAAW,EAAXA,QACjB,OACE,eAACd,GAAD,WACE,qBAAKxK,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,EAAxB,SACG+J,EAAQnH,KAAI,SAAC3B,EAAM+I,GAAP,OACX,cAAC,GAASrK,KAAV,UACuB,SAAtBsB,EAAKmF,cACJ,8BACE,cAACH,GAAD,CAAQC,OAAQjF,OAHAA,EAAK5G,WAS7B,qBAAKoE,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,EAAxB,SACG+J,EAAQnH,KAAI,SAAC3B,EAAM+I,GAAP,OACX,cAAC,GAASrK,KAAV,UACuB,SAAtBsB,EAAKmF,cACJ,8BACE,cAACH,GAAD,CAAQC,OAAQjF,OAHAA,EAAK5G,cAapB,SAAS4P,KACtB,MAA4BpN,mBAAS,IAArC,mBAAOqN,EAAP,KAAeC,EAAf,KACA,EAA4BtN,mBAAS,IAArC,mBAAOsG,EAAP,KAAeiH,EAAf,KACA,EAA0BvN,mBAAS,IAAnC,mBAAOwN,EAAP,KAAcC,EAAd,KACA,EAAkCzN,mBAAS,IAA3C,mBAAO0N,EAAP,KAAkBC,EAAlB,KACA,EAA2B3N,mBAAS,IAApC,mBAAO4N,EAAP,KAAeC,EAAf,KACA,EAAkC7N,mBAAS,IAA3C,mBAAO8N,EAAP,KAAkBC,EAAlB,KACA,EAAsC/N,mBAAS,IAA/C,mBAAOgO,EAAP,KAAoBC,EAApB,KACA,EAAkCjO,oBAAS,GAA3C,mBAAOmH,EAAP,KAAkB+G,EAAlB,KACA,EAA8ClO,mBAASmO,MAAM,IAAIC,MAAK,IAAtE,mBAAOxG,EAAP,KAAwByG,EAAxB,KAGAzN,qBAAU,WAAM,4CAEd,8BAAA0N,EAAA,6DACMC,EAAU,GADhB,SAIQrQ,IAAWR,MAAK,SAACC,GACrB,IAAImL,EAAOnL,EAAI6Q,QAAQC,MAAK,SAASH,EAAEI,GACrC,OAAOA,EAAEC,WAAaL,EAAEK,cAE1BlB,EAAS3E,EAAK,IACd8F,EAAY9F,EAAK,MAChBvH,OAAM,SAACsN,GACR,OAAOA,KAXX,uBAaQhR,EAAU+Q,EAAUpR,IAAIE,MAAK,SAACC,GAClC4Q,EAAU5Q,EAAI4Q,WACbhN,OAAM,SAACsN,GACR,OAAOA,KAhBX,uBAkBQtR,EAAegR,GAAS7Q,MAAK,SAACC,GAClC,IAAImR,EAAYnR,EAAI4I,QACpBkH,GAAS,SAAAsB,GAAS,kCACbA,GADa,IAEhBxI,QAASuI,UAEVvN,OAAM,SAACsN,GACR,OAAOA,KAzBX,4CAFc,0DA8BdG,GbvQ4BvR,MAAM,uHACrCC,MAAK,SAACC,GAAD,OAASA,EAAIC,UawQFF,MAAK,SAACoL,GACjBoF,GAAa,GACbZ,EAAUxE,EAAK0F,SACfN,GAAa,MACZ3M,OAAM,SAACsN,GACR,OAAOA,Kb7OqBpR,MAAM,oHACvCC,MAAK,SAACC,GAAD,OAASA,EAAIC,Ua+OAF,MAAK,SAACoL,GACnBoF,GAAa,GACbP,EAAa7E,EAAK0F,SAClBN,GAAa,MACZ3M,OAAM,SAACsN,GACR,OAAOA,KblPyBpR,MAAM,uGAC3CC,MAAK,SAACC,GAAD,OAASA,EAAIC,UaoPIF,MAAK,SAACoL,GACvBoF,GAAa,GACbH,EAAajF,EAAK0F,SAClBN,GAAa,MACZ3M,OAAM,SAACsN,GACR,OAAOA,KAGT1Q,IAAWT,MAAK,SAACC,GACfuQ,GAAa,GAEb,IADA,IAAIe,EAAW,GACP5K,EAAI,EAAGA,EAAI1G,EAAIiQ,OAAOtJ,OAAQD,IACpC4K,EAASjO,KAAKrD,EAAIiQ,OAAOvJ,IAE3BwJ,EAASoB,GACTf,GAAa,MACZ3M,OAAM,SAACsN,GACR,OAAOA,KAGT,IAAM7G,EAAKC,cACLiH,EAAoBC,YAAM1G,YAAIT,EAAI,YAAaoH,YAAa,aAAcC,YAAa,IACzFC,EAAS,GACb1G,YAAQsG,GAAmB,SAACrG,GAC1B,IAAMC,EAAOD,EAASE,MACtBuG,EAASnH,OAAOC,KAAKU,GAErB,IADA,IAAIyG,EAAM,GACFlL,EAAI,EAAGA,EAAIiL,EAAOhL,OAAQD,IAChCkL,EAAIvO,KAAJ,2BAEO8H,EAAKwG,EAAOjL,KAFnB,IAGI1E,QAAQ,EACRnC,GAAI8R,EAAOjL,MAIjB4J,EAAesB,QAGhB,IAEH3O,qBAAU,WAER,IAAI2O,EAAM,GACNC,EAAO,GAHG,4CAId,gCAAAlB,EAAA,sDACUjK,EAAI,EADd,YACiBA,EAAIgJ,EAAO/I,QAD5B,gCAEUzG,EAAUwP,EAAOhJ,GAAG7G,IAAIE,MAAK,SAACC,GAClC4R,EAAIvO,KAAKrD,EAAI4Q,YAHnB,OACoClK,IADpC,0BAAAiK,EAAA,iBAMUjK,GANV,SAAAiK,EAAA,sEAOU/Q,EAAegS,EAAIlL,IAAI3G,MAAK,SAACC,GACjC6R,EAAKxO,KAAKrD,EAAI4I,SACd,IAAI+H,EAAI3Q,EAAI4I,QACZgH,GAAU,SAAAkC,GAAS,4BAAQA,GAAR,CAAmBnB,OACtCD,GAAmB,SAAAqB,GAAI,OAAIA,EAAK3J,KAAI,SAAC3B,EAAM+I,GACzC,OAAIA,IAAU9I,GAAUD,WAGzB7C,OAAM,SAACsN,GACR,OAAOA,KAhBb,0CAMUxK,EAAI,EANd,YAMiBA,EAAIkL,EAAIjL,QANzB,0CAMUD,GANV,iBAMiCA,IANjC,4DAJc,0DAwBdsL,KAEC,CAACtC,IAEJ,IAAM5C,EAAoB,SAACjN,GACzByQ,EAAeD,EAAYjI,KAAI,SAAC3B,GAC9B,OAAIA,EAAK5G,KAAOA,EAAW4G,EACpB,2BACFA,GADL,IAEEzE,QAASyE,EAAKzE,cAKpB,OACE,sBAAK8B,MAAO,CAAEmO,gBAAgB,WAA9B,UACE,cAAC,GAAD,CAASzI,UAAWA,IACpB,eAACkF,GAAD,WACE,cAACC,GAAD,CAAuB7K,MAAO,CAC1B4G,gBAAiBmF,EAAMqC,eAAN,iGAAiHrC,EAAMqC,cAAvH,OADrB,SAGE,eAACtD,GAAD,WACE,cAACC,GAAD,UAAsBgB,EAAMhC,QAC5B,cAACiB,GAAD,UAAuBe,EAAMsC,WAC7B,cAACpD,GAAD,UAAsBc,EAAMjH,SAAW,cAAC,GAAD,CAA2BA,QAASiH,EAAMjH,SAAzBiH,EAAMhQ,WAGlE,eAACmP,GAAD,CAAgB/K,UAAU,UAA1B,UACE,cAACsK,GAAD,sBACA,cAAC,GAAD,UACA,eAACE,GAAD,WACE,qBAAKxK,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACGkK,EAAOtH,KAAI,SAAC0B,EAAO0F,GAAR,OACV,cAAC,GAASrK,KAAV,UACE,cAAC,GAAD,CAEA2E,MAAOA,EACPI,OAAM,yCAAoCJ,EAAMK,aAChDJ,OAAQpB,EAAO6G,GACf3P,GAAIiK,EAAMjK,GACVmK,UAAU,EACVC,gBAAiBA,EAAgBuF,IAN5B1F,EAAMjK,aAWjB,qBAAKoE,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACGkK,EAAOtH,KAAI,SAAC0B,EAAO0F,GAAR,OACV,cAAC,GAASrK,KAAV,UACE,cAAC,GAAD,CAEA2E,MAAOA,EACPI,OAAM,yCAAoCJ,EAAMK,aAChDJ,OAAQpB,EAAO6G,GACf3P,GAAIiK,EAAMjK,GACVmK,UAAU,EACVC,gBAAiBA,EAAgBuF,IAN5B1F,EAAMjK,qBAcrB,cAAC0O,GAAD,wBACA,cAACY,GAAD,qEACA,cAACD,GAAD,UACE,cAAC,GAAD,UACE,eAACT,GAAD,WACA,qBAAKxK,UAAU,QAAf,SACE,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACGuK,EAAU3H,KAAI,SAAC0B,EAAO0F,GAAR,OACb,cAAC,GAASrK,KAAV,UACE,cAAC,GAAD,CAEA2E,MAAOA,EACPI,OAAM,yCAAoCJ,EAAMK,aAChDtK,GAAIiK,EAAMjK,IAHLiK,EAAMjK,aAQjB,qBAAKoE,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACGuK,EAAU3H,KAAI,SAAC0B,EAAO0F,GAAR,OACb,cAAC,GAASrK,KAAV,UACE,cAAC,GAAD,CAEA2E,MAAOA,EACPI,OAAM,yCAAoCJ,EAAMK,aAChDtK,GAAIiK,EAAMjK,IAHLiK,EAAMjK,oBAWvB,cAAC0O,GAAD,sBACA,cAACa,GAAD,UACE,cAACE,GAAD,CAASC,QAASY,MAEpB,cAAC5B,GAAD,oBACA,cAACY,GAAD,+DACA,cAACF,GAAD,UACGgB,EAAO7H,KAAI,SAACgK,GACX,OAAO,cAAC,IAAD,CAAqBpO,GAAE,wBAAmBoO,EAAMvS,IAAhD,SAAsD,6BAAKuS,EAAMvG,QAAtDuG,EAAMvS,SAG5B,cAAC0O,GAAD,uBACA,cAACc,GAAD,UACwB,IAAvBgB,EAAY1J,OAAe0J,EAAYjI,KAAI,SAAC3B,EAAM+I,GAChD,OAAO,cAAC,GAAD,CAAuB3C,QAASpG,EAAMqG,kBAAmBA,EAAmBC,cAAc,GAA5EtG,EAAK5G,OACtB,mF,iGC9aTwS,GAAgBnR,IAAOC,IAAV,8HAObmR,GAAiBpR,IAAOC,IAAV,ycA2BdO,GAAUR,IAAOC,IAAV,8GAMPoR,GAAkBrR,IAAOC,IAAV,iKASfqR,GAAkBtR,IAAOC,IAAV,gDAGfsN,GAAoBvN,IAAOC,IAAV,sTAoBjBkI,GAAYnI,IAAOC,IAAV,mZAoBTsR,GAAwBvR,YAAOG,IAAPH,CAAH,0QAYrBgL,GAAOhL,IAAOwH,KAAV,kCAGJgK,GAAqBxR,IAAOyR,GAAV,2LAUlBC,GAAoB1R,IAAOC,IAAV,2xBA8CjB0R,GAAkB3R,IAAOC,IAAV,oEAIf2R,GAAW5R,IAAO6R,IAAV,0QAcRC,GAAU9R,IAAOwH,KAAV,yPAYPuK,GAAiB/R,IAAOC,IAAV,gNAad+R,GAAahS,IAAOC,IAAV,gCAGVgS,GAAoBjS,IAAOC,IAAV,8JAON,SAAAK,GAAK,OAAIA,EAAMuK,eAAiB,UAAY,YAGvDqH,GAAmBlS,IAAOC,IAAV,mFAIhByL,GAAW1L,IAAOC,IAAV,oDAGRkS,GAAYnS,IAAO8F,EAAV,oDAGf,SAASsI,GAAT,GAA+B,IAAZC,EAAW,EAAXA,QACjB,OACE,eAAC,GAAD,WACE,qBAAKtL,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACG+J,EAAQnH,KAAI,SAAC3B,EAAM+I,GAAP,OACX,cAAC,GAASrK,KAAV,UACE,8BACuB,SAAtBsB,EAAKmF,cACJ,cAACH,GAAD,CAAQC,OAAQjF,OAHAA,EAAK5G,WAU7B,qBAAKoE,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,EAAxB,SACG+J,EAAQnH,KAAI,SAAC3B,EAAM+I,GAAP,OACX,cAAC,GAASrK,KAAV,UACE,8BACuB,SAAtBsB,EAAKmF,cACN,cAACH,GAAD,CAAQC,OAAQjF,OAHEA,EAAK5G,cAepB,SAASyT,KAEtB,MAA0BjR,mBAAS,IAAnC,mBAAOyH,EAAP,KAAcmD,EAAd,KACA,EAA4B5K,mBAAS,IAArC,mBAAO0H,EAAP,KAAe6F,EAAf,KACA,EAA8CvN,mBAAS,IAAvD,mBAAOkR,EAAP,KAAwBC,EAAxB,KACA,EAA8BnR,mBAAS,IAAvC,mBAAOkN,EAAP,KAAgBkE,EAAhB,KACA,EAAgCpR,mBAAS,IAAzC,mBAAOqR,EAAP,KAAiBC,EAAjB,KACA,EAA0BtR,mBAAS,IAAnC,mBAAOuR,EAAP,KAAcC,EAAd,KACA,EAA4BxR,mBAAS,IAArC,mBAAOyR,EAAP,KAAeC,EAAf,KACA,EAAgC1R,mBAAS,IAAzC,mBAAO2R,EAAP,KAAiBC,EAAjB,KACA,EAAwC5R,mBAAS,IAAjD,mBAAO6R,EAAP,KAAqBC,EAArB,KACA,EAA4C9R,mBAAS,IAArD,mBAAO+R,EAAP,KAAuBC,EAAvB,KACA,EAAoDhS,oBAAS,GAA7D,mBAAOiS,EAAP,KAA2BC,GAA3B,KACA,GAAoDlS,mBAAS,GAA7D,qBAAOmS,GAAP,MAA2BC,GAA3B,MACA,GAAgDpS,mBAAS,GAAzD,qBAAOqS,GAAP,MAAyBC,GAAzB,MACQ9U,GAAO+U,cAAP/U,GACAgD,GAASD,qBAAWjC,GAApBkC,KAERI,qBAAU,YACR,WAEE,IAAMoH,EAAKC,cACLuK,EAAQrD,YAAM1G,YAAIT,EAAI,YAAayK,YAAa,YAAaC,YAAQlV,KACzEoL,YAAQ4J,GAAO,SAAC3J,GACd,IAAMC,EAAOD,EAASE,MAClBwG,EAAM,GACV,GAAGzG,EAAK,CACN,IAGI6J,EAHAvK,EAAOD,OAAOC,KAAKU,GACnB8J,EAAYrO,KAAKC,KAAK4D,EAAK9D,OAAS,GACxCgO,GAAoBM,GAGlBD,EADCvK,EAAK9D,QAAU,EACV,EAEA8D,EAAK9D,OAEb,IAAI,IAAID,EAAI,EAAGA,EAAIsO,EAAKtO,IACtBkL,EAAIvO,KAAJ,2BAEO8H,EAAKV,EAAK/D,KAFjB,IAGI1E,QAAQ,EACRnC,GAAI4K,EAAK/D,MAIfuN,EAAYrC,EAAIsD,gBAEhBjB,EAAY,OAOpBkB,KACC,CAACtV,KAIJ,IAAIuJ,GAAM,GAINU,EAAMK,cACRf,GAAG,6CAAyCU,EAAMoI,gBAEpD,IAAQ/G,GAASiK,oBAAShM,GANT,WAMsB,CAAEiM,YALnB,YAKgCC,QAJpC,KAIVnK,KACJoK,GAAiB,GAEjBC,GAAW,GACf,GAAGrK,GAAM,CAEP,IADA,IAAIsK,GAAM,QACF/O,GAAI,EAAGA,GAAIyE,GAAKxE,OAAQD,KAC9B+O,IAAOtK,GAAKzE,IAAK,IAGnB6O,GADAE,IAAO,OAIT,GAAGtK,GAAM,CACP,IAAIuK,GAAMvK,GAAK,GACXwK,GAAQxK,GAAK,GACbyK,GAAOzK,GAAK,GAEhBqK,GAAQ,4BADW,MAANE,GAAuB,MAARC,GAAwB,MAAPC,IAAiB,IACtD,wBAGV3S,qBAAU,WACR3C,EAAeT,IAAIE,MAAK,SAACC,GAEvB,OADAiN,EAASjN,GACFA,KACND,MAAK,SAACC,Id1VW,SAACH,GAAD,OAAQC,MAAM,sCAAD,OAAuCD,EAAvC,qDACpCE,MAAK,SAACC,GAAD,OAASA,EAAIC,Wc0Vb4V,CAAS7V,EAAIH,IAAIE,MAAK,SAACC,GACrB,IAAI8V,EAAW9V,EAAI6Q,QAAQ3K,QAAO,SAAAO,GAChC,MAAqB,YAAdA,EAAKL,QAEdyN,EAASiC,EAAS,OAEpBlW,EAAeI,EAAI4Q,SAAS7Q,MAAK,SAACC,GAChC4P,EAAU5P,EAAI4I,YdvXI,SAAC/I,GAAD,OAAQC,MAAM,sCAAD,OAAuCD,EAAvC,qEACtCE,MAAK,SAACC,GAAD,OAASA,EAAIC,UcwXb8V,CAAW/V,EAAIH,IAAIE,MAAK,SAACC,GACvBwT,EAAmBxT,EAAI6Q,edvXL,SAAChR,GAAD,OAAQC,MAAM,sCAAD,OAAuCD,EAAvC,qEACtCE,MAAK,SAACC,GAAD,OAASA,EAAIC,UcyXf+V,CAAWnW,IAAIE,MAAK,SAACC,GAEnB,IAAI0T,EAAW1T,EAAIiW,KAAK/P,QAAO,SAACO,GAC9B,MAAoB,aAAbA,EAAKyP,OAEdzC,EAAWzT,EAAImW,MACfxC,EAAYD,EAAS,OdlWE,SAAC7T,GAAD,OAAQC,MAAM,sCAAD,OAAuCD,EAAvC,qDACzCE,MAAK,SAACC,GAAD,OAASA,EAAIC,UcmWfmW,CAAcvW,IAAIE,MAAK,SAACC,GAEtB,IAAIqW,EAASrW,EAAIsW,UACjBvC,EAAUsC,QAEX,CAACxW,KAEJ,IAyBMiN,GAAoB,SAACjN,GACzBoU,EAAYD,EAAS5L,KAAI,SAAC3B,GACxB,OAAIA,EAAK5G,KAAOA,EAAW4G,EACpB,2BACFA,GADL,IAEEzE,QAASyE,EAAKzE,cAIduU,GAAoB,SAACC,GACzB,IAAMnM,EAAKC,cACLuK,EAAQrD,YAAM1G,YAAIT,EAAI,YAAayK,YAAa,YAAaC,YAAQlV,KACxE2W,EACDvL,YAAQ4J,GAAO,SAAC3J,GACd,IAAMC,EAAOD,EAASE,MAClBwG,EAAM,GACV,GAAGzG,EAAK,CACN,IACI6J,EADAvK,EAAOD,OAAOC,KAAKU,GAGrB6J,EADCvK,EAAK9D,QAA+B,EAArB6N,GAAyB,EACd,EAArBA,GAAyB,EAEzB/J,EAAK9D,OAEb,IAAI,IAAID,EAAyB,EAArB8N,GAAwB9N,EAAIsO,EAAKtO,IACzCkL,EAAIvO,KAAJ,2BAEO8H,EAAKV,EAAK/D,KAFjB,IAGI1E,QAAQ,EACRnC,GAAI4K,EAAK/D,MAIjBuN,EAAYrC,EAAIsD,WAChBT,GAAsBD,GAAqB,OAGrCgC,GACVvL,YAAQ4J,GAAO,SAAC3J,GACd,IAAMC,EAAOD,EAASE,MAClBwG,EAAM,GACV,GAAGzG,EAAK,CACN,IACI6J,EADAvK,EAAOD,OAAOC,KAAKU,GAGrB6J,EADCvK,EAAK9D,QAAmC,GAAxB6N,GAAmB,GAAS,EACd,GAAxBA,GAAmB,GAAS,EAE7B/J,EAAK9D,OAEb,IAAI,IAAID,EAA6B,GAAxB8N,GAAmB,GAAQ9N,EAAIsO,EAAKtO,IAC7CkL,EAAIvO,KAAJ,2BAEO8H,EAAKV,EAAK/D,KAFjB,IAGI1E,QAAQ,EACRnC,GAAI4K,EAAK/D,MAIjBuN,EAAYrC,EAAIsD,WAChBT,GAAsBD,GAAqB,QAOnD,OACE,sBAAK1Q,MAAO,CACVmO,gBAAgB,UAAYwE,MAAO,SADrC,UAGG3M,EAAMK,aACP,cAAC,GAAD,CAAWrG,MAAO,CACZ4G,gBAAgB,oCAAD,OAAsC6K,GAAtC,sDAAkGzL,EAAMoI,cAAxG,OADrB,SAGA,eAAC,GAAD,WACE,eAACK,GAAD,WACA,cAACF,GAAD,UACE,cAAC,GAAD,CAEAvI,MAAOA,EACPI,OAAM,yCAAoCJ,EAAMK,aAChDtK,GAAIiK,EAAMjK,IAHLiK,EAAMjK,MAKb,eAACyS,GAAD,CAAgBxO,MAAO,CACnB2S,MAAM,GAAD,OAAKjB,KADd,UAGE,+BAAK1L,EAAM+D,MAAM,eAAC,GAAD,eAAQ/D,EAAM4M,aAAaC,OAAO,EAAG,GAArC,UACjB,4BAAI7M,EAAMqI,WACTpI,GAAU,qBAAK9F,UAAU,cAAf,SAA6B,cAAC,GAAD,CAAY2E,QAASmB,MAC7D,eAAC2I,GAAD,WACGgB,GAAY,oDAAQA,EAAS7H,QAC9B,oDAAQ/B,EAAM8M,WACd,gEAAU9M,EAAM+M,YAChB,0DAAS/M,EAAMgN,SAASA,SAAS1O,KAAI,SAAC3B,GACpC,OAAO,cAACuM,GAAD,CAASlP,MAAO,CAAEiT,OAAO,aAAD,OAAevB,KAAvC,SAAqD,IAAI/O,EAAKoF,sBAK3E,gEACF,cAACgH,GAAD,UACA,eAAC,GAAD,WACM,qBAAK5O,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACGsO,GAAUA,EAAO1L,KAAI,SAAC3B,GACvB,OAAO,cAAC,GAAStB,KAAV,UACL,cAAC,KAAD,UACE,cAAC2N,GAAD,CAAU1J,IAAG,6CAAwC3C,EAAKuQ,wBAMhE,qBAAK/S,UAAU,QAAf,SACA,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACGsO,GAAUA,EAAO1L,KAAI,SAAC3B,GACvB,OAAO,cAAC,GAAStB,KAAV,UACL,cAAC,KAAD,UACE,cAAC2N,GAAD,CAAU1J,IAAG,6CAAwC3C,EAAKuQ,6BAalE,oDACF,cAACpE,GAAD,UACKgB,GAAS,wBAAQ3P,UAAU,oBAAoBmF,IAAG,wCAAmCwK,EAAMxP,IAAzC,eAA2DyJ,MAAM,uBAAuBoJ,YAAY,IAAIC,MAAM,2FAA2FC,iBAAe,WAKjR,yCACA,cAAC,GAAD,CAAS5H,QAASA,IAClB,0CACA,eAAC0D,GAAD,WACE,eAAC,GAAD,WACqB,IAApBe,EAASrN,OAAeqN,EAAS5L,KAAI,SAAC3B,EAAM+I,GACzC,OAAO,cAAC,GAAD,CAAS1C,kBAAmBA,GAAmBD,QAASpG,OAC5D,cAAC4M,GAAD,yDACJxQ,GAAM,wBAAQ0B,QAAS,WAAOgQ,IAAuBD,IAA/C,sCAAqF,cAAC,IAAD,CAAMtQ,GAAG,SAAT,qDAI3FsQ,GACC,eAACnB,GAAD,CAAmBpH,eAAgBlL,IAAnC,UACE,eAACuS,GAAD,WACE,sDAAgB,uBAAOhN,KAAK,OAAO9B,SAAU,SAAClB,GAAD,OAAO+Q,EAAgB/Q,EAAEG,OAAOnD,aAE/E,eAACgT,GAAD,WACE,sDAAgB,0BAAUhN,KAAK,OAAO9B,SAAU,SAAClB,GAAD,OAAOiR,EAAkBjR,EAAEG,OAAOnD,aAEpF,uBAAOgG,KAAK,SAAS7B,QAvLL,WAgBN,KAAjB2P,GAA0C,KAAnBE,GACxBD,EAAgB,IAChBE,EAAkB,IAjBpB,SAAuBpG,EAASJ,GAC9B,IAAMxD,EAAKC,cACP0D,EZ3Za,WACrB,IAAIoJ,EAAQ,IAAIlL,KAGZmL,EAAQ,GACRC,EAAM,GAWV,OAPED,EAPkB,CAAC,KAAM,KAAM,MAIjB1M,UAAUyM,EAAMG,WAAW,GAAG3M,aAGnCwM,EAAMG,WAAW,GAAG3M,WAFrB,KAAOwM,EAAMG,WAAW,GAAG3M,WAKnC0M,EATc,CAAC,IAAK,IAAK,IAAM,IAAK,IAAK,IAAK,IAAK,IAAK,KAQ/C3M,SAAUyM,EAAMI,UAAW5M,YAC9B,IAAOwM,EAAMI,UAAW5M,WAEvBwM,EAAMI,UAAW5M,WAEnBwM,EAAMK,cAAc7M,WAAayM,EAAQC,EY2YjCE,GACPE,GZzYI,IAAIxL,MACHyL,UYyYTtU,YAAKyH,YAAIT,EAAI,YAAa,CACxB4D,QAASmG,EACTvG,MAAOqG,EACPlG,KAAMA,EACND,aAAclL,GAAK+U,aAAa,GAAGvR,YACnCuH,UAAW,EACXF,SAAU7N,GACVkL,IAAKlI,GAAKkI,IACV2M,WAAYA,IAMdG,IAEAC,MAAM,sEAqKF,eAAC5E,GAAD,WAC4B,IAAvBsB,IAA2B,wBAAQjQ,QAAS,WAAOgS,IAAkB,IAA1C,eAC3B/B,GACAE,KAAqBF,IAAqB,wBAAQjQ,QAAS,WAAOgS,IAAkB,IAA1C,qBAGnD,0DACA,cAAC/D,GAAD,UACE,cAAC,GAAD,UACE,cAAC,GAAD,CAAUjN,KAAM,EAAGC,IAAK,GAAxB,SACG+N,EAAgBnL,KAAI,SAAC3B,EAAM+I,GAAP,OACnB,cAAC,GAASrK,KAAV,UACE,8BACCsB,EAAK0D,aAAe,cAACsI,GAAD,CAAuB3O,MAAO,CACjD4G,gBAAgB,uCAAD,OAAyCjE,EAAK0D,YAA9C,OACdnG,GAAE,iBAAYyC,EAAK5G,SAJJ4G,EAAK5G,gBCvlBvC,I,8BAAMwJ,GAAYnI,IAAOC,IAAV,4EAIT4W,GAAkB7W,IAAOC,IAAV,0RAkBf6W,GAAY9W,IAAOsN,GAAV,yEAITyJ,GAAgB/W,IAAOC,IAAV,yEAIb+W,GAAgBhX,IAAOC,IAAV,iHAOJ,SAASgX,KACtB,MAA4B9V,mBAAS,IAArC,mBAAOqN,EAAP,KAAeC,EAAf,KACA,EAA2BtN,mBAAS,IAApC,mBAAO4N,EAAP,KAAeC,EAAf,KACA,EAA4B7N,mBAAS,IAArC,mBAAOsG,EAAP,KAAeiH,EAAf,KACA,EAAsCvN,mBAAS,IAA/C,mBAAOoD,EAAP,KAAoBC,EAApB,KACA,EAAkCrD,mBAAS,IAA3C,mBAAO4S,EAAP,KAAkBmD,EAAlB,KACA,EAAkC/V,oBAAS,GAA3C,mBAAOmH,EAAP,KAAkB+G,EAAlB,KACA,EAA8ClO,mBAASmO,MAAM,IAAIC,MAAK,IAAtE,mBAAOxG,EAAP,KAAwByG,EAAxB,KAEQ7Q,EAAO+U,cAAP/U,GAERoD,qBAAU,WACE,KAAPpD,GACCY,EAAeZ,GAAIE,MAAK,SAACC,GACvBuQ,GAAa,GACb7K,EAAe1F,EAAIK,MACnB+X,EAAapY,EAAIqY,aACjB1I,EAAU3P,EAAI6Q,SACdN,GAAa,QAGlB,CAAC1Q,IAEJoD,qBAAU,WACR,IAAI2O,EAAM,GACNC,EAAO,GAFG,4CAGd,gCAAAlB,EAAA,sDAEUjK,EAAI,EAFd,YAEiBA,EAAIgJ,EAAO/I,QAF5B,gCAGUzG,EAAUwP,EAAOhJ,GAAG7G,IAAIE,MAAK,SAACC,GAClC4R,EAAIvO,KAAKrD,EAAI4Q,YACZhN,OAAM,WACPgO,EAAIvO,KAAK,SANf,OAEoCqD,IAFpC,0BAAAiK,EAAA,iBASUjK,GATV,SAAAiK,EAAA,sEAUU/Q,EAAegS,EAAIlL,IAAI3G,MAAK,SAACC,GACjC6R,EAAKxO,KAAKrD,EAAI4I,SACd,IAAI+H,EAAI3Q,EAAI4I,QACZgH,GAAU,SAAAkC,GAAS,4BAAQA,GAAR,CAAmBnB,OAEtCD,GAAmB,SAAAqB,GAAI,OAAIA,EAAK3J,KAAI,SAAC3B,EAAM+I,GACzC,OAAIA,IAAU9I,GAAUD,WAKzB7C,OAAM,WACPgM,GAAU,SAAAkC,GAAS,4BAAQA,GAAR,CAAmB,WAtB5C,0CASUpL,EAAI,EATd,YASiBA,EAAIkL,EAAIjL,QATzB,0CASUD,GATV,iBASiCA,IATjC,4DAHc,0DA8Bd4R,KACC,CAAC5I,IAIJzM,qBAAU,WACRzC,IAAWT,MAAK,SAACC,GAEf,IADA,IAAIsR,EAAW,GACP5K,EAAI,EAAGA,EAAI1G,EAAIiQ,OAAOtJ,OAAQD,IACpC4K,EAASjO,KAAKrD,EAAIiQ,OAAOvJ,IAE3BwJ,EAASoB,QAEV,IACH,IAAMiH,EAAmB,SAAClY,GACxB6N,OAAOsK,SAAS,EAAG,GACnBjI,GAAa,GACbX,EAAU,IACVc,EAAmBF,MAAM,IAAIC,MAAK,IACxB,KAAP5Q,GACDY,EAAeZ,EAAIQ,GAAMN,MAAK,SAACC,GAC7B0F,EAAe1F,EAAIK,MACnBsP,EAAU3P,EAAI6Q,YAGlBN,GAAa,IAEf,OACE,eAAC,GAAD,WACE,cAAC,GAAD,CAAS/G,UAAWA,IACpB,cAACwO,GAAD,UACG/H,EACE/J,QAAO,SAACO,GACP,OAAOA,EAAK5G,GAAG+K,aAAe/K,KAE/BuI,KAAI,SAAC3B,GACJ,OAAOA,EAAKoF,KAAO,4CAIzB,eAACkM,GAAD,WACGrI,GAAUA,EAAOtH,KAAI,SAAC3B,EAAM+I,GAC3B,OAAO,cAAC0I,GAAD,CAAejU,UAAU,QAAzB,SAAiC,cAAC,GAAD,CAAqB6F,MAAOrD,EAAMsD,OAAQpB,EAAO6G,GAAQvF,gBAAiBA,EAAgBuF,GAAQxF,UAAU,GAAhGvD,EAAK5G,SAE1D6P,GAAUA,EAAOtH,KAAI,SAAC3B,EAAM+I,GAC3B,OAAO,cAAC0I,GAAD,CAAejU,UAAU,QAAzB,SAAiC,cAAC,GAAD,CAAqB6F,MAAOrD,EAAMsD,OAAQpB,EAAO6G,GAAQvF,gBAAiBA,EAAgBuF,GAAQxF,UAAU,GAAhGvD,EAAK5G,YAG7D,eAACoY,GAAD,WACmB,IAAhBxS,EAAoB,wBAAQlB,QAAS,WAAOgU,EAAiB9S,EAAc,IAAvD,eAA4E,GAC/FA,EACAA,IAAgBwP,EAAY,wBAAQ1Q,QAAS,WAAOgU,EAAiB9S,EAAc,IAAvD,eAA4E,SC5IlH,I,oCAAM4D,GAAYnI,IAAOC,IAAV,sNAWTO,GAAUR,IAAOC,IAAV,4IAOP4W,GAAkB7W,IAAOC,IAAV,wGAMfuI,GAAiBxI,IAAOC,IAAV,wQAYdsX,GAAmBvX,IAAOC,IAAV,6pBAuChBuX,GAAqBxX,IAAOC,IAAV,yKAUlB8W,GAAgB/W,IAAOC,IAAV,gCAGb+W,GAAgBhX,IAAOC,IAAV,iQAkBbwX,GAAkBzX,IAAO8F,EAAV,oJAQf4R,GAAS1X,IAAO2X,GAAV,gKACR,SAACrX,GAAD,OAAWA,EAAMC,SAAN,2DAYf,SAASqX,GAAT,GAA8B,IAAXpN,EAAU,EAAVA,OACjB,OACE,eAAC,GAAD,WACE,cAACD,GAAD,CAAQC,OAAQA,EAAQC,QAAQ,IAChC,eAAC8M,GAAD,WACE,6BAAK/M,EAAOG,OACZ,qDAASH,EAAOqN,UAAU3Q,KAAI,SAAC3B,GAC7B,OAAO,6BAAKA,EAAKoH,oBAM3B,SAASmL,GAAT,GAA0C,IAAlBlP,EAAiB,EAAjBA,MAAOC,EAAU,EAAVA,OAE7B,OACE,eAAC,GAAD,WACE,eAAC,GAAD,WACE,qBAAK9F,UAAU,QAAf,SACA,cAAC,GAAD,CAAsB6F,MAAOA,EAAOjK,GAAIiK,EAAMjK,GAAIqK,OAAM,yCAAoCJ,EAAMK,aAAeJ,OAAQA,EAASC,UAAU,GAAhIF,EAAMjK,MAElB,qBAAKoE,UAAU,QAAf,SACA,cAAC,GAAD,CAAsB6F,MAAOA,EAAOjK,GAAIiK,EAAMjK,GAAIqK,OAAM,yCAAoCJ,EAAMK,aAAeJ,OAAQA,EAASC,UAAU,GAAhIF,EAAMjK,SAIpB,eAAC4Y,GAAD,WACE,6BAAK3O,EAAM+D,QACX,4BAAI/D,EAAMqI,WACV,qBAAKlO,UAAU,UACf,qBAAKA,UAAU,cAAf,SAA6B,cAAC,GAAD,CAAY2E,QAASmB,EAAQlB,UAAU,iBAM7D,SAASoQ,KACtB,MAA4B5W,mBAAS,IAArC,mBAAOqN,EAAP,KAAeC,EAAf,KACA,EAA2BtN,mBAAS,IAApC,mBAAO4N,EAAP,KAAeC,EAAf,KACA,EAA4B7N,mBAAS,IAArC,mBAAO0H,EAAP,KAAe6F,EAAf,KACA,EAAkDvN,mBAAS,IAA3D,mBAAO6W,EAAP,KAA0BC,EAA1B,KACA,EAAsC9W,mBAAS,GAA/C,mBAAO+W,EAAP,KAAoBC,EAApB,KACA,EAAoChX,mBAAS,CAC3CiX,SAAU,EACVC,WAAY,EACZC,YAAa,IAHf,mBAAOC,EAAP,KAAmBC,EAAnB,KAKA,EAA4CrX,oBAAS,GAArD,mBAAOsX,EAAP,KAAuBC,EAAvB,KACA,EAAwCvX,mBAAS,GAAjD,mBAAOwX,EAAP,KAAqBC,EAArB,KACA,EAAsCzX,mBAAS,IAA/C,mBAAOoD,EAAP,KAAoBC,EAApB,KACA,EAAkCrD,mBAAS,IAA3C,mBAAO4S,EAAP,KAAkBmD,EAAlB,KACQ5G,EAAUoD,cAAVpD,MAERvO,qBAAU,WACK,KAAVuO,IACD5B,EAAU,IACVD,EAAU,IACVxP,EAAcqR,GAAOzR,MAAK,SAACC,GACzB0F,EAAe1F,EAAIK,MACnB+X,EAAapY,EAAIqY,aACjB,IAAIkB,EAAa,EACbC,EAAc,EACdlI,EAAW,GACftR,EAAI6Q,QAAQkJ,SAAQ,SAACtT,GAUnB,MATuB,UAApBA,EAAKuT,YACNvT,EAAKwT,UAAUF,SAAQ,SAACG,GACT5I,EAAS6I,MAAK,SAACC,GAAD,OAAYA,IAAWF,MAEhD5I,EAASjO,KAAK6W,MAKG,UAApBzT,EAAKuT,WACCT,IAEc,OAApB9S,EAAKuT,WACC,KAEc,WAApBvT,EAAKuT,WACCR,SADT,KAIF,IAAIF,EAAWC,EAAaC,EAC5BL,EAAqB7H,GACrB3B,EAAU3P,EAAI6Q,SACd6I,EAAc,CACZJ,WACAC,aACAC,sBAIL,CAAChI,IAGJvO,qBAAU,WACN2M,EAAU,IACV,IAAIgC,EAAM,GACNC,EAAO,GAHC,4CAIZ,8BAAAlB,EAAA,sDACUjK,EAAI,EADd,YACiBA,EAAIgJ,EAAO/I,QAD5B,oBAEgC,UAAzB+I,EAAOhJ,GAAGsT,WAFjB,gCAGY9Z,EAAUwP,EAAOhJ,GAAG7G,IAAIE,MAAK,SAACC,GAClC4R,EAAIvO,KAAKrD,EAAI4Q,YAJrB,6BAOMgB,EAAIvO,KAAK,MAPf,OACoCqD,IADpC,uBAUUA,EAAI,EAVd,aAUiBA,EAAIkL,EAAIjL,QAVzB,kCAWU/G,EAAegS,EAAIlL,IAAI3G,MAAK,SAACC,GACjC6R,EAAKxO,KAAKrD,EAAI4I,SACd,IAAI+H,EAAI3Q,EAAI4I,QACZgH,GAAU,SAAAkC,GAAS,4BAAQA,GAAR,CAAmBnB,UAd5C,QAUiCjK,IAVjC,6DAJY,0DAsBZ2T,KACD,CAAC3K,IAEJzM,qBAAU,WACRzC,IAAWT,MAAK,SAACC,GAGf,IAFA,IAAIsR,EAAW,GACXO,EAAO,GACHnL,EAAI,EAAGA,EAAI1G,EAAIiQ,OAAOtJ,OAAQD,IACpC4K,EAASjO,KAAKrD,EAAIiQ,OAAOvJ,IAE3B,IANuB,eAMfA,GACN,IAAI7G,EAAKyR,EAAS6I,MAAK,SAAC1T,GACtB,OAAOA,EAAK5G,KAAOqZ,EAAkBxS,MAEvCmL,EAAKxO,KAAKxD,IAJJ6G,EAAI,EAAGA,EAAGwS,EAAkBvS,OAAQD,IAAM,EAA1CA,GAMRwJ,EAAS2B,QAEV,CAACqH,IACJ,IAuBMX,EAAmB,SAAClY,GACxB6N,OAAOsK,SAAS,EAAG,GACnBrY,EAAcqR,EAAOnR,GAAMN,MAAK,SAACC,GAC/B0F,EAAe1F,EAAIK,MACnB+X,EAAapY,EAAIqY,aACjB,IAAIkB,EAAa,EACbC,EAAc,EACdlI,EAAW,GACftR,EAAI6Q,QAAQkJ,SAAQ,SAACtT,GAUnB,MATuB,UAApBA,EAAKuT,YACNvT,EAAKwT,UAAUF,SAAQ,SAACG,GACP5I,EAAS6I,MAAK,SAACC,GAAD,OAAYA,IAAWF,MAEjD5I,EAASjO,KAAK6W,MAKE,UAApBzT,EAAKuT,WACCT,IAEc,OAApB9S,EAAKuT,YAGe,WAApBvT,EAAKuT,WACCR,SAJT,KAOF,IAAIF,EAAWC,EAAaC,EAC5BL,EAAqB7H,GACtB3B,EAAU3P,EAAI6Q,SACd6I,EAAc,CACZJ,WACAC,aACAC,oBAIL,OACE,eAAC,GAAD,WACE,eAAC,GAAD,WACA,cAACd,GAAD,UACE,qBAAInU,QAAS,SAACnB,IAjEM,SAACA,GACA,OAAtBA,EAAEG,OAAO+W,WACoB,MAA3BlX,EAAEG,OAAOgX,QAAQna,OAClBiZ,EAAe,GAEa,MAA3BjW,EAAEG,OAAOgX,QAAQna,OAClBiZ,EAAe,GAEa,MAA3BjW,EAAEG,OAAOgX,QAAQna,OAClBiZ,EAAe,GAEa,MAA3BjW,EAAEG,OAAOgX,QAAQna,OAClBiZ,EAAe,IAqDMmB,CAAkBpX,IAAvC,UACE,eAACwV,GAAD,CAAQnX,QAAyB,IAAhB2X,EAAmB,aAAW,IAA/C,0BAAuDK,EAAWH,YAClE,eAACV,GAAD,CAAQnX,QAAyB,IAAhB2X,EAAmB,aAAW,IAA/C,0BAAuDK,EAAWF,cAClE,eAACX,GAAD,CAAQnX,QAAyB,IAAhB2X,EAAmB,aAAW,IAA/C,0BAAuDK,EAAWD,eAClE,cAACZ,GAAD,CAAQnX,QAAyB,IAAhB2X,EAAmB7U,QApDf,WAC3BqV,GAAmBD,IAmDb,0BACC1J,GAAU0J,GACT1J,EAAO7H,KAAI,SAACgK,GACV,OAAO,oBAAInO,UAAU,YAAY,aAAW,IAAI7D,MAAOgS,EAAMvS,GAAI0E,QAAS,SAACnB,IApD5D,SAACA,GAC1B0W,EAAgB1W,EAAEG,OAAOnD,OAmDmEqa,CAAmBrX,IAA9F,SAAoGgP,EAAMvG,eAMzH,eAAC,GAAD,WACmB,IAAlB6D,EAAO/I,QAAgC,IAAhByS,GACtB1J,EAAOtH,KAAI,SAAC3B,EAAM+I,GAChB,MAAuB,UAApB/I,EAAKuT,WACC,cAAChB,GAAD,CAA2BlP,MAAOrD,EAAMsD,OAAQA,EAAOyF,IAArC/I,EAAK5G,IAET,WAApB4G,EAAKuT,WACC,cAAClB,GAAD,CAAsBpN,OAAQjF,GAAjBA,EAAK5G,IAEpB,QAER6P,GAA0B,IAAhB0J,GAA+C,IAA1BK,EAAWF,YACzC7J,EACGxJ,QAAO,SAACO,GACP,MAA2B,UAApBA,EAAKuT,cAEb5R,KAAI,SAAC3B,EAAM+I,GACV,OAAO,cAACwJ,GAAD,CAA2BlP,MAAOrD,EAAMsD,OAAQA,EAAOyF,IAArC/I,EAAK5G,OAGnC6P,GAA0B,IAAhB0J,GAAgD,IAA3BK,EAAWD,aACzC9J,EACGxJ,QAAO,SAACO,GACP,MAA2B,WAApBA,EAAKuT,cAEb5R,KAAI,SAAC3B,GACJ,OAAO,cAACqS,GAAD,CAAsBpN,OAAQjF,GAAjBA,EAAK5G,OAG9B6P,GAA0B,IAAhB0J,GAA6C,IAAxBK,EAAWH,UACzC5J,EACGxJ,QAAO,SAACO,GACP,MAA2B,UAApBA,EAAKuT,cAEb9T,QAAO,SAACO,GACP,IAAIiU,GAAc,EAIlB,OAHAjU,EAAKwT,UAAUU,MAAK,SAACvI,GACnB,OAAgCsI,EAAzBtI,IAAUyH,MAEI,IAAhBa,KAERtS,KAAI,SAAC3B,EAAM+I,GACV,OAAO,cAACwJ,GAAD,CAA2BlP,MAAOrD,EAAMsD,OAAQA,EAAOyF,IAArC/I,EAAK5G,OAGjB,IAAlB6P,EAAO/I,QAAgB,cAACgS,GAAD,2EAG1B,eAAC,GAAD,WACmB,IAAhBlT,EAAoB,wBAAQlB,QAAS,WAAOgU,EAAiB9S,EAAc,IAAvD,eAA4E,GAC/FA,EACAA,IAAgBwP,GAA2B,IAAdA,EAAkB,wBAAQ1Q,QAAS,WAAOgU,EAAiB9S,EAAc,IAAvD,eAA4E,SC/YrI,I,SAAM4D,GAAYnI,IAAOC,IAAV,uEAITmI,GAAepI,IAAOC,IAAV,mNAUZyZ,GAAkB1Z,IAAOC,IAAV,iOAWf0Z,GAAgB3Z,IAAOC,IAAV,oQAab2Z,GAAqB5Z,IAAOC,IAAV,6PAgBlB4Z,GAAY7Z,IAAO8F,EAAV,uIAQTuH,GAAQrN,IAAOsN,GAAV,mDAGL9M,GAAUR,IAAOC,IAAV,6HAOP+W,GAAgBhX,IAAOC,IAAV,iHAObsN,GAAoBvN,IAAOC,IAAV,sIAOjBwX,GAAkBzX,IAAO8F,EAAV,wEAIfgU,GAAiB9Z,IAAOW,OAAV,kIAKhB,SAACL,GAAD,OAAWA,EAAMC,SAAN,2DAMA,SAASwZ,KACtB,MAA4B5Y,mBAAS,IAArC,mBAAOqJ,EAAP,KAAewP,EAAf,KACA,EAAkC7Y,mBAAS,IAA3C,mBAAO8Y,EAAP,KAAkBC,EAAlB,KACA,EAA0C/Y,mBAAS,OAAnD,mBAAOgZ,EAAP,KAAsBC,EAAtB,KACA,EAAsCjZ,mBAAS,IAA/C,mBAAOkZ,EAAP,KAAoBC,EAApB,KACA,EAAoCnZ,mBAAS,IAA7C,mBAAOoZ,EAAP,KAAmBC,EAAnB,KACQ7b,EAAO+U,cAAP/U,GAERoD,qBAAU,WACRvC,EAAgBb,GAAIE,MAAK,SAACC,GACxBkb,EAAUlb,GACVob,EAAapb,EAAImb,cAChBvX,OAAM,SAACsN,GACR,OAAOA,KjBzEkB,SAACrR,GAAD,OAAQC,MAAM,uCAAD,OAAwCD,EAAxC,2EAC3CE,MAAK,SAACC,GAAD,OAASA,EAAIC,UiB0Ef0b,CAAgB9b,GAAIE,MAAK,SAACC,GACxB,IAAI4R,EAAM5R,EAAImW,KACbrF,MAAK,SAACH,EAAGI,GACR,OAAOA,EAAEC,WAAaL,EAAEK,cAEzB4K,MAAM,EAAG,GACN/J,EAAO7R,EAAImW,KACdrF,MAAK,SAACH,EAAGI,GACR,OAAOA,EAAEC,WAAaL,EAAEK,cAEzB4K,MAAM,EAAG5b,EAAImW,KAAKxP,OAAO,GAC1B6U,EAAe5J,GACf8J,EAAc7J,MACbjO,OAAM,SAACsN,GACR,OAAOA,OAER,CAACrR,IAEJ,IAAMgc,EAAoB,SAACC,GACR,QAAbA,GjBjG0B,SAACjc,GAAD,OAAQC,MAAM,uCAAD,OAAwCD,EAAxC,6DAC9CE,MAAK,SAACC,GAAD,OAASA,EAAIC,UiBiGb8b,CAAmBlc,GAAIE,MAAK,SAACC,GAC3Bob,EAAapb,EAAImb,WACjBG,EAAiB,UAGJ,QAAbQ,GACFpb,EAAgBb,GAAIE,MAAK,SAACC,GACxBob,EAAapb,EAAImb,WACjBG,EAAiB,WAKvB,OACE,cAAC,GAAD,UACE,eAAC,GAAD,WACA,eAACV,GAAD,WACGlP,EAAOE,cACR,cAAC,GAAD,CAAc9H,MAAO,CAAC4G,gBAAgB,uCAAD,OAAyCgB,EAAOE,aAAhD,SAErC,eAACiP,GAAD,WACE,6BAAKnP,EAAOG,OACXH,EAAOsQ,SAAW,mDAAOtQ,EAAOsQ,YAAgB,cAAC,GAAD,qEAChDtQ,EAAOuQ,eAAiB,yDAAQvQ,EAAOuQ,kBAAsB,cAAC,GAAD,iFAGlE,cAACjB,GAAD,CAAgBzW,QAAS,WAAOsX,EAAkB,QAASpa,QAA2B,QAAlB4Z,EAApE,gCACA,cAACL,GAAD,CAAgBzW,QAAS,WAAOsX,EAAkB,QAASpa,QAA2B,QAAlB4Z,EAApE,gCAAiH,uBACjH,cAACN,GAAD,UAA0B,KAAdI,EAAmB,uCAAWA,IAC1C,cAAC,GAAD,6CACA,eAACL,GAAD,WAC0B,IAAvBS,EAAY5U,OAAgB4U,EAAYnT,KAAI,SAAC3B,GAC1C,OAAO,cAAC,GAAD,CAAexC,UAAU,QAAzB,SACL,cAAC,GAAD,CAAqB6F,MAAOrD,EAAM5G,GAAI4G,EAAK5G,GAAIqK,OAAM,yCAAoCzD,EAAK0D,cAAlF1D,EAAK5G,SAChB,cAAC,GAAD,mDACU,IAAhB0b,EAAqBA,EAAYnT,KAAI,SAAC3B,GACnC,OAAO,cAAC,GAAD,CAAexC,UAAU,QAAzB,SAAiC,cAAC,GAAD,CAAqB6F,MAAOrD,EAAM5G,GAAI4G,EAAK5G,GAAIqK,OAAM,yCAAoCzD,EAAK0D,cAAlF1D,EAAK5G,SACrD,qBAAKoE,UAAU,QAAf,SAAuB,cAAC,GAAD,wDAEjC,cAAC,GAAD,6CACA,cAAC6W,GAAD,UACA,eAAC,GAAD,WACuB,IAAtBW,EAAW9U,OACX,qBAAK1C,UAAU,QAAf,SACD,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACKiW,GAAcA,EAAWrT,KAAI,SAAC3B,GAC7B,OAAO,cAAC,GAAStB,KAAV,UACL,cAAC,GAAD,CAAqB2E,MAAOrD,EAAM5G,GAAI4G,EAAK5G,GAAIqK,OAAM,yCAAoCzD,EAAK0D,cAAlF1D,EAAK5G,aAIf,qBAAKoE,UAAU,QAAf,SAAuB,cAAC,GAAD,qDACV,IAAtBwX,EAAW9U,OACX,qBAAK1C,UAAU,QAAf,SACD,cAAC,GAAD,CAAUsB,KAAM,EAAGC,IAAK,GAAxB,SACKiW,GAAcA,EAAWrT,KAAI,SAAC3B,GAC7B,OAAO,cAAC,GAAStB,KAAV,UACL,cAAC,GAAD,CAAqB2E,MAAOrD,EAAM5G,GAAI4G,EAAK5G,GAAIqK,OAAM,yCAAoCzD,EAAK0D,cAAlF1D,EAAK5G,aAIf,qBAAKoE,UAAU,QAAf,SAAuB,cAAC,GAAD,+DChMvC,I,MAAMoF,GAAYnI,IAAOC,IAAV,ykBAcE,SAAAK,GAAK,OAAIA,EAAMuK,eAAiB,UAAY,MAGvDmQ,GAAehb,IAAOC,IAAV,gmBAkCZgb,GAAejb,IAAO8F,EAAV,mEAIH,SAASoV,KACtB,MAAgC/Z,mBAAS,IAAzC,mBAAOga,EAAP,KAAiBC,EAAjB,KACA,EAAgCja,mBAAS,IAAzC,mBAAOka,EAAP,KAAiBC,EAAjB,KACA,EAAwCna,mBAAS,IAAjD,mBAAOoa,EAAP,KAAqBC,EAArB,KACQ5Z,EAAYF,qBAAWjC,GAAvBmC,QACFX,EAAUC,cA4BhB,OACE,cAAC,GAAD,CAAW2J,eAAgBlL,IAA3B,SACE,eAACqb,GAAD,WACE,8CACA,uDACA,uBAAO9V,KAAK,QAAQ9B,SAAU,SAAClB,GAAOkZ,EAAYlZ,EAAEG,OAAOnD,QAAS8D,YAAY,iBAAM,uBACtF,uDACA,uBAAOkC,KAAK,WAAW9B,SAAU,SAAClB,GAAOoZ,EAAYpZ,EAAEG,OAAOnD,QAAS8D,YAAY,iBAAM,uBACzF,cAACiY,GAAD,UAAeM,IACf,wBAAQlY,QApCM,WAClB,IAAMd,EAAOC,cACjBiZ,YAAelZ,EAAMmZ,KAClB7c,MAAK,WACJ,OAAO8c,YAA2BpZ,EAAM4Y,EAAUE,GACjDxc,MAAK,SAAC+c,GACH,IAAMja,EAAOia,EAAeja,KAC5BC,EAAQD,EAAKY,KAAKsZ,aACfla,GACDV,EAAQkB,KAAK,QAGhBO,OAAM,SAACC,GACN,IAAMmZ,EAAYnZ,EAAMoZ,KAEP,wBAAdD,GACDN,EAAgB,4BAED,wBAAdM,GACDN,EAAgB,wCAIrB9Y,OAAM,SAACC,GACN,OAAOA,MAYL,0BAAyC,uBACzC,cAAC,IAAD,CAAMG,GAAG,YAAT,qFCvGR,I,oCAAMqF,GAAYnI,IAAOC,IAAV,ykBAcE,SAAAK,GAAK,OAAIA,EAAMuK,eAAiB,UAAY,MAGvDmQ,GAAehb,IAAOC,IAAV,qiBAgCH,SAASib,KACtB,MAAgC/Z,mBAAS,IAAzC,mBAAOga,EAAP,KAAiBC,EAAjB,KACA,EAAgCja,mBAAS,IAAzC,mBAAOka,EAAP,KAAiBC,EAAjB,KACA,EAAgCna,mBAAS,IAAzC,mBAAO6a,EAAP,KAAiBC,EAAjB,KACQra,EAAYF,qBAAWjC,GAAvBmC,QACFX,EAAUC,cAsBhB,OACE,cAAC,GAAD,CAAW2J,eAAgBlL,IAA3B,SACE,eAAC,GAAD,WACA,8CACA,uDACA,uBAAOuF,KAAK,QAAQ9B,SAAU,SAAClB,GAAOkZ,EAAYlZ,EAAEG,OAAOnD,QAAS8D,YAAY,iBAAM,uBACtF,uDACA,uBAAOkC,KAAK,WAAW9B,SAAU,SAAClB,GAAOoZ,EAAYpZ,EAAEG,OAAOnD,QAAS8D,YAAY,iBAAM,uBACzF,uDACA,uBAAOkC,KAAK,OAAO9B,SAAU,SAAClB,GAAO+Z,EAAY/Z,EAAEG,OAAOnD,QAAS8D,YAAY,mCAAS,uBACxF,wBAAQK,QA9BW,WACrB,IAAMd,EAAOC,cACb0Z,YAA+B3Z,EAAM4Y,EAAUE,GAC5Cxc,MAAK,SAAC+c,GAEL,IAAMja,EAAOia,EAAeja,KAC5Bwa,YAAc5Z,EAAKsZ,YAAa,CAC9B1W,YAAa6W,IACZnd,MAAK,eACL6D,OAAM,SAACC,OAEVf,EAAQD,EAAKY,KAAKsZ,aACfla,GACDV,EAAQkB,KAAK,QAGhBO,OAAM,SAACC,GACN,OAAOA,MAaT,+BC3EN,I,eAAMwF,GAAYnI,IAAOC,IAAV,oHAMTO,GAAUR,IAAOC,IAAV,4TAiBPmc,GAAsBpc,IAAOC,IAAV,+LAQnBkR,GAAgBnR,IAAOC,IAAV,6IASbmR,GAAiBpR,IAAOC,IAAV,2RAiBdoc,GAAuBrc,IAAOC,IAAV,sHAOpBqc,GAAoBtc,IAAOC,IAAV,2fAoCjBsc,GAAevc,IAAOC,IAAV,0EAIZuc,GAAyBxc,IAAOC,IAAV,2EAMtB8R,GAAiB/R,IAAOC,IAAV,mDAId+R,GAAahS,IAAOC,IAAV,iDAGVoN,GAAQrN,IAAO8F,EAAV,oEAII,SAAS2W,KACtB,MAAoCtb,mBAAS,IAA7C,mBAAOub,EAAP,KAAmBC,EAAnB,KACA,EAA0Cxb,mBAAS,IAAnD,mBAAOyb,EAAP,KAAsBC,EAAtB,KACA,EAAgD1b,mBAAS,IAAzD,mBAAO2b,EAAP,KAAyBC,EAAzB,KACA,EAA4C5b,oBAAS,GAArD,mBAAO6b,EAAP,KAAuBC,EAAvB,KACA,EAA0C9b,mBAAS,IAAnD,mBAAO+b,EAAP,KAAsBC,EAAtB,KACA,EAAoDhc,mBAAS,GAA7D,mBAAOmS,EAAP,KAA2BC,EAA3B,KACA,EAAgDpS,mBAAS,GAAzD,mBAAOqS,EAAP,KAAyBC,EAAzB,KACA,EAAkCtS,oBAAS,GAA3C,mBAAOmH,EAAP,KAAkB+G,EAAlB,KACQ1N,EAASD,qBAAWjC,GAApBkC,KACFV,EAAUC,cACZS,GACFV,EAAQkB,KAAK,UAEfJ,qBAAU,WACR,GAAGJ,EAAK,CAEN,IAAMwH,EAAKC,cACLgU,EAAoBxT,YAAIT,EAAI,YAAcxH,EAAKkI,KACjD4G,EAAS,GACb1G,YAAQqT,GAAmB,SAACpT,GAC1B,IAAMC,EAAOD,EAASE,MACtB,GAAGD,EAAK,CACNwG,EAASnH,OAAOC,KAAKU,GAErB,IADA,IAAIyG,EAAM,GACFlL,EAAI,EAAGA,EAAIiL,EAAOhL,OAAQD,IAChCkL,EAAIvO,KAAKsO,EAAOjL,IAElBmX,EAAcjM,OAMhB,IAAMiD,EAAQrD,YAAM1G,YAAIT,EAAI,YAAayK,YAAa,OAASC,YAAQlS,EAAKkI,MAE5EE,YAAQ4J,GAAO,SAAC3J,GACd,IAAMC,EAAOD,EAASE,MAClBwG,EAAM,GACV,GAAGzG,EAAK,CACN,IAGI6J,EAHAvK,EAAOD,OAAOC,KAAKU,GACnB8J,EAAYrO,KAAKC,KAAK4D,EAAK9D,OAAS,GACxCgO,EAAoBM,GAGlBD,EADCvK,EAAK9D,QAAU,EACV,EAEA8D,EAAK9D,OAEb,IAAI,IAAID,EAAI,EAAGA,EAAIsO,EAAKtO,IACpBkL,EAAIvO,KAAJ,2BAEO8H,EAAKV,EAAK/D,KAFjB,IAGI1E,QAAQ,EACRnC,GAAI4K,EAAK/D,MAIjBuX,EAAoBrM,EAAIsD,kBAI/B,CAACrS,IAEJI,qBAAU,WAAM,4CACd,8BAAA0N,EAAA,sDACEJ,GAAa,GACTqB,EAAM,GACFlL,EAAI,EAHd,YAGiBA,EAAIkX,EAAWjX,QAHhC,gCAIUrG,EAAesd,EAAWlX,IAAI3G,MAAK,SAACC,GACxC4R,EAAIvO,KAAKrD,MALf,OAGwC0G,IAHxC,sBAQEqX,EAAiBnM,GACjBrB,GAAa,GATf,6CADc,uBAAC,WAAD,wBAYdgO,KACC,CAACX,IAEJ,IAAMY,EAA0B,WAC1BN,IACCrb,EAAK+U,aAAa,GAAGvR,YACtBgY,EAAiBxb,EAAK+U,aAAa,GAAGvR,aAEtCgY,EAAiB,KAIrBF,GAAmBD,IAoBfpR,EAAoB,SAACjN,GACzBoe,EAAoBD,EAAiB5V,KAAI,SAAC3B,GACxC,OAAIA,EAAK5G,KAAOA,EAAW4G,EACpB,2BACFA,GADL,IAEEzE,QAASyE,EAAKzE,cAIduU,EAAoB,SAACC,GACzB,IAAMnM,EAAKC,cACLuK,EAAQrD,YAAM1G,YAAIT,EAAI,YAAayK,YAAa,OAASC,YAAQlS,EAAKkI,MACzEyL,EACDvL,YAAQ4J,GAAO,SAAC3J,GACd,IAAMC,EAAOD,EAASE,MAClBwG,EAAM,GACV,GAAGzG,EAAK,CACN,IACI6J,EADAvK,EAAOD,OAAOC,KAAKU,GAGrB6J,EADCvK,EAAK9D,QAA+B,EAArB6N,EAAyB,EACd,EAArBA,EAAyB,EAEzB/J,EAAK9D,OAEb,IAAI,IAAID,EAAyB,EAArB8N,EAAwB9N,EAAIsO,EAAKtO,IAEzCkL,EAAIvO,KAAJ,2BAEO8H,EAAKV,EAAK/D,KAFjB,IAGI1E,QAAQ,EACRnC,GAAI4K,EAAK/D,MAMjBuX,EAAoBrM,EAAIsD,WACxBT,EAAsBD,EAAqB,OAGrCgC,GACVvL,YAAQ4J,GAAO,SAAC3J,GACd,IAAMC,EAAOD,EAASE,MAClBwG,EAAM,GACV,GAAGzG,EAAK,CACN,IACI6J,EADAvK,EAAOD,OAAOC,KAAKU,GAGrB6J,EADCvK,EAAK9D,QAAmC,GAAxB6N,EAAmB,GAAS,EACd,GAAxBA,EAAmB,GAAS,EAE7B/J,EAAK9D,OAEb,IAAI,IAAID,EAA6B,GAAxB8N,EAAmB,GAAQ9N,EAAIsO,EAAKtO,IAE7CkL,EAAIvO,KAAJ,2BAEO8H,EAAKV,EAAK/D,KAFjB,IAGI1E,QAAQ,EACRnC,GAAI4K,EAAK/D,MAMjBuX,EAAoBrM,EAAIsD,WACxBT,EAAsBD,EAAqB,QAMnD,OACE,eAAC,GAAD,WACE,cAAC,GAAD,CAAShL,UAAWA,IACpB,eAAC,GAAD,WACE,oBAAIvF,UAAU,QAAd,0BACA,eAACqZ,GAAD,WACE,cAAC,GAAD,UACE,2DAEF,cAAC,GAAD,UACGza,GACD,sBAAKoB,UAAU,eAAf,UACA,4BAAIpB,EAAK4b,QACT,+DAAS5b,EAAK6b,cAAgB,qBAAQ,8BACtC,eAACjB,GAAD,WACE,oDAAQS,IAAkBrb,EAAK+U,aAAa,GAAGvR,YAAcxD,EAAK+U,aAAa,GAAGvR,YAAc,+BAC/F6X,GACD,gCACE,uBAAO9X,KAAK,OAAOhG,MAAOge,EAAe9Z,SAAU,SAAClB,IA3GhC,SAACA,GACjCib,EAAiBjb,EAAEG,OAAOnD,OA0G6Cue,CAA0Bvb,MAAM,uBAC3F,wBAAQmB,QAzGO,WAC3B,IAAMd,EAAOC,cACe,KAAzB0a,EAAcQ,OACfvB,YAAc5Z,EAAKsZ,YAAa,CAC9B1W,YAAa+X,IACZre,MAAK,WACNoe,GAAkB,MACjBva,OAAM,SAACC,GACR,OAAOA,KAGTiU,MAAM,+CA8FI,0BACA,wBAAQvT,QAASia,EAAjB,8BAIAN,GAAkB,wBAAQ3Z,QAASia,EAAjB,qCAO1B,eAACjB,GAAD,WACA,cAAC,GAAD,uCACE,eAACC,GAAD,WACE,qBAAKvZ,UAAU,QAAf,SACC6Z,EAAc1V,KAAI,SAAC0B,GAClB,OAAO,qBAAK7F,UAAU,iBAAf,SAAgC,cAAC,GAAD,CAAsB6F,MAAOA,EAAOI,OAAM,yCAAoCJ,EAAMK,aAAetK,GAAIiK,EAAMjK,GAAImK,UAAU,GAA/GF,EAAMjK,WAG3D,qBAAKoE,UAAU,QAAf,SACC6Z,EAAc1V,KAAI,SAAC0B,GAClB,OAAO,qBAAK7F,UAAU,iBAAf,SAAgC,cAAC,GAAD,CAAsB6F,MAAOA,EAAOI,OAAM,yCAAoCJ,EAAMK,aAAetK,GAAIiK,EAAMjK,GAAImK,UAAU,GAA/GF,EAAMjK,iBAO/D,eAAC6d,GAAD,WACE,cAAC,GAAD,uCACA,cAAC,GAAD,UAC+B,IAA5BM,EAAiBrX,OAAeqX,EAAiB5V,KAAI,SAAC3B,EAAM+I,GAC3D,OAAO,cAAC,GAAD,CAAS1C,kBAAmBA,EAAmBD,QAASpG,EAAMuG,gBAAgB,EAAMD,cAAc,OACtG,6EAEP,eAAC,GAAD,WAC4B,IAAvByH,GAA2B,wBAAQjQ,QAAS,WAAOgS,GAAkB,IAA1C,eAC3B/B,EACAE,IAAqBF,GAAqB,wBAAQjQ,QAAS,WAAOgS,GAAkB,IAA1C,2BCrXzD,IAAMlN,GAAYnI,IAAOC,IAAV,sjBAgBT0d,GAAe3d,IAAOC,IAAV,oQAkBZ2d,GAAc5d,IAAOC,IAAV,+fAyBXgO,GAAWjO,IAAO8F,EAAV,6GAMRtF,GAAUR,IAAOC,IAAV,qLAITgO,IASW,SAAS4P,KACtB,OACE,eAAC,GAAD,WACE,eAACF,GAAD,WACA,uCACA,2EAEA,eAAC,GAAD,WACA,cAAC,GAAD,2EACA,eAACC,GAAD,WACE,qBAAK7a,UAAU,OAAOkF,IAAI,GAAGC,IAAI,2EACjC,8kBAEF,eAAC0V,GAAD,WACE,qBAAK7a,UAAU,SAASkF,IAAI,GAAGC,IAAI,iFACnC,wmBAEF,eAAC0V,GAAD,WACE,qBAAK7a,UAAU,aAAakF,IAAI,GAAGC,IAAI,4EACvC,suBCpGR,I,MAWe4V,GAXA,CACbC,OAAQ,0CACRC,WAAY,qCACZC,YAAa,yDACbC,UAAW,qBACXC,cAAe,iCACfC,kBAAmB,eACnBC,MAAO,4CACPC,cAAe,gB,2BCDXC,GAAkBve,IAAOC,IAAV,gMAUfue,GAAexe,IAAOC,IAAV,2KAaH,SAASwe,KACtB,OACE,eAACF,GAAD,WACE,eAACC,GAAD,WACE,mBAAGE,KAAK,8BAA8Brc,OAAO,SAASsc,IAAI,aAA1D,SAAuE,cAAC,IAAD,CAAiBrb,KAAMsb,SAC9F,mBAAGF,KAAK,8BAA8Brc,OAAO,SAASsc,IAAI,aAA1D,SAAuE,cAAC,IAAD,CAAiBrb,KAAMub,SAC9F,mBAAGH,KAAK,8BAA8Brc,OAAO,SAASsc,IAAI,aAA1D,SAAuE,cAAC,IAAD,CAAiBrb,KAAMwb,SAC9F,mBAAGJ,KAAK,8BAA8Brc,OAAO,SAASsc,IAAI,aAA1D,SAAuE,cAAC,IAAD,CAAiBrb,KAAMyb,SAC9F,mBAAGL,KAAK,8BAA8Brc,OAAO,SAASsc,IAAI,aAA1D,SAAuE,cAAC,IAAD,CAAiBrb,KAAM0b,YAEhG,cAAC,IAAD,CAAiB1b,KAAM2b,OAAe,8DC6E7BC,OA3Ff,WACE,MAAwB/d,mBAAS,MAAjC,mBAAOQ,EAAP,KAAaC,EAAb,KACA,EAA4BT,oBAAS,GAArC,mBAAOL,EAAP,KAAeqe,EAAf,KACA,EAAwChe,mBAAS,IAAjD,mBAAO+H,EAAP,KAAqBkW,EAArB,KACIC,EAAcvd,iBAAO,GAEnBqH,GADMmW,aAAcxB,IACf1U,eAEL7G,EAAOC,cAoCb,OAnCA+c,YAAmBhd,GAAM,SAACZ,GACpBA,GACFC,EAAQD,EAAKY,KAAKsZ,gBAgBpB7O,OAAOwS,iBAAiB,UAAU,YAVf,WACnB,IAAIC,EAAKzS,OAAO0S,QACbD,EAAKJ,EACNF,GAAU,GACHM,EAAKJ,GACZF,GAAU,GAEZE,EAAcI,EAIZE,MAGF5d,qBAAU,WASHJ,GARL,WACE,IAAMie,EAAWhW,YAAIT,EAAI,YAAcxH,EAAKkI,KAC5CE,YAAQ6V,GAAU,SAAC5V,GACjB,IAAMC,EAAOD,EAASE,MACtBkV,EAAgBnV,MAKhB4V,KAEH,CAACle,IAEJ,cAAClC,EAAYqgB,SAAb,CAAsB5gB,MAAO,CAC3ByC,OACAC,UACAsH,gBAHF,SAKA,qBAAKnG,UAAU,MAAf,SACE,eAAC,IAAD,WACE,cAAC,EAAD,CAAQA,UAAU,SAASjC,OAAQA,IACjC,eAAC,IAAD,WACA,cAAC,IAAD,CAAOif,OAAK,EAACC,KAAK,IAAlB,SACI,cAACzR,GAAD,MAEF,cAAC,IAAD,CAAOwR,OAAK,EAACC,KAAK,aAAlB,SACE,cAAC5N,GAAD,MAEF,cAAC,IAAD,CAAO2N,OAAK,EAACC,KAAK,oBAAlB,SACE,cAAC/I,GAAD,MAEF,cAAC,IAAD,CAAO8I,OAAK,EAACC,KAAK,uBAAlB,SACE,cAACjI,GAAD,MAEF,cAAC,IAAD,CAAOgI,OAAK,EAACC,KAAK,cAAlB,SACE,cAACjG,GAAD,MAEF,cAAC,IAAD,CAAOgG,OAAK,EAACC,KAAK,SAAlB,SACIre,EAAuB,cAAC,IAAD,CAAUmB,GAAG,MAA7B,cAACoY,GAAD,MAEX,cAAC,IAAD,CAAO6E,OAAK,EAACC,KAAK,YAAlB,SACE,cAAC,GAAD,MAEF,cAAC,IAAD,CAAOD,OAAK,EAACC,KAAK,UAAlB,SACE,cAACvD,GAAD,MAEF,cAAC,IAAD,CAAOsD,OAAK,EAACC,KAAK,SAAlB,SACE,cAACnC,GAAD,SAGJ,cAACY,GAAD,YChGKwB,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqBthB,MAAK,YAAkD,IAA/CuhB,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCAdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,KAAD,UACA,cAAC,GAAD,QAGFC,SAASC,eAAe,SAM1BZ,M","file":"static/js/main.f3fd2985.chunk.js","sourcesContent":["export const getPopular = () => fetch(`https://api.themoviedb.org/3/movie/popular?api_key=2be0c0fc4fb985246d2226af126346c2&language=en-US&region=TW&page=1`)\r\n.then((res) => res.json())\r\n\r\nexport const getMovieRating = (id) => fetch(`https://www.omdbapi.com/?i=${id}&apikey=382fad7&tomatoes=true`)\r\n.then((res) => res.json())\r\n\r\nexport const getIMDBID = (id) => fetch(`https://api.themoviedb.org/3/movie/${id}/external_ids?api_key=2be0c0fc4fb985246d2226af126346c2`)\r\n.then((res) => res.json())\r\n\r\nexport const getSearchData = (value, page=1) => fetch(`https://api.themoviedb.org/3/search/multi?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW&query=${value}&page=${page}`)\r\n.then((res) => res.json())\r\n\r\nexport const getMovieDeatil = (id) => fetch(`https://api.themoviedb.org/3/movie/${id}?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW&append_to_response=keywords,external_ids`)\r\n.then((res) => res.json())\r\n\r\nexport const getRecommendations = (id) => fetch(`https://api.themoviedb.org/3/movie/${id}/recommendations?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW`)\r\n.then((res) => res.json())\r\n\r\nexport const getSimilar = (id) => fetch(`https://api.themoviedb.org/3/movie/${id}/similar?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW`)\r\n.then((res) => res.json())\r\n\r\nexport const getCredits = (id) => fetch(`https://api.themoviedb.org/3/movie/${id}/credits?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW`)\r\n.then((res) => res.json())\r\n\r\nexport const getTrend = () => fetch(`https://api.themoviedb.org/3/trending/movie/week?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW`)\r\n.then((res) => res.json())\r\n\r\nexport const getGenre = () => fetch(`https://api.themoviedb.org/3/genre/movie/list?api_key=2be0c0fc4fb985246d2226af126346c2&language=en-US`)\r\n.then((res) => res.json())\r\n\r\nexport const getGenreSearch = (id, page=1) => fetch(`https://api.themoviedb.org/3/discover/movie?api_key=2be0c0fc4fb985246d2226af126346c2&language=en-US&region=TW&with_genres=${id}&page=${page}`)\r\n.then((res) => res.json())\r\n\r\nexport const getUpcomming = () => fetch(`https://api.themoviedb.org/3/movie/upcoming?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW&region=TW,US`)\r\n.then((res) => res.json())\r\n\r\nexport const getPopularPeople = () => fetch(`https://api.themoviedb.org/3/person/popular?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW`)\r\n.then((res) => res.json())\r\n\r\nexport const getVideo = (id) => fetch(`https://api.themoviedb.org/3/movie/${id}/videos?api_key=2be0c0fc4fb985246d2226af126346c2`)\r\n.then((res) => res.json())\r\n\r\nexport const getPeopleDetail = (id) => fetch(`https://api.themoviedb.org/3/person/${id}?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW&append_to_response=images,tagged_images`)\r\n.then((res) => res.json())\r\n\r\nexport const getPeopleDetailEng = (id) => fetch(`https://api.themoviedb.org/3/person/${id}?api_key=2be0c0fc4fb985246d2226af126346c2&language=en-US`)\r\n.then((res) => res.json())\r\n\r\nexport const getPeopleMovies = (id) => fetch(`https://api.themoviedb.org/3/person/${id}/movie_credits?api_key=2be0c0fc4fb985246d2226af126346c2&language=zh-TW`)\r\n.then((res) => res.json())\r\n\r\nexport const getMovieImage = (id) => fetch(`https://api.themoviedb.org/3/movie/${id}/images?api_key=2be0c0fc4fb985246d2226af126346c2`)\r\n.then((res) => res.json())","import { createContext } from 'react'\r\n\r\nconst AuthContext = createContext(null)\r\nexport { AuthContext as default }","const TOKEN_NAME = 'token'\r\nexport const setAuthToken = (token) => {\r\n  localStorage.setItem(TOKEN_NAME, token)\r\n}\r\nexport const getAuthToken = () => localStorage.getItem(TOKEN_NAME)\r\n\r\nexport const getDate = () => {\r\n  let Today = new Date()\r\n  const doubleMonth = [\"10\", \"11\", \"12\"]\r\n  const oddDate = [\"1\", \"2\", \"3\" , \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"]\r\n  let month = \"\"\r\n  let day = \"\"\r\n  if(!doubleMonth.includes((Today.getMonth()+1).toString())){\r\n    month = \"0\" + (Today.getMonth()+1).toString()\r\n  } else {\r\n    month = (Today.getMonth()+1).toString()\r\n  }\r\n  if(oddDate.includes((Today.getDate()).toString())){\r\n    day = \"0\" + (Today.getDate()).toString()\r\n  } else {\r\n    day = (Today.getDate()).toString()\r\n  }\r\n  return Today.getFullYear().toString() + month + day\r\n}\r\nexport const getCreatedAt = () => {\r\n  let Today = new Date()\r\n  return Today.getTime()\r\n}\r\nexport const getUserDeviceType = () => {\r\n  if( navigator.userAgent.match(/Android/i)\r\n || navigator.userAgent.match(/webOS/i)\r\n || navigator.userAgent.match(/iPhone/i)\r\n || navigator.userAgent.match(/iPad/i)\r\n || navigator.userAgent.match(/iPod/i)\r\n || navigator.userAgent.match(/BlackBerry/i)\r\n || navigator.userAgent.match(/Windows Phone/i)\r\n ){\r\n    return true;\r\n  }\r\n else {\r\n    return false;\r\n  }\r\n}\r\n","import React, { useContext, useEffect, useState, useRef } from 'react'\r\nimport styled from 'styled-components'\r\nimport { Link, useLocation, useHistory } from 'react-router-dom'\r\nimport { getSearchData } from '../WebAPI'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faSearch, faUserCircle, faBars } from '@fortawesome/free-solid-svg-icons'\r\nimport { getAuth, signOut } from \"firebase/auth\"\r\nimport AuthContext from '../context'\r\nimport { getUserDeviceType }from '../utils.js'\r\n\r\nconst HeaderContainer = styled.div`\r\n  align-items: center;\r\n  height: auto;\r\n  background-color: white;\r\n  width: 100%;\r\n  padding-top: 20px;\r\n  color: white;\r\n  position: fixed;\r\n  top: 0;\r\n  z-index: 99;\r\n  background: transparent;\r\n  transition: all .4s ease-in-out;\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n\r\n  @media (max-width: 415px) {\r\n    .RWD-S{\r\n      display: block;\r\n    } \r\n  }\r\n`\r\nconst Brand = styled(Link)`\r\n  display: block;\r\n  font-size: 1.1rem;\r\n  font-weight: bold;\r\n  text-decoration: none;\r\n  color: white;\r\n  @media (max-width: 415px) {\r\n    font-size: 2.5rem;\r\n    margin-left: 20px; \r\n  }\r\n`\r\nconst NavbarList = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  height: 100%;\r\n  width: 30%;\r\n  color: white;\r\n  .ham{\r\n    display: none;\r\n  }\r\n  @media (max-width: 415px) {\r\n   .ham{\r\n     display: inline-block;\r\n   }\r\n   .RWD-L{\r\n     display: none;\r\n   }\r\n  }\r\n`\r\nconst Nav = styled(Link)`\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100%;\r\n  box-sizing: border-box;\r\n  width: 30%;\r\n  cursor: pointer;\r\n  color: white;\r\n  text-decoration: none;\r\n  font-size: 0.47rem;\r\n  ${(props) => props.$active &&\r\n  `\r\n    background: rgba(0, 0, 0, 0.1)\r\n  `}\r\n  @media (max-width: 415px) {\r\n    font-size: 2.5rem;\r\n    width: 50%;\r\n  }\r\n`\r\nconst Wrapper = styled.div`\r\n  display: flex;\r\n  max-width: 80%;\r\n  margin: 0 auto;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  @media (max-width: 415px) {\r\n    max-width: 95%;\r\n    .RWD-L{\r\n      display: none;\r\n    } \r\n  }\r\n`\r\nconst Search = styled.div`\r\n  position: relative;\r\n  width: 30%;\r\n  input{\r\n    display: block;\r\n    height: 60%;\r\n    border-radius: 30px;\r\n    outline: none;\r\n    padding: 3% 0;\r\n    position: relative;\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    font-size: 0.5rem;\r\n    text-indent: 10px;\r\n  }\r\n  input, textarea {\r\n\r\n    font-size: initial;\r\n    \r\n    }\r\n  @media (max-width: 415px) {\r\n    width: 90%;\r\n    margin: 0 auto;\r\n    input{\r\n      color: white;\r\n      background: transparent;\r\n      border: none;\r\n      border-bottom: 1px solid white;\r\n      border-radius: 0;\r\n    }\r\n    input::placeholder{\r\n      color: white;\r\n    }\r\n  }\r\n`\r\nconst SearchIcon = styled.button`\r\n  font-size: 0.5rem;\r\n  position: absolute;\r\n  right: 2%;\r\n  top:50%;\r\n  transform: translateY(-50%);\r\n  background: transparent;\r\n  border: none;\r\n  cursor: pointer;\r\n  @media (max-width: 415px) {\r\n    position: static;\r\n    color: white;\r\n    font-size: 2rem;\r\n    .RWD-S{\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      height: 100%;\r\n    }\r\n  }\r\n`\r\nconst HamList = styled.div`\r\n  text-align: center;\r\n  position: absolute;\r\n  right: 2%;\r\n  margin-top: 3%;\r\n  text-align: center;\r\n  transition: all 0.5s ease-in;\r\n  border-radius: 10px;\r\n  background: white;\r\n  display: none;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  width: 25%;\r\n  a{\r\n    display: block;\r\n    color: black;\r\n    font-size: 0.5rem;\r\n    margin: 5% 0;\r\n    svg{\r\n      font-size: 1.5rem;\r\n    }\r\n  }\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n  @media (max-width: 415px) {\r\n    display: flex;\r\n    color: black;\r\n    a{\r\n      font-size: 14px;\r\n    }\r\n\r\n    .RWD-S{\r\n      display: block;\r\n    } \r\n  }\r\n`\r\nfunction Header({ isHide }) {\r\n  const location = useLocation()\r\n  const history = useHistory()\r\n  const [search, setSearch] = useState('')\r\n  const [isHamOpen, setIsHamOpen] = useState(false)\r\n  const [isHamSearchOpen, setIsHamSearchOpen] = useState(false)\r\n  const { user, setUser } = useContext(AuthContext)\r\n  const userDevice = useRef()\r\n\r\n  useEffect(() => {\r\n    userDevice.current = getUserDeviceType()\r\n  }, [])\r\n\r\n  const handleKeyPressSearch = (e) => {\r\n    if(e.key === 'Enter'){\r\n      setSearch('')\r\n      getSearchData(search).then((res) => {\r\n        history.push(`/search/movie/${search}`)\r\n      })\r\n      setIsHamSearchOpen(false)\r\n    }\r\n    // setSearch('')\r\n    // getSearchData(search).then((res) => {\r\n    //   history.push(`/search/movie/${search}`)\r\n    // })\r\n  }\r\n  const handleSearch = (e) => {\r\n    setSearch('')\r\n    getSearchData(search).then((res) => {\r\n      history.push(`/search/movie/${search}`)\r\n    })\r\n  }\r\n  const handleValueChange = (e) => {\r\n    setSearch(e.target.value)\r\n  }\r\n\r\n  const handleLogout = () => {\r\n    const auth = getAuth();\r\n    signOut(auth).then(() => {\r\n      setUser(null)\r\n      // Sign-out successful.\r\n    }).catch((error) => {\r\n      return error\r\n      // An error happened.\r\n    });\r\n  }\r\n  const handleSearchIconOpen = (e) => {\r\n    e.preventDefault()\r\n    setIsHamOpen(false)\r\n    setIsHamSearchOpen(!isHamSearchOpen)\r\n  }\r\n  const handleHamListOpen = (e) => {\r\n    e.preventDefault()\r\n    setIsHamOpen(!isHamOpen)\r\n    setIsHamSearchOpen(false)\r\n  }\r\n  useEffect(() => {\r\n    if (isHide === true) {\r\n      setIsHamOpen(false)\r\n    }\r\n  },[isHide])\r\n  return (\r\n    <HeaderContainer style={!userDevice.current ? {top: isHide ? '-200px' : '0px'} : {top: '0px'}}>\r\n      <Wrapper>\r\n        <Brand to=\"/\">Fun電影</Brand>\r\n        <Search className=\"RWD-L\">\r\n        <input value={search} placeholder=\"搜尋您想要的電影, 人物....\" onKeyPress={(e) => {handleKeyPressSearch(e)}} onChange={(e) => {handleValueChange(e)}}></input>\r\n        <SearchIcon onClick={handleSearch} ><FontAwesomeIcon icon={faSearch} /></SearchIcon>    \r\n      </Search>\r\n        <NavbarList>\r\n          <Nav className=\"RWD-L\" to=\"/about\" $active={location.pathname === '/about'}>about</Nav>\r\n          {!user && <Nav className=\"RWD-L\" to=\"/login\" >登入</Nav>}\r\n          {user && <Nav className=\"RWD-L\" to=\"/login\" onClick={handleLogout}>登出</Nav>}\r\n          <Nav to=\"/member\" className=\"RWD-L\"><FontAwesomeIcon icon={faUserCircle} /></Nav>\r\n           <Nav to=\"\" className=\"RWD-S\" onClick={handleSearchIconOpen}><FontAwesomeIcon icon={faSearch} /></Nav>\r\n          <Nav className=\"ham\" to=\"\" onClick={handleHamListOpen}><FontAwesomeIcon icon={faBars} /></Nav>\r\n        </NavbarList>\r\n      </Wrapper>\r\n     \r\n      <HamList style={{right: isHamOpen ? '1%' : '-200px'}}> \r\n        {!user && <Nav to=\"/login\" >登入</Nav>}\r\n        {user && <Nav to=\"/login\" onClick={handleLogout}>登出</Nav>}\r\n        <Nav to=\"/member\" ><FontAwesomeIcon icon={faUserCircle} /></Nav>\r\n        <Nav to=\"/about\" $active={location.pathname === '/about'}>about</Nav>\r\n      </HamList>\r\n      <Search className=\"RWD-S\">\r\n          {isHamSearchOpen && <input value={search} placeholder=\"搜尋您想要的電影, 人物....\" onKeyPress={(e) => {handleSearch(e)}} onChange={(e) => {handleValueChange(e)}}></input>}\r\n          {/* {!isHamSearchOpen && <SearchIcon onClick={() => {setIsHamSearchOpen(!isHamSearchOpen)}}><FontAwesomeIcon icon={faSearch} /></SearchIcon> }    */}\r\n        </Search>\r\n      {/* </RWDSRightSection> */}\r\n\r\n    </HeaderContainer>\r\n  )\r\n}\r\n\r\nexport default React.memo(Header, (prevProps, nextProps) => {\r\n\r\n  if (prevProps.isHide !== nextProps.isHide) {\r\n    return false //re-render\r\n  }\r\n  return true //不會 Re-render\r\n});","import React, { useState, useCallback, useRef } from 'react'\r\nimport './Carousel.css'\r\n\r\nconst Item = ({ children }) => <div>{children}</div>\r\n\r\nconst CAROUSEL_ITEM = 'CAROUSEL_ITEM'\r\nconst Carousel = ({ cols = 1, gap = 10, children }) => {\r\n  const [currentPage, setCurrentPage] = useState(0)\r\n\r\n  // const [startX, setStartX] = useState(0)\r\n  // const [startY, setStartY] = useState(0)\r\n  // const [endX, setEndX] = useState(0)\r\n  // const [endY, setEndY] = useState(0)\r\n\r\n  // let startX = useRef(0)\r\n  // let startY = useRef(0)\r\n  // let endX = useRef(0)\r\n  // let endY = useRef(0)\r\n\r\n  let startX = 0\r\n  let startY = 0\r\n  let endX = 0\r\n  let endY = 0\r\n\r\n  const itemList = React.Children.toArray(children).filter(\r\n    child => child.type.displayName === CAROUSEL_ITEM\r\n  )\r\n\r\n  const itemSetList = itemList.reduce((result, item, i) => {\r\n    if (i % cols === 0) {\r\n      result.push([<Item key={i}>{item}</Item>])\r\n    } else {\r\n      result[result.length - 1].push(<Item key={i}>{item}</Item>)\r\n    }\r\n\r\n    return result\r\n  }, [])\r\n\r\n  const page = Math.ceil(itemList.length / cols)\r\n\r\n  const handlePrev = useCallback(() => {\r\n    setCurrentPage(p => p - 1)\r\n  }, [])\r\n\r\n  const handleNext = useCallback(() => {\r\n    setCurrentPage(p => p + 1)\r\n  }, [])\r\n\r\n  //自己改Start\r\n  const handleTouchStart = (e) => {\r\n    // e.preventDefault()\r\n    console.log('start',e.touches[0].pageX)\r\n    // setStartX(e.touches[0].pageX)\r\n    // setStartY(e.touches[0].pagey)\r\n    startX = e.touches[0].pageX\r\n    startY = e.touches[0].pageY\r\n  }\r\n  const handleTouchMove = (e) => {\r\n    console.log('move',e.touches[0].pageX)\r\n    // e.preventDefault()\r\n    // setEndX(e.touches[0].pageX)\r\n    // setEndY(e.touches[0].pagey)\r\n    endX = e.touches[0].pageX\r\n    endY = e.touches[0].pageY\r\n  }\r\n  \r\n  const handleTouchEnd = (e) => {\r\n    let X = endX - startX\r\n    let Y = endY - startY\r\n    console.log('X', X)\r\n    if (X > 0 && Math.abs(X) > Math.abs(Y)) {\r\n      //向右\r\n      if (currentPage > 0) {\r\n        setCurrentPage(p => p - 1)\r\n      }\r\n\r\n      console.log('向右');\r\n    } else if (X < 0 && Math.abs(X) > Math.abs(Y)) {\r\n      //向左\r\n      console.log('向左');\r\n      if(currentPage !== page - 1){\r\n        setCurrentPage(p => p + 1)\r\n      }\r\n\r\n    } else if (Y > 0 && Math.abs(Y) > Math.abs(X)) {\r\n      //向下\r\n      console.log('向下');\r\n    } else if (Y < 0 && Math.abs(Y) > Math.abs(X)) {\r\n      //向上\r\n      console.log('向上');\r\n    } else {\r\n      //没有\r\n      console.log('没有');\r\n    }\r\n  }\r\n  //自己改End\r\n  return (\r\n    <div className=\"Carousel\" onTouchStart={(e) => handleTouchStart(e)} onTouchMove={e => handleTouchMove(e)} onTouchEnd={(e) => handleTouchEnd(e)}>\r\n      <span\r\n        className=\"Carousel__btn--prev\"\r\n        hidden={currentPage <= 0}\r\n        onClick={handlePrev}\r\n      />\r\n      <div className=\"Carousel__railWrapper\">\r\n        <div\r\n          className=\"Carousel__rail\"\r\n          style={{\r\n            gridTemplateColumns: `repeat(${page}, 100%)`,\r\n            left: `calc(${-100 * currentPage}% - ${gap * currentPage}px)`,\r\n            gridColumnGap: `${gap}px`\r\n          }}\r\n        >\r\n          {itemSetList.map((set, i) => (\r\n            <div\r\n              key={i}\r\n              className=\"Carousel__ItemSet\"\r\n              style={{\r\n                display: 'grid',\r\n                gridTemplateColumns: `repeat(${cols}, 1fr)`,\r\n                gridGap: `${gap}px`\r\n              }}\r\n            >\r\n              {set}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      <span\r\n        className=\"Carousel__btn--next\"\r\n        hidden={currentPage === page - 1}\r\n        onClick={handleNext}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nCarousel.Item = ({ children }) => children\r\nCarousel.Item.displayName = CAROUSEL_ITEM\r\nexport default Carousel\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst RatingList = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 30% 30% 30%;\r\n  align-items: end;\r\n  list-style-type:none;\r\n  li{\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    margin-right: 2%;\r\n    img{\r\n      margin: 0 auto;\r\n    }\r\n    .logo{\r\n      width: 60%;\r\n    }\r\n    .T_logo{\r\n      padding: 6%;\r\n    }\r\n    .M_logo{\r\n      padding: 8%;\r\n    }\r\n  }\r\n  @media (max-width: 415px) {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: cetner;\r\n    li{\r\n      .logo{\r\n        width: 50%;\r\n      }\r\n      .T_logo{\r\n        padding: 3%;\r\n      }\r\n      .M_logo{\r\n        padding: 5%;\r\n      }\r\n    }\r\n\r\n  }\r\n`\r\nconst Score = styled.span`\r\n  display: inline-block;\r\n  font-size: 18px;\r\n`\r\n\r\nexport default function Rating({Ratings, logoWidth=\"75px\"}) { \r\n  \r\n  let IMDB = ''\r\n  let tomatoes = ''\r\n  let Metacritic = ''\r\n  if (Ratings) {\r\n    for(let i = 0; i < Ratings.length; i++) {\r\n      if (Ratings[i].Source === 'Internet Movie Database') {\r\n        IMDB = Ratings[i].Value\r\n      }\r\n      if (Ratings[i].Source === 'Rotten Tomatoes') {\r\n        tomatoes = Ratings[i].Value\r\n      }\r\n      if (Ratings[i].Source === 'Metacritic') {\r\n        Metacritic = Ratings[i].Value\r\n      }\r\n    }\r\n  }\r\n  return (\r\n    <RatingList logoWidth={logoWidth}>\r\n      <li><div className=\"logo\"><img className=\"logo I_logo\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/6/69/IMDB_Logo_2016.svg\"/></div><Score>{IMDB !== '' ? IMDB : 'None'}</Score></li>\r\n      <li><div className=\"logo\"><img className=\"logo T_logo\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/6/6f/Rotten_Tomatoes_logo.svg\"/></div><Score>{tomatoes  !== '' ? tomatoes : 'None'}</Score></li>\r\n      <li><div className=\"logo\"><img className=\"logo M_logo\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/4/48/Metacritic_logo.svg\"/></div><Score>{Metacritic  !== '' ? Metacritic : 'None'}</Score></li>\r\n    </RatingList>\r\n  )\r\n}","export default __webpack_public_path__ + \"static/media/ZZ5H.a1a99674.gif\";","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport loadingImg from './ZZ5H.gif'\r\n\r\nconst Container = styled.div`\r\n  background: rgba(255, 255, 255, 1);\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  left: 0;\r\n  z-index: 99999;\r\n  img{\r\n    height: 30px;\r\n    width: 30px;\r\n  }\r\n`\r\nconst ImgContainer = styled.div`\r\n  position: absolute;\r\n  top:40%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n`\r\nexport default function Loading ({ isLoading=false }) {\r\n\r\n  return (\r\n    <div>\r\n      {isLoading && <Container>\r\n        <ImgContainer>\r\n          <img src={loadingImg} alt=\"\"/>\r\n        </ImgContainer>\r\n      </Container>}\r\n    </div>\r\n\r\n  )\r\n}","import React, { useContext, useRef } from 'react'\r\nimport styled from 'styled-components'\r\nimport { Link } from 'react-router-dom'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faPlus, faCheck  } from '@fortawesome/free-solid-svg-icons'\r\nimport AuthContext from '../context'\r\nimport {\r\n  getDatabase,\r\n  ref,\r\n  onValue,\r\n  set,\r\n  runTransaction\r\n} from \"firebase/database\"\r\nimport RatingLoading from './RatingLoading'\r\n\r\nconst MovieContainer = styled.div`\r\n  height: 100%;\r\n  width: 100%;\r\n`\r\nconst ImgContainer = styled(Link)`\r\n  display: flex;\r\n  height: auto;\r\n  width: 100%; \r\n  align-items: end;\r\n  justify-content: end;\r\n  background-position: center;\r\n  background-size: cover;\r\n  background-repeat: no-repeat;\r\n  position: relative;\r\n  padding: 80.63% 0;\r\n`\r\nconst RatingListRow = styled.div`\r\n  text-align: left;\r\n  background: white;\r\n  color: black;\r\n  list-style: none;\r\n  border-radius: 5px;\r\n  border: 3px solid grey;\r\n  font-size: 0.5rem;\r\n  font-weight: bold;\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  width: 30%;\r\n  margin-right: 0;\r\n  .logo{\r\n    width: 30%;\r\n  }\r\n  .I_logo{\r\n    padding: 8%;\r\n  }\r\n  li{\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  @media (max-width: 1200px) {\r\n    width: 45%;\r\n  }\r\n  @media (max-width: 415px) {\r\n    width: 55%;\r\n    margin-right: 0;\r\n    font-size: 14px;\r\n    .logo{\r\n      width: 30%;\r\n    }\r\n  }\r\n`\r\nconst Heart = styled.div`\r\n  svg{\r\n    display: block;\r\n    color: white;\r\n    font-weight: bold;\r\n    font-size: 1rem;\r\n    box-sizing: border-box;\r\n    position: absolute;\r\n    top: 1%;\r\n    right: 1%;\r\n    background: grey;\r\n    border: 3px solid grey;\r\n    border-radius: 50%;\r\n  }\r\n  &:hover{\r\n    \r\n  }\r\n  @media (max-width: 815px) {\r\n    svg{\r\n      font-size: 1.7rem\r\n    }\r\n  }\r\n  @media (max-width: 415px) {\r\n    svg{\r\n      font-size: 3.5rem\r\n    }\r\n  }\r\n`\r\nconst Score = styled.span`\r\n  display: inline-block;\r\n  font-size: 12px;\r\n`\r\nfunction Movie ({\r\n  movie,\r\n  rating,\r\n  isRating=false,\r\n  isRatingLoading=false }) { \r\n\r\n  const imgUrl = `https://image.tmdb.org/t/p/w500${movie.poster_path}`\r\n  let id = movie.id\r\n  const { user } = useContext(AuthContext)\r\n  const { userFavorite } = useContext(AuthContext)\r\n  const db = getDatabase()\r\n  let keysArr = []\r\n  if((userFavorite !== null) && (Object.keys(userFavorite).length !== 0)){\r\n    keysArr = Object.keys(userFavorite)\r\n  }\r\n  let IMDB = ''\r\n  let tomatoes = ''\r\n  let Metacritic = ''\r\n  if (rating) {\r\n    for(let i = 0; i < rating.length; i++) {\r\n      if (rating[i].Source === 'Internet Movie Database') {\r\n        IMDB = rating[i].Value\r\n      }\r\n      if (rating[i].Source === 'Rotten Tomatoes') {\r\n        tomatoes = rating[i].Value\r\n      }\r\n      if (rating[i].Source === 'Metacritic') {\r\n        Metacritic = rating[i].Value\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleFavoriteMovie = (e) => {\r\n    e.preventDefault()\r\n    //let favoriteMovieIdArr = Object.keys(userFavorite)\r\n    if(user && keysArr.includes(id.toString())) {\r\n      runTransaction(ref(db, 'favorite/' + user.uid), (movie) => {\r\n        console.log('hello1')\r\n        if (movie) {\r\n          movie[`${id}`] = null\r\n        }\r\n        return movie\r\n      });\r\n    } else if (user && !keysArr.includes(id.toString())) {\r\n      let checkData\r\n      onValue(ref(db, 'favorite/' + user.uid), (snapshot) => {\r\n        const data = snapshot.val();\r\n        checkData = data\r\n      });\r\n      if(!checkData) {\r\n        let obj = {}\r\n        obj[`${id}`] = 1;\r\n        set(ref(db, 'favorite/' + user.uid), obj);\r\n      } else {\r\n        runTransaction(ref(db, 'favorite/' + user.uid), (movie) => {\r\n          if (movie) {\r\n            if(keysArr.length === 0){\r\n              movie[`${id}`] = {};\r\n            }\r\n            movie[`${id}`] = 1;\r\n          }\r\n          return movie;\r\n        });\r\n      }\r\n    }\r\n  }\r\n  return (\r\n    <MovieContainer>\r\n      <ImgContainer\r\n      style={{backgroundImage: movie.poster_path ? `url(\"${imgUrl}\")`: `url(\"https://www.publicdomainpictures.net/pictures/280000/velka/not-found-image-15383864787lu.jpg\")`}} to={`/movie/${id}`}>\r\n      {user && \r\n      <Heart onClick={handleFavoriteMovie}>\r\n        {keysArr.includes(id.toString()) ? <FontAwesomeIcon icon={faCheck} /> : <FontAwesomeIcon icon={faPlus} />}\r\n      </Heart>}\r\n        {isRating &&\r\n        <RatingListRow>\r\n          <RatingLoading isLoading={isRatingLoading} />\r\n          <li><img className=\"logo I_logo\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/6/69/IMDB_Logo_2016.svg\"/><Score>{IMDB !== '' ? IMDB : 'None'}</Score></li>\r\n          <li><img className=\"logo T_logo\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/6/6f/Rotten_Tomatoes_logo.svg\"/><Score>{tomatoes  !== '' ? tomatoes : 'None'}</Score></li>\r\n          <li><img className=\"logo M_logo\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/4/48/Metacritic_logo.svg\"/><Score>{Metacritic  !== '' ? Metacritic : 'None'}</Score></li>\r\n        </RatingListRow>}\r\n      </ImgContainer>\r\n    </MovieContainer>\r\n  )\r\n}\r\n\r\nexport default React.memo(Movie, (prevProps, nextProps) => {\r\n\r\n  if (prevProps.isRatingLoading !== nextProps.isRatingLoading) {\r\n    return false //re-render\r\n  }\r\n  return true //不會 Re-render\r\n});","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { Link } from 'react-router-dom'\r\n\r\nconst ImgContainer = styled(Link)`\r\n  display: inline-block;\r\n  width: 100%;\r\n  padding: 70% 0;\r\n  margin-right: 5%;\r\n  background-position: center;\r\n  background-size: cover;\r\n  background-repeat: no-repeat;\r\n  @media (max-width: 415px) {\r\n    \r\n  }\r\n`\r\nconst CreditName = styled.p`\r\n  color: white;\r\n  font-size: 0.5rem;\r\n  @media(max-width: 415px) {\r\n    font-size: 14px;\r\n  }\r\n`\r\nexport default function Person ({ person, isName=true }) { \r\n  return (\r\n    <div>\r\n    <ImgContainer style={{ \r\n      backgroundImage: person.profile_path ? `url(\"https://image.tmdb.org/t/p/w500${person.profile_path}\")` : `url(\"https://www.publicdomainpictures.net/pictures/280000/velka/not-found-image-15383864787lu.jpg\")` \r\n    }} to={`/credit/${person.id}`}>     \r\n    </ImgContainer>\r\n    {isName && <CreditName>{person.name}</CreditName>}\r\n    </div>\r\n\r\n  )\r\n}","export default __webpack_public_path__ + \"static/media/giphy.4d579986.gif\";","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport loadingImg from './giphy.gif'\r\n\r\nconst Container = styled.div`\r\n  background: rgba(0, 0, 0, 0.95);\r\n  position: fixed;\r\n  top: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  left: 0;\r\n  z-index: 99999;\r\n  img{\r\n    height: 150px;\r\n    width: 150px;\r\n  }\r\n`\r\nconst ImgContainer = styled.div`\r\n  position: absolute;\r\n  top:40%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n`\r\nexport default function Loading ({ isLoading=false }) {\r\n\r\n  return (\r\n    <div>\r\n      {isLoading && <Container>\r\n        <ImgContainer>\r\n          <img src={loadingImg} alt=\"\"/>\r\n        </ImgContainer>\r\n      </Container>}\r\n    </div>\r\n\r\n  )\r\n}","import React, { useContext, useEffect, useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useHistory, Link } from 'react-router-dom'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faThumbsUp } from '@fortawesome/free-solid-svg-icons'\r\nimport AuthContext from '../context'\r\nimport { getDatabase, ref, runTransaction, update, set } from \"firebase/database\"\r\nimport { getMovieDeatil } from '../WebAPI'\r\nimport { getUserDeviceType } from '../utils'\r\n\r\nconst CommentContainer = styled.div`\r\n  min-width: 70%;\r\n  margin: 0 auto;\r\n  p{\r\n    text-align: left;\r\n  }\r\n  margin-bottom: 40px;\r\n  textarea{\r\n    width: 85%;\r\n    height: 100px;\r\n    margin-top: 20px;\r\n  }\r\n  input, textarea{\r\n    font-size: ${props => props.isMobileDevice ? \"initial\" : \"\"}\r\n  }\r\n  @media (max-width: 415px) {\r\n    min-width: 85%;\r\n\r\n  }\r\n`\r\nconst TitleWrapper = styled.div`\r\n\r\n  h2{\r\n    cursor: pointer;\r\n  }\r\n  @media (max-width: 415px) {\r\n    display: block;\r\n    \r\n  }\r\n`\r\nconst ThumbWrapper = styled.div`\r\n  font-size: 0.5rem;\r\n  box-sizing: border-box;\r\n  width: 100%;\r\n  margin: 0 auto;\r\n  @media (max-width: 813px) {\r\n\r\n    font-size: 0.8rem\r\n  }\r\n  @media (max-width: 415px) {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    font-size: 2rem;\r\n  }\r\n`\r\nconst Date = styled.span`\r\n  \r\n`\r\nconst Thumb = styled.span`\r\n  cursor: pointer;\r\n  display: block;\r\n  border: 3px solid #acb9cc;\r\n  box-sizing: border-box;\r\n  border-radius: 8px;\r\n  padding: 8% 0;\r\n  width: 100%;\r\n  &:hover{\r\n    background: #edf0f9;\r\n    color: black;\r\n  }\r\n  @media (max-width: 415px) {\r\n    padding: 8% 2%;\r\n  }\r\n`\r\nconst TitleSection = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  font-size: 0.4rem;\r\n  display: grid;\r\n  grid-template-columns: ${props => props.column};\r\n  button{\r\n    margin-right: 20px;\r\n  }\r\n  h2{\r\n    display: -webkit-box;\r\n    overflow:hidden;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    -webkit-line-clamp: 4;\r\n    -webkit-box-orient: vertical;\r\n    white-space: normal;\r\n  }\r\n  @media (max-width: 415px) {\r\n    font-size: 14px;\r\n    display: grid;\r\n    grid-template-columns: ${props => props.RWDS_column};\r\n  }\r\n`\r\nconst ImgContainer = styled(Link)`\r\n  display: block;\r\n  width: 200px;\r\n  height: 100px;\r\n  width: 100%;\r\n  height: auto;\r\n  padding: 68% 0;\r\n\r\n  background-size: cover;\r\n  background-position: center;\r\n  background-repeat: no-repeat;\r\n  @media (max-width: 415px) {\r\n    width: 100%;\r\n  }\r\n`\r\nconst ButtonSection = styled.div`\r\n@media (max-width: 415px) {\r\n  \r\n}\r\n`\r\nconst TitleAndDate = styled.div`\r\n  text-align: left;\r\n  margin-left: ${props => props.TitleMargin};\r\n  span{\r\n    display: inline-block;\r\n    font-size: 12px;\r\n  }\r\n  h2{\r\n    margin-bottom: 5%;\r\n  }\r\n  input{\r\n    display: block;\r\n  }\r\n`\r\nconst EditButton = styled.div`\r\n  margin-top: 3%;\r\n`\r\nconst Content = styled.p`\r\n  font-size: 0.4rem;\r\n  margin: 0 auto;\r\n  margin-top: 4%;\r\n  line-height: 1.5;\r\n  @media (max-width: 415px) {\r\n    font-size: 14px;\r\n  }\r\n`\r\nexport default function Comments({ comment, handleCommentOpen, isPosterOpen=false, isThumbsUpOpen=true }) {\r\n  const { user } = useContext(AuthContext)\r\n  const history = useHistory()\r\n  const [movie, setMovie] = useState(null)\r\n  const [isEdit, setIsEdit] = useState(false)\r\n  const [titleValue, setTitleValue] = useState('')\r\n  const [contentValue, setContentValue] = useState('')\r\n  let thumbsUpUsers = []\r\n  \r\n  if(comment.thumbs_up_user){\r\n    thumbsUpUsers = Object.keys(comment.thumbs_up_user)\r\n  }\r\n  useEffect(() => {\r\n    getMovieDeatil(comment.movie_id).then((res) => {\r\n      setMovie(res)\r\n    })\r\n  }, [comment.movie_id])\r\n\r\n\r\n  const handleThumbsUp = () => {\r\n    const db = getDatabase();\r\n    if(!user) {\r\n      history.push('/login')\r\n    }\r\n    if(user && thumbsUpUsers.includes(user.uid)) {\r\n      runTransaction(ref(db, 'comments/' + comment.id), (comment) => {\r\n        if (comment) {\r\n          comment.thumbs_up--\r\n          comment.thumbs_up_user[user.uid] = null\r\n        }\r\n        return comment;\r\n      });\r\n    } else if (user && !thumbsUpUsers.includes(user.uid)) {\r\n      runTransaction(ref(db, 'comments/' + comment.id), (comment) => {\r\n        if (comment) {\r\n          comment.thumbs_up++\r\n          if(thumbsUpUsers.length === 0){\r\n            comment.thumbs_up_user = {};\r\n          }\r\n          comment.thumbs_up_user[user.uid] = 1;\r\n        }\r\n        return comment;\r\n      });\r\n    }\r\n  }\r\n  const handleTitleValue = (e) => {\r\n    setTitleValue(e.target.value)\r\n  }\r\n  const handleContentValue = (e) => {\r\n    setContentValue(e.target.value)\r\n  }\r\n  const handleEditComment = (e) => {\r\n    setIsEdit(true)\r\n    setTitleValue(comment.title)\r\n    setContentValue(comment.content)\r\n  }\r\n  const handleEditCommentCancel = (e) => {\r\n    setIsEdit(false)\r\n    setTitleValue(\"\")\r\n    setContentValue(\"\")\r\n  }\r\n  const handleCommentSubmit = (e) => {\r\n    const db = getDatabase()\r\n    update(ref(db, 'comments/' + comment.id), {\r\n      title: titleValue,\r\n      content: contentValue\r\n    })\r\n    setIsEdit(false)\r\n  }\r\n  const handleDeleteComment = () => {\r\n    const db = getDatabase()\r\n    if(window.confirm('確定要刪除留言？')) {\r\n      set(ref(db, 'comments/' + comment.id), {});\r\n    }\r\n\r\n  }\r\n\r\n  return (\r\n    <CommentContainer isMobileDevice={getUserDeviceType()}>\r\n      <TitleWrapper>\r\n        <TitleSection column={isPosterOpen  ? \"10% 80% 10%\" : \"90% 10%\"} RWDS_column={isPosterOpen  ? \"20% 65% 15%\" : \"80% 20%\"} >\r\n          {/* <ColumnWrapper> */}\r\n            {isPosterOpen && movie &&\r\n            <ImgContainer to={`movie/${comment.movie_id}`} style={{backgroundImage: `url('https://image.tmdb.org/t/p/w500${movie.poster_path}')`}}></ImgContainer>}\r\n            <TitleAndDate TitleMargin={isPosterOpen ? \"10%\" : \"0\"}>\r\n            {!isEdit && <h2 onClick={() => handleCommentOpen(comment.id)}>{comment.title}</h2>}\r\n            {isEdit && <input type=\"text\" value={titleValue} onChange={(e) => {handleTitleValue(e)}}/>}\r\n              <span><span>{comment.display_name}</span> －發布於<Date>{comment.date}</Date></span>\r\n              {user && \r\n              (user.uid === comment.uid ? \r\n              <EditButton>\r\n                <button onClick={handleEditComment}>編輯</button>\r\n                <button onClick={handleDeleteComment}>刪除</button>\r\n                </EditButton> : false)\r\n              }\r\n            </TitleAndDate>\r\n          {/* </ColumnWrapper> */}\r\n\r\n          <ThumbWrapper>\r\n            {isThumbsUpOpen && (user && thumbsUpUsers.includes(user.uid) ?\r\n            <Thumb onClick={handleThumbsUp} className=\"thumbs_up\"><FontAwesomeIcon icon={faThumbsUp} /> {comment.thumbs_up}</Thumb> : <Thumb onClick={handleThumbsUp}><FontAwesomeIcon icon={faThumbsUp} /> {comment.thumbs_up}</Thumb>)}\r\n          </ThumbWrapper>\r\n        </TitleSection>\r\n      </TitleWrapper>\r\n      {!comment.isHide && !isEdit && <Content>{comment.content}</Content>}\r\n      {isEdit && <textarea type=\"text\" value={contentValue} onChange={(e) => {handleContentValue(e)}}/>}\r\n      {isEdit && \r\n      <ButtonSection>\r\n          <button onClick={handleCommentSubmit}>確定</button>\r\n          <button onClick={handleEditCommentCancel}>取消</button>\r\n        </ButtonSection>\r\n        }\r\n    </CommentContainer>\r\n  )\r\n}","import React, { useEffect, useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport { Link } from 'react-router-dom'\r\nimport { \r\n  getPopular, \r\n  getMovieRating, \r\n  getIMDBID, \r\n  getTrend, \r\n  getGenre, \r\n  getUpcomming, \r\n  getPopularPeople\r\n} from '../../WebAPI'\r\nimport {\r\n  getDatabase,\r\n  ref,\r\n  query,\r\n  orderByValue,\r\n  onValue,\r\n  limitToFirst\r\n} from 'firebase/database'\r\nimport Carousel from '../../components/Carousel'\r\nimport RatingList from '../../components/Rating'\r\nimport Movie from '../../components/Movie'\r\nimport Person from '../../components/Person'\r\nimport Loading from '../../components/Loading'\r\nimport Comment from '../../components/Comments'\r\n\r\nconst Title = styled.h2`\r\n  font-size: 5rem;\r\n  color: rgb(224, 222, 222);\r\n  margin: 0;\r\n  padding: 3% 0;\r\n}\r\n`\r\nconst MovieContainer = styled.div`\r\n  display: flex;\r\n  justify-content: space-around;\r\n  width: 100%;\r\n  z-index: 999;\r\n  top: 70%;\r\n  height: 100%;\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n  @media (max-width: 415px) {\r\n    top: 0;\r\n    height: 60%;\r\n    .RWD-S{\r\n      display: block;\r\n    }\r\n    .RWD-L{\r\n      display: none;\r\n    }\r\n  }\r\n`\r\nconst CarouselConatiner = styled.div`\r\n  max-width: 95%;\r\n  width: 100%;\r\n  padding: 20px;\r\n  box-sizing: border-box;\r\n  background: #1C1C1C;\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n  @media (max-width: 415px) {\r\n    top: 0;\r\n    height: 60%;\r\n    .RWD-S{\r\n      display: block;\r\n    }\r\n    .RWD-L{\r\n      display: none;\r\n    }\r\n  }\r\n`\r\nconst Section = styled.div`\r\n  position: relative;\r\n`\r\nconst RecommendationSection = styled.div`\r\n  height:100vh;\r\n  background-size: cover;\r\n  background-position: center;\r\n  background-repeat: no-repeat;\r\n  position: relative;\r\n  width: 100vw;\r\n  @media (max-width: 415px) {\r\n    width: 100%;\r\n  }\r\n`\r\nconst Recommedation = styled.div`\r\n  color: white;\r\n  position: absolute;\r\n  top: 30%;\r\n  left: 10%;\r\n  @media (max-width: 415px) {\r\n    top:60%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 90%;\r\n  }\r\n`\r\nconst RecommendationTitle = styled.h2`\r\n  font-size: 2rem;\r\n  text-align: left;\r\n  margin-bottom: 1%;\r\n  @media (max-width: 415px) {\r\n    text-align: center;\r\n    font-size: 4rem;\r\n  }\r\n`\r\nconst RecommedationContent = styled.p`\r\n  text-align: left;\r\n  font-size: 0.5rem;\r\n  width: 50%;\r\n  margin-bottom: 1%;\r\n  line-height: 1.5;\r\n  @media (max-width: 415px) {\r\n    display: none;\r\n  }\r\n`\r\nconst RecommedationRating = styled.div`\r\n  width: 50%;\r\n  @media (max-width: 415px) {\r\n    margin: 0 auto;\r\n  }\r\n`\r\nconst PopularSection = styled.div`\r\n  position: relative;\r\n\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n  @media (max-width: 415px) {\r\n    min-height: 200px;\r\n    .RWD-L{\r\n      display: none;\r\n    }\r\n    .RWD-S{\r\n      display: block;\r\n    }\r\n  }\r\n`\r\nconst TypeSection = styled.div`\r\n  color: white;\r\n  display: flex;\r\n  list-style: none;\r\n  flex-wrap: wrap;\r\n  justify-content: center;\r\n  margin-top: 20px;\r\n  a{\r\n    display: block;\r\n    width: 16%;\r\n    margin-right: 1%;\r\n    margin-bottom: 1%;\r\n    border: 1px solid white;\r\n    padding: 2% 0px;\r\n    box-sizing: border-box;\r\n    border-radius: 8px;\r\n    color: white;\r\n    text-decoration: none;\r\n\r\n    background-size: cover;\r\n    background-position: center;\r\n  }\r\n  @media (max-width: 415px) {\r\n    font-size: 14px;\r\n    a{width: 27%;}\r\n  }\r\n \r\n`\r\nconst UpcommingSection = styled.div`\r\n\r\n`\r\nconst SubTitle = styled.p`\r\n  color: white;\r\n`\r\nconst HotPeopleSection = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n`\r\nconst HotCommentsSection = styled.div`\r\n  color: white;\r\n  padding-bottom: 20px;\r\n  margin: 0 auto;\r\n  margin-top: 40px;\r\n  width: 60%;\r\n  @media (max-width: 415px) {\r\n    width: 85%;\r\n  }\r\n`\r\nfunction Credits({ credits }) {\r\n  return (\r\n    <CarouselConatiner>\r\n      <div className=\"RWD-L\">\r\n      <Carousel cols={6} gap={3}>\r\n        {credits.map((item, index) =>\r\n          <Carousel.Item key={item.id}>\r\n          {item.profile_path !== \"null\" && \r\n            <div>\r\n              <Person person={item}/>\r\n            </div>}\r\n          </Carousel.Item>        \r\n        )}\r\n      </Carousel>\r\n      </div>\r\n      <div className=\"RWD-S\">\r\n      <Carousel cols={3} gap={3}>\r\n        {credits.map((item, index) =>\r\n          <Carousel.Item key={item.id}>\r\n          {item.profile_path !== \"null\" && \r\n            <div>\r\n              <Person person={item}/>\r\n            </div>}\r\n          </Carousel.Item>        \r\n        )}\r\n      </Carousel>\r\n      </div>\r\n\r\n    </CarouselConatiner>\r\n  )\r\n}\r\nexport default function HomePage() {\r\n  const [movies, setMovies] = useState([])\r\n  const [Rating, setRating] = useState([])\r\n  const [trend, setTrend] = useState([])\r\n  const [upcomming, setUpcomming] = useState([])\r\n  const [genres, setGenre] = useState([])\r\n  const [hotPeople, setHotPeople] = useState([])\r\n  const [hotComments, setHotComments] = useState([])\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [isRatingLoading, setIsRatingLoading] = useState(Array(20).fill(true))\r\n\r\n  //初始化\r\n  useEffect(() => {\r\n    //取得首頁單一電影\r\n    async function getFirstHotMovie() {\r\n      let imdb_id = ''\r\n      let trendData\r\n      // setIsLoading(true)\r\n      await getTrend().then((res) => {\r\n        let data = res.results.sort(function(a,b){\r\n          return b.popularity - a.popularity\r\n        });\r\n        setTrend(data[0])\r\n        trendData = data[0]\r\n      }).catch((err) => {\r\n        return err\r\n      })\r\n      await getIMDBID(trendData.id).then((res) => {\r\n        imdb_id = res.imdb_id\r\n      }).catch((err) => {\r\n        return err\r\n      })\r\n      await getMovieRating(imdb_id).then((res) => {\r\n        let ratingArr = res.Ratings\r\n        setTrend(prevState => ({\r\n          ...prevState,\r\n          Ratings: ratingArr\r\n        }))\r\n      }).catch((err) => {\r\n        return err\r\n      })\r\n    }\r\n    getFirstHotMovie()\r\n    //取得熱門電影前20名\r\n    getPopular().then((data) => {\r\n      setIsLoading(true)\r\n      setMovies(data.results)\r\n      setIsLoading(false)\r\n    }).catch((err) => {\r\n      return err\r\n    })\r\n    //取得即將上映20部電影\r\n    getUpcomming().then((data) => {\r\n      setIsLoading(true)\r\n      setUpcomming(data.results)\r\n      setIsLoading(false)\r\n    }).catch((err) => {\r\n      return err\r\n    })\r\n    //取得熱門演員前20名\r\n    getPopularPeople().then((data) => {\r\n      setIsLoading(true)\r\n      setHotPeople(data.results)\r\n      setIsLoading(false)\r\n    }).catch((err) => {\r\n      return err\r\n    })\r\n    //取得各種類型\r\n    getGenre().then((res) => {\r\n      setIsLoading(true)\r\n      let genreArr = []\r\n      for(let i = 0; i < res.genres.length; i++) {\r\n        genreArr.push(res.genres[i])\r\n      }\r\n      setGenre(genreArr)\r\n      setIsLoading(false)\r\n    }).catch((err) => {\r\n      return err\r\n    })\r\n    //取得熱門評論\r\n    const db = getDatabase();\r\n    const mostThumbsUpPosts = query(ref(db, 'comments'), orderByValue('thumbs_up'), limitToFirst(3))\r\n    let keyArr = []\r\n    onValue(mostThumbsUpPosts, (snapshot) => {\r\n      const data = snapshot.val()\r\n      keyArr = Object.keys(data)\r\n      let arr = []\r\n      for(let i = 0; i < keyArr.length; i++) {\r\n        arr.push(\r\n          {\r\n            ...data[keyArr[i]], \r\n            isHide: true,\r\n            id: keyArr[i]\r\n          }\r\n        )\r\n      }\r\n      setHotComments(arr)\r\n    });\r\n\r\n  }, []);\r\n//取得Popular movies分數\r\n  useEffect(() => {\r\n    //setIsLoading(true)\r\n    let arr = []\r\n    let arr2 = []\r\n    async function getPopularMovieRating() {\r\n      for(let i = 0; i < movies.length; i++) {\r\n        await getIMDBID(movies[i].id).then((res) => {\r\n          arr.push(res.imdb_id)\r\n        })\r\n      }\r\n      for(let i = 0; i < arr.length; i++) {\r\n        await getMovieRating(arr[i]).then((res) => {\r\n          arr2.push(res.Ratings)\r\n          let a = res.Ratings\r\n          setRating(prevCount => [...prevCount, a])\r\n          setIsRatingLoading(prev => prev.map((item, index) => {\r\n            if (index !== i) return item\r\n            return false\r\n          }))\r\n        }).catch((err) => {\r\n          return err\r\n        })\r\n      }\r\n    }\r\n    getPopularMovieRating()\r\n\r\n  }, [movies])\r\n\r\n  const handleCommentOpen = (id) => {\r\n    setHotComments(hotComments.map((item) => {\r\n      if (item.id !== id) return item\r\n      return {\r\n        ...item,\r\n        isHide: !item.isHide\r\n      }\r\n    }))\r\n  }\r\n\r\n  return (\r\n    <div style={{ backgroundColor: `#1C1C1C` }}>\r\n      <Loading isLoading={isLoading} />\r\n      <Section>\r\n        <RecommendationSection style={{ \r\n            backgroundImage: trend.backdrop_path && `linear-gradient(to top, #1C1C1C, transparent), url(\"https://image.tmdb.org/t/p/original${trend.backdrop_path}\")` \r\n          }}>\r\n          <Recommedation>\r\n            <RecommendationTitle>{trend.title}</RecommendationTitle>\r\n            <RecommedationContent>{trend.overview}</RecommedationContent>\r\n            <RecommedationRating>{trend.Ratings && <RatingList key={trend.id} Ratings={trend.Ratings} />}</RecommedationRating>\r\n          </Recommedation>\r\n        </RecommendationSection>\r\n        <PopularSection className=\"popular\">\r\n          <Title>Popular</Title>\r\n          <MovieContainer>\r\n          <CarouselConatiner>\r\n            <div className=\"RWD-L\">\r\n            <Carousel cols={4} gap={20}>\r\n              {movies.map((movie, index) =>\r\n                <Carousel.Item>\r\n                  <Movie\r\n                  key={movie.id}\r\n                  movie={movie}\r\n                  imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`}\r\n                  rating={Rating[index]}\r\n                  id={movie.id}\r\n                  isRating={true}\r\n                  isRatingLoading={isRatingLoading[index]} />\r\n                </Carousel.Item>        \r\n              )}\r\n              </Carousel>\r\n            </div>\r\n            <div className=\"RWD-S\">\r\n            <Carousel cols={2} gap={10}>\r\n              {movies.map((movie, index) =>\r\n                <Carousel.Item>\r\n                  <Movie\r\n                  key={movie.id}\r\n                  movie={movie}\r\n                  imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`}\r\n                  rating={Rating[index]}\r\n                  id={movie.id}\r\n                  isRating={true}\r\n                  isRatingLoading={isRatingLoading[index]} />\r\n                </Carousel.Item>        \r\n              )}\r\n              </Carousel>\r\n            </div>\r\n            </CarouselConatiner>\r\n          </MovieContainer>\r\n        </PopularSection>\r\n        <Title>Upcomming</Title>\r\n        <SubTitle>台灣及全美即將上映</SubTitle>\r\n        <UpcommingSection>\r\n          <MovieContainer>\r\n            <CarouselConatiner>\r\n            <div className=\"RWD-L\">\r\n              <Carousel cols={4} gap={10}>\r\n                {upcomming.map((movie, index) =>\r\n                  <Carousel.Item>\r\n                    <Movie\r\n                    key={movie.id}\r\n                    movie={movie}\r\n                    imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`}\r\n                    id={movie.id}/>\r\n                  </Carousel.Item>        \r\n                )}\r\n              </Carousel>\r\n              </div>\r\n              <div className=\"RWD-S\">\r\n              <Carousel cols={2} gap={10}>\r\n                {upcomming.map((movie, index) =>\r\n                  <Carousel.Item>\r\n                    <Movie\r\n                    key={movie.id}\r\n                    movie={movie}\r\n                    imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`}\r\n                    id={movie.id}/>\r\n                  </Carousel.Item>        \r\n                )}\r\n              </Carousel>\r\n              </div>\r\n            </CarouselConatiner>\r\n          </MovieContainer>\r\n        </UpcommingSection>\r\n        <Title>Hottest</Title>\r\n        <HotPeopleSection>\r\n          <Credits credits={hotPeople}></Credits>\r\n        </HotPeopleSection>\r\n        <Title>Genre</Title>\r\n        <SubTitle>尋找您喜歡的類型</SubTitle>\r\n        <TypeSection >\r\n          {genres.map((genre) => {\r\n            return <Link key={genre.id} to={`/search/genre/${genre.id}`}><li>{genre.name}</li></Link>\r\n          })}\r\n        </TypeSection>\r\n        <Title>Comments</Title>\r\n        <HotCommentsSection>\r\n        {hotComments.length !== 0 ? hotComments.map((item, index) => {\r\n           return <Comment key={item.id} comment={item} handleCommentOpen={handleCommentOpen} isPosterOpen={true} />\r\n          }) : <p>還沒有任何評論</p>}\r\n        </HotCommentsSection>\r\n      </Section>\r\n\r\n\r\n    </div>\r\n\r\n  )\r\n}","import React, { useEffect, useState, useContext } from 'react'\nimport styled from 'styled-components'\nimport { Link, useParams } from 'react-router-dom'\nimport {\n  getMovieDeatil,\n  getMovieRating,\n  getCredits,\n  getSimilar,\n  getVideo,\n  getMovieImage\n} from '../../WebAPI'\nimport Carousel from '../../components/Carousel'\nimport { useColor } from 'color-thief-react'\nimport RatingList from '../../components/Rating'\nimport {\n  getDatabase,\n  ref,\n  onValue,\n  push,\n  query,\n  orderByChild,\n  equalTo\n} from \"firebase/database\";\nimport AuthContext from '../../context'\nimport { getDate, getCreatedAt } from '../../utils'\nimport Comment from '../../components/Comments'\nimport Person from '../../components/Person'\nimport Movie from '../../components/Movie'\nimport { SRLWrapper } from 'simple-react-lightbox'\nimport { getUserDeviceType } from '../../utils'\n\nconst LeftContainer = styled.div`\n  margin: 0 auto;\n  width: 100%;\n  height: auto;\n  padding: 15%;\n  box-sizing: border-box;\n`\nconst RightContainer = styled.div`\n  margin: 0 auto;\n  width: 100%;\n  font-size: 0.6rem;\n  line-height: 1.5;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  li{\n    list-style-type:none;\n  }\n  .rating-list{\n    margin-top: 5%;\n  }\n  @media (max-width: 415px) {\n    width: 90%;\n    font-size: 14px;\n    margin: 0 auto;\n    h2{\n      font-size: 18px;\n    }\n    .rating-list{\n      \n    }\n  }\n`\nconst Wrapper = styled.div`\n  margin: 30px 100px;\n  @media (max-width: 415px) {\n    margin: 80px 0;\n  }\n`\nconst DetailContainer = styled.div`\n\n  display: grid;\n  grid-template-columns: 50% 50%;\n  z-index: 10000;\n  @media (max-width: 415px) {\n    display: block;\n  }\n`\nconst Recommendations = styled.div`\n  display: flex;\n`\nconst CarouselConatiner = styled.div`\n  max-width: 95%;\n  width: 100%;\n  padding: 20px;\n  margin: 0 auto;\n  box-sizing: border-box;\n  .RWD-S{\n    display: none;\n  }\n  @media (max-width: 415px) {\n    max-width: 100%;\n\n    .RWD-S{\n      display: block;\n    }\n    .RWD-L{\n      display: none;\n    }\n  }\n`\nconst Container = styled.div`\n  padding: 0;\n  font-size: 1rem;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-color: rgba(255,255,255, 0.5);\n  min-height: 100vh;\n  padding-top: 5%;\n  padding-bottom: 5%;\n  h2{\n    font-size: 1rem;\n  }\n  @media (max-width: 415px) {\n    padding-bottom: 0;\n    h2{\n      font-size: 2.3rem;\n    }\n  }\n`\nconst RecommendImgContainer = styled(Link)`\n  display: inline-block;\n  width: 100%;\n  padding: 30% 0;\n  margin-right: 10px;\n  background-position: center;\n  background-size: contain;\n  background-repeat: no-repeat;\n  @media (max-width: 415px) {\n    height: 150px;\n  }\n  `\nconst Date = styled.span`\n  \n`\nconst MovieDetailContent = styled.ul`\n  text-align: left;\n  font-size: 0.5rem;\n  margin-top: 5%;\n  line-height: 2;\n  @media (max-width: 415px) {\n    width: 100%;\n    font-size: 14px;\n  }\n`\nconst MovieVideoSection = styled.div`\n  max-width: 100%;\n  margin: 0 auto;\n  width: 100%;\n  height: auto;\n  position: relative;\n  overflow: hidden;\n  padding-top: 25.25%;\n  margin-top: 5%;\n  .responsive-iframe {\n    position: absolute;\n    top: 0%;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    width: 100%;\n    height: 100%;\n  }\n  p{\n    text-align: center;\n    font-size: 32px;\n    margin-bottom: 5%;\n  }\n  .RWD-S{\n    margin: 0 auto;\n    display: none;\n    opacity: 0;\n  }\n  @media (max-width: 415px) {\n    max-width: 90%;\n    padding-top: 50.25%;\n    p{\n      text-align: center;\n      font-size: 25px;\n      margin-bottom: 15px;\n    }\n    .RWD-S{\n      display: block;\n      opacity: 1;\n    }\n    .RWD-L{\n      display: none;\n      opacity: 0;\n    }\n  }\n`\nconst MovieImgSection = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n`\nconst MovieImg = styled.img`\n  height: auto;\n  width: 100%;\n  background-position: center;\n  background-size: contain;\n  background-repeat: no-repeat;\n  &:hover{\n    transition: 0.5s;\n    transform: scale(1.1);\n  }\n  @media (max-width: 415px) {\n   \n  }\n`\nconst Keyword = styled.span`\n  display: inline-block;\n  font-size: 0.5rem;\n  border-radius: 10px;\n  margin-right: 10px;\n  margin-bottom: 10px;\n  word-break: keep-all;\n  padding: 5px;\n  @media (max-width: 415px) {\n    font-size: 14px;\n  }\n`\nconst CommentSection = styled.div`\n  padding: 80px;\n  width: 60%;\n  margin: 0 auto;\n  a{\n    color: white;\n  }\n  @media (max-width: 415px) {\n    padding: 0;\n    margin-bottom: 50px;\n    width: 85%;\n  }\n`\nconst Pagination = styled.div`\n\n`\nconst AddCommentSection = styled.div`\n  width: 50%;\n  margin: 0 auto;\n  input[type=submit]{\n    margin-top: 3%;\n  }\n  input, textarea{\n    font-size: ${props => props.isMobileDevice ? \"initial\" : \"0.5rem\"}\n  }\n`\nconst AddCommentColumn = styled.div`\n  display: grid;\n  grid-template-columns: 15% 85%;\n`\nconst Comments = styled.div`\n  margin-bottom: 2%;\n`\nconst NoComment = styled.p`\n  margin-bottom: 2%;\n`\nfunction Credits({ credits }) {\n  return (\n    <CarouselConatiner>\n      <div className=\"RWD-L\">\n      <Carousel cols={6} gap={10}>\n        {credits.map((item, index) =>\n          <Carousel.Item key={item.id}>\n            <div>\n            {item.profile_path !== \"null\" && \n              <Person person={item}/>\n            }\n            </div>\n          </Carousel.Item>        \n        )}\n        </Carousel>\n      </div>\n      <div className=\"RWD-S\">\n      <Carousel cols={3} gap={0}>\n        {credits.map((item, index) =>\n          <Carousel.Item key={item.id}>      \n            <div>\n            {item.profile_path !== \"null\" && \n            <Person person={item}/>\n            }\n\n            </div>\n          </Carousel.Item>        \n        )}\n        </Carousel>\n      </div>\n\n      </CarouselConatiner>\n  )\n}\nexport default function MovieDetailPage() {\n\n  const [movie, setMovie] = useState([])\n  const [rating, setRating] = useState([])\n  const [recommendations, setRecommendations] = useState([])\n  const [credits, setCredits] = useState([])\n  const [director, setDirector] = useState({})\n  const [video, setVideo] = useState([])\n  const [images, setImages] = useState([])\n  const [comments, setComments] = useState([])\n  const [commentTitle, setcommentTitle] = useState('')\n  const [commentContent, setcommentContent] = useState('')\n  const [isCommentInputOpen, setisCommentInputOpen] = useState(false)\n  const [currentCommentPage, setCurrentCommentPage] = useState(1)\n  const [totalCommentPage, settotalCommentPage] = useState(1)\n  const { id } = useParams()\n  const { user } = useContext(AuthContext)\n \n  useEffect(() => {\n    function getComments() {\n      \n      const db = getDatabase();\n      const posts = query(ref(db, 'comments'), orderByChild(\"movie_id\"), equalTo(id))  \n        onValue(posts, (snapshot) => {\n          const data = snapshot.val()\n          let arr = []\n          if(data){\n            let keys = Object.keys(data)\n            let totalPage = Math.ceil(keys.length / 5)\n            settotalCommentPage(totalPage)\n            let len\n            if(keys.length >= 5) {\n              len = 5\n            } else {\n              len = keys.length\n            }\n            for(let i = 0; i < len; i++) {\n              arr.push(\n                {\n                  ...data[keys[i]], \n                  isHide: true,\n                  id: keys[i]\n                }\n              )\n            }\n            setComments(arr.reverse())\n          } else {\n            setComments([])\n          }\n          \n        });\n      \n      \n    }\n    getComments()\n  }, [id])\n  \n\n\n  let src = ''\n    const format = 'rgbArray'\n    const crossOrigin = 'anonymous'\n    const quality = 10\n  if (movie.poster_path) {\n    src = `https://image.tmdb.org/t/p/original${movie.backdrop_path}`\n  }\n  const { data } = useColor(src, format, { crossOrigin, quality})\n  let backgroundMask = ''\n  let lightness = 0\n  let colorStr = ''\n  if(data) {\n    let str = 'rgba('\n    for(let i = 0; i < data.length; i++) {\n      str += data[i] + ','\n    }\n    str += '0.8)'\n    backgroundMask = str\n  }\n\n  if(data) {  \n    let red = data[0]\n    let green = data[1]\n    let blue = data[2]\n    lightness = (red * 0.2126 + green * 0.7152 + blue * 0.0722) / 255\n    colorStr = `hsl(0, 0%, calc((${lightness} - 0.5) * -999999%))`\n  }\n\n  useEffect(() => {\n    getMovieDeatil(id).then((res) => {\n      setMovie(res)\n      return res\n    }).then((res) => {\n      getVideo(res.id).then((res) => {\n        let videoArr = res.results.filter(item => {\n          return item.type === 'Trailer'\n        })\n        setVideo(videoArr[0])\n      })\n      getMovieRating(res.imdb_id).then((res) => {\n        setRating(res.Ratings)\n      })\n      getSimilar(res.id).then((res) => {\n        setRecommendations(res.results)\n      })\n    })\n    getCredits(id).then((res) => {\n\n      let director = res.crew.filter((item) => {\n        return item.job === 'Director'\n      })\n      setCredits(res.cast)\n      setDirector(director[0])\n    })\n    getMovieImage(id).then((res) => {\n      // let imgArr = res.backdrops.slice(3, 7)\n      let imgArr = res.backdrops\n      setImages(imgArr)\n    })\n  }, [id])\n\n  const handleCommentSubmit = () => {\n    function writeUserData(content, title) {\n      const db = getDatabase();\n      let date = getDate()\n      let created_at = getCreatedAt()\n      push(ref(db, 'comments'), {\n        content: commentContent,\n        title: commentTitle,\n        date: date,\n        display_name: user.providerData[0].displayName,\n        thumbs_up: 0,\n        movie_id: id,\n        uid: user.uid,\n        created_at: created_at\n      });\n    }\n    if(commentTitle !== '' && commentContent !== '') {\n      setcommentTitle('')\n      setcommentContent('')\n      writeUserData()\n    } else {\n      alert('請輸入評論標題及內容')\n    }\n\n  }\n  const handleCommentOpen = (id) => {\n    setComments(comments.map((item) => {\n      if (item.id !== id) return item\n      return {\n        ...item,\n        isHide: !item.isHide\n      }\n    }))\n  }\n  const handleCommentPage = (isNextPage) => {\n    const db = getDatabase()\n    const posts = query(ref(db, 'comments'), orderByChild(\"movie_id\"), equalTo(id)) \n    if(isNextPage) {\n      onValue(posts, (snapshot) => {\n        const data = snapshot.val()\n        let arr = []\n        if(data){\n          let keys = Object.keys(data)\n          let len\n          if(keys.length >= currentCommentPage * 5 + 4) {\n            len = currentCommentPage * 5 + 4\n          } else {\n            len = keys.length\n          }\n          for(let i = currentCommentPage * 5; i < len; i++) {\n              arr.push(\n                {\n                  ...data[keys[i]], \n                  isHide: true,\n                  id: keys[i]\n                }\n              )\n          }\n          setComments(arr.reverse())\n          setCurrentCommentPage(currentCommentPage + 1)\n        }\n      });\n    } else if (!isNextPage) {\n      onValue(posts, (snapshot) => {\n        const data = snapshot.val()\n        let arr = []\n        if(data){\n          let keys = Object.keys(data)\n          let len\n          if(keys.length >= (currentCommentPage-2) * 5 + 4) {\n            len = (currentCommentPage-2) * 5 + 4\n          } else {\n            len = keys.length\n          }\n          for(let i = (currentCommentPage-2) * 5; i < len; i++) {\n              arr.push(\n                {\n                  ...data[keys[i]], \n                  isHide: true,\n                  id: keys[i]\n                }\n              )\n          }\n          setComments(arr.reverse())\n          setCurrentCommentPage(currentCommentPage - 1)\n        }\n      });\n    }\n\n  }\n\n  return (\n    <div style={{ \n      backgroundColor: `#1C1C1C` ,color: 'white'\n    }}>\n      {movie.poster_path && \n      <Container style={{ \n            backgroundImage: `linear-gradient(to top, #1C1C1C, ${backgroundMask}), url(\"https://image.tmdb.org/t/p/original${movie.backdrop_path}\")` //https://image.tmdb.org/t/p/original/wwemzKWzjKYJFfCeiB57q3r4Bcm.svg\n          }}>\n      <Wrapper>\n        <DetailContainer>\n        <LeftContainer>\n          <Movie\n          key={movie.id}\n          movie={movie}\n          imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`}\n          id={movie.id}/>\n        </LeftContainer>\n        <RightContainer style={{ \n            color: `${colorStr}`\n          }}>\n          <h2>{movie.title}<Date>({movie.release_date.substr(0, 4)})</Date></h2>\n          <p>{movie.overview}</p>\n          {rating && <div className=\"rating-list\"><RatingList Ratings={rating}></RatingList></div>}\n          <MovieDetailContent>\n            {director && <li>導演：{director.name}</li>}\n            <li>片長：{movie.runtime}</li>\n            <li>官方網站：{movie.homepage}</li>\n            <li>關鍵字：{movie.keywords.keywords.map((item) => {\n              return <Keyword style={{ border: `1px solid ${colorStr}`}}>{'#'+item.name}</Keyword>\n            })}</li>\n          </MovieDetailContent>\n        </RightContainer>\n        </DetailContainer>\n        <h2>相關圖片：</h2>\n      <MovieImgSection>\n      <CarouselConatiner>\n            <div className=\"RWD-L\">\n            <Carousel cols={4} gap={10}>\n              {images && images.map((item) => {\n              return <Carousel.Item>\n                <SRLWrapper>\n                  <MovieImg src={`https://image.tmdb.org/t/p/original${item.file_path}`}></MovieImg>\n                  </SRLWrapper>\n                  </Carousel.Item>\n            })}\n              </Carousel>\n            </div>\n            <div className=\"RWD-S\">\n            <Carousel cols={2} gap={10}>\n              {images && images.map((item) => {\n              return <Carousel.Item>\n                <SRLWrapper>\n                  <MovieImg src={`https://image.tmdb.org/t/p/original${item.file_path}`}></MovieImg>\n                  </SRLWrapper>\n                  </Carousel.Item>\n            })}\n              </Carousel>\n            </div>\n            </CarouselConatiner>\n            {/* {images && images.map((item) => {\n              return <MovieImg style={{ \n                backgroundImage: `url(\"https://image.tmdb.org/t/p/original${item.file_path}\")`\n              }}></MovieImg>\n            })} */}\n          </MovieImgSection>\n          <h2>預告：</h2>\n        <MovieVideoSection>\n            {video && <iframe className=\"responsive-iframe\" src={`https://www.youtube.com/embed/${video.key}?autoplay=0`} title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>}\n        </MovieVideoSection>\n      </Wrapper>\n\n      </Container>}\n      <h2>Credits</h2>\n      <Credits credits={credits}></Credits>\n      <h2>Comments</h2>\n      <CommentSection>\n        <Comments>\n        {comments.length !== 0 ? comments.map((item, index) => {\n            return <Comment handleCommentOpen={handleCommentOpen} comment={item} />\n          }) : <NoComment>還沒有任何評論</NoComment>}\n          {user ?<button onClick={() => {setisCommentInputOpen(!isCommentInputOpen)}}>新增評論</button> : <Link to=\"/login\">點我登入評論</Link>}\n        </Comments>\n\n          \n          {isCommentInputOpen && \n            <AddCommentSection isMobileDevice={getUserDeviceType()}>\n              <AddCommentColumn>\n                <span>標題：</span><input type=\"text\" onChange={(e) => setcommentTitle(e.target.value)}/>\n              </AddCommentColumn>\n              <AddCommentColumn>\n                <span>內容：</span><textarea type=\"text\" onChange={(e) => setcommentContent(e.target.value)} />\n              </AddCommentColumn>\n              <input type=\"submit\" onClick={handleCommentSubmit}></input>\n            </AddCommentSection>\n          }\n          <Pagination>\n              {currentCommentPage !== 1 ? <button onClick={() => {handleCommentPage(false)}}>&lt;</button> : false}\n              {currentCommentPage}\n              {totalCommentPage !== currentCommentPage ? <button onClick={() => {handleCommentPage(true)}}>&gt;</button>: false}\n          </Pagination>\n      </CommentSection>\n      <h2>推薦專區</h2>\n      <Recommendations>\n        <CarouselConatiner>\n          <Carousel cols={3} gap={10}>\n            {recommendations.map((item, index) =>\n              <Carousel.Item key={item.id}>\n                <div>\n                {item.poster_path && <RecommendImgContainer style={{ \n                  backgroundImage: `url(\"https://image.tmdb.org/t/p/w500${item.poster_path}\")` \n                }} to={`/movie/${item.id}`}>\n                </RecommendImgContainer>}\n                </div>\n              </Carousel.Item>        \n            )}\n            </Carousel>\n          </CarouselConatiner>\n      </Recommendations>\n    </div>\n\n\n  )\n}","import React, { useEffect, useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useParams } from 'react-router-dom'\r\nimport {\r\n  getGenreSearch,\r\n  getGenre,\r\n  getIMDBID,\r\n  getMovieRating\r\n} from '../../WebAPI'\r\nimport Loading from '../../components/Loading'\r\nimport Movie from '../../components/Movie'\r\n\r\nconst Container = styled.div`\r\n  background: #1C1C1C;\r\n  padding-top: 80px;\r\n`\r\nconst ResultContainer = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  box-sizing: border-box;\r\n  justify-content: center;\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n  @media (max-width: 415px) {\r\n    .RWD-L{\r\n      display: none;\r\n    }\r\n    .RWD-S{\r\n      display: block;\r\n    }\r\n  }\r\n\r\n`\r\nconst TypeTitle = styled.h2`\r\n    padding: 60px 0px;\r\n    color: white;\r\n`\r\nconst PageContainer = styled.div`\r\n    color: white;\r\n    padding: 30px 0px;\r\n`\r\nconst ItemContainer = styled.div`\r\n  width: 23%;\r\n  margin: 1%;\r\n  @media (max-width: 415px) {\r\n    width: 45%;\r\n  }\r\n`\r\nexport default function SearchGenrePage() {\r\n  const [movies, setMovies] = useState([])\r\n  const [genres, setGenre] = useState([])\r\n  const [Rating, setRating] = useState([])\r\n  const [currentPage, setCurrentPage] = useState('')\r\n  const [totalPage, setTotalPage] = useState('')\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const [isRatingLoading, setIsRatingLoading] = useState(Array(20).fill(true))\r\n  //const isRatingLoading = useRef(Array(20).fill(true))\r\n  const { id } = useParams()\r\n  //拿到此類型的電影集\r\n  useEffect(() => {\r\n    if(id !== '') {\r\n        getGenreSearch(id).then((res) => {\r\n          setIsLoading(true)\r\n          setCurrentPage(res.page)\r\n          setTotalPage(res.total_pages)\r\n          setMovies(res.results)\r\n          setIsLoading(false)\r\n        })\r\n    } \r\n  }, [id])\r\n  //取得此類型電影集評分\r\n  useEffect(() => {\r\n    let arr = []\r\n    let arr2 = []\r\n    async function getMoviesRatings() {\r\n      // setIsLoading(true)\r\n      for(let i = 0; i < movies.length; i++) {\r\n        await getIMDBID(movies[i].id).then((res) => {\r\n          arr.push(res.imdb_id)\r\n        }).catch(() => {\r\n          arr.push(null)\r\n        })\r\n      }\r\n      for(let i = 0; i < arr.length; i++) {\r\n        await getMovieRating(arr[i]).then((res) => {\r\n          arr2.push(res.Ratings)\r\n          let a = res.Ratings\r\n          setRating(prevCount => [...prevCount, a])\r\n          \r\n          setIsRatingLoading(prev => prev.map((item, index) => {\r\n            if (index !== i) return item\r\n            return false\r\n          }))\r\n          //isRatingLoading.current[i] = false\r\n          //Sconsole.log(`${i}`,isRatingLoading.current[i])\r\n        }).catch(() => {\r\n          setRating(prevCount => [...prevCount, []])\r\n        })\r\n      }\r\n      // setRating(arr2)\r\n    }\r\n    getMoviesRatings()\r\n  }, [movies])\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    getGenre().then((res) => {\r\n      let genreArr = []\r\n      for(let i = 0; i < res.genres.length; i++) {\r\n        genreArr.push(res.genres[i])\r\n      }\r\n      setGenre(genreArr)\r\n    })\r\n  }, [])\r\n  const handlePageChange = (page) => {\r\n    window.scrollTo(0, 0)\r\n    setIsLoading(true)\r\n    setRating([])\r\n    setIsRatingLoading(Array(20).fill(true))\r\n    if(id !== '') {\r\n      getGenreSearch(id, page).then((res) => {\r\n        setCurrentPage(res.page)\r\n        setMovies(res.results)\r\n      })\r\n    }\r\n    setIsLoading(false)\r\n  }\r\n  return (\r\n    <Container>\r\n      <Loading isLoading={isLoading} />\r\n      <TypeTitle>\r\n        {genres\r\n          .filter((item) => {\r\n            return item.id.toString() === id\r\n            })\r\n          .map((item) => {\r\n            return item.name + '類型搜尋結果'\r\n          })  \r\n        }\r\n      </TypeTitle>\r\n      <ResultContainer>\r\n        {movies && movies.map((item, index) => {\r\n          return <ItemContainer className=\"RWD-L\"><Movie key={item.id} movie={item} rating={Rating[index]} isRatingLoading={isRatingLoading[index]} isRating={true}/></ItemContainer>\r\n        })}\r\n        {movies && movies.map((item, index) => {\r\n          return <ItemContainer className=\"RWD-S\"><Movie key={item.id} movie={item} rating={Rating[index]} isRatingLoading={isRatingLoading[index]} isRating={true}/></ItemContainer>\r\n        })}\r\n      </ResultContainer>\r\n      <PageContainer>\r\n        {currentPage !== 1 ? <button onClick={() => {handlePageChange(currentPage - 1)}}>&lt;</button> : \"\"}\r\n         {currentPage}\r\n         {currentPage !== totalPage ? <button onClick={() => {handlePageChange(currentPage + 1)}}>&gt;</button> : \"\"}\r\n      </PageContainer>\r\n    </Container>\r\n\r\n  )\r\n}","import React, { useEffect, useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useParams } from 'react-router-dom'\r\nimport {\r\n  getGenre,\r\n  getSearchData,\r\n  getIMDBID,\r\n  getMovieRating,\r\n} from '../../WebAPI'\r\nimport Movie from '../../components/Movie'\r\nimport Person from '../../components/Person'\r\nimport RatingList from '../../components/Rating'\r\n\r\nconst Container = styled.div`\r\n  background: #1C1C1C;\r\n  line-height: 1.5;\r\n  color: white;\r\n  padding-top: 8%;\r\n  min-height: 100vh;\r\n  @media (max-width: 415px) {\r\n    display: block;\r\n    padding-top: 15%;\r\n  }\r\n`\r\nconst Wrapper = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 30% 70%;\r\n  @media (max-width: 415px) {\r\n    display: block;\r\n  }\r\n`\r\nconst ResultContainer = styled.div`\r\n  width: 100%;\r\n  @media (max-width: 415px) {\r\n    margin-top: 15%;\r\n  }\r\n`\r\nconst MovieContainer = styled.div`\r\n  border: 1px solid;\r\n  margin: 20px auto;\r\n  display: grid;\r\n  grid-template-columns: 30% 70%;\r\n  align-items: center;\r\n  max-width: 90%;\r\n  @media (max-width: 415px) {\r\n    max-width: 90%;\r\n    grid-template-columns: 40% 60%;\r\n  }\r\n`\r\nconst ContentContainer = styled.div`\r\n  margin: 0 auto;\r\n  padding: 8%;\r\n  font-size: 0.5rem;\r\n  li{\r\n    list-style: none;\r\n  }\r\n  .rating-list{\r\n    margin-top: 5%;\r\n  }\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n  @media (max-width: 900px) {\r\n    p{\r\n      display: -webkit-box;\r\n      overflow:hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n      -webkit-line-clamp: 4;\r\n      -webkit-box-orient: vertical;\r\n      white-space: normal;\r\n      font-size: 1rem;\r\n    }\r\n    h2{\r\n      font-size: 2rem;\r\n    }\r\n  }\r\n  @media (max-width: 415px) {\r\n    .RWD-L{\r\n      display: block;\r\n    }\r\n    padding: 0px 5%;\r\n    h2{\r\n      font-weight: bold;\r\n    }\r\n\r\n  }\r\n`\r\nconst ClassificationList = styled.div`\r\n  margin: 0 auto;\r\n  min-width: 80%;\r\n  margin-top: 10%;\r\n  font-size: 0.5rem;\r\n  @media (max-width: 415px) {\r\n    display: none;\r\n  }\r\n \r\n`\r\nconst PageContainer = styled.div`\r\n\r\n`\r\nconst ItemContainer = styled.div`\r\n  width: 100%;\r\n  margin: 1%;\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n  @media (max-width: 415px) {\r\n    .RWD-S{\r\n      display: block;\r\n    }\r\n    .RWD-L{\r\n      display: none;\r\n    }\r\n    img{\r\n      height: 200px;\r\n    }\r\n  }\r\n`\r\nconst NotFoundMessage = styled.p`\r\n  color: white;\r\n  text-align: left;\r\n  margin-top: 5%;\r\n  @media (max-width: 415px) {\r\n    text-align: center;\r\n  }\r\n`\r\nconst Filter = styled.li`\r\n  ${(props) => props.$active &&\r\n    `\r\n      background: white;\r\n      color: black;\r\n    `}\r\n  list-style: none;\r\n  padding-left: 0;\r\n  width: 100%;\r\n  padding: 5% 0;\r\n  border: 1px solid white;\r\n  cursor: pointer;\r\n`\r\nfunction People ({ person }) {\r\n  return(\r\n    <MovieContainer>\r\n      <Person person={person} isName={false}/>\r\n      <ContentContainer>\r\n        <h2>{person.name}</h2>\r\n        <p>代表作: {person.known_for.map((item) => {\r\n          return <li>{item.title}</li>\r\n        })}</p>\r\n      </ContentContainer>\r\n    </MovieContainer>\r\n  )\r\n}\r\nfunction SearchMovie ({ movie, rating }) {\r\n  //let imgUrl = `https://image.tmdb.org/t/p/w500${movie.poster_path}`\r\n  return(\r\n    <MovieContainer>\r\n      <ItemContainer>\r\n        <div className=\"RWD-L\">\r\n        <Movie key={movie.id} movie={movie} id={movie.id} imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`} rating={rating}  isRating={false}/>\r\n        </div>  \r\n        <div className=\"RWD-S\">\r\n        <Movie key={movie.id} movie={movie} id={movie.id} imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`} rating={rating}  isRating={false}/>\r\n        </div>\r\n        \r\n      </ItemContainer>\r\n      <ContentContainer>\r\n        <h2>{movie.title}</h2>\r\n        <p>{movie.overview}</p>\r\n        <div className=\"RWD-S\"></div>\r\n        <div className=\"rating-list\"><RatingList Ratings={rating} logoWidth=\"30px\" /></div>\r\n      </ContentContainer>\r\n    </MovieContainer>\r\n  )\r\n}\r\n\r\nexport default function SearchPage() {\r\n  const [movies, setMovies] = useState([])\r\n  const [genres, setGenre] = useState([])\r\n  const [rating, setRating] = useState([])\r\n  const [searchItemGenreID, setsearchItemGenreID] = useState([])\r\n  const [currentType, setCurrentType] = useState(0)\r\n  const [typesCount, settypesCount] = useState({\r\n    allCount: 0,\r\n    movieCount: 0,\r\n    peopleCount: 0\r\n  })\r\n  const [isTypeListOpen, setIsTypeListOpen] = useState(false)\r\n  const [currentGenre, setCurrentGenre] = useState(0)\r\n  const [currentPage, setCurrentPage] = useState('')\r\n  const [totalPage, setTotalPage] = useState('')\r\n  const { query } = useParams()\r\n\r\n  useEffect(() => {\r\n    if(query !== '' ) {\r\n      setRating([])\r\n      setMovies([])\r\n      getSearchData(query).then((res) => {\r\n        setCurrentPage(res.page)\r\n        setTotalPage(res.total_pages)\r\n        let movieCount = 0\r\n        let peopleCount = 0\r\n        let genreArr = []\r\n        res.results.forEach((item) => {\r\n          if(item.media_type === 'movie') {\r\n            item.genre_ids.forEach((genreID) => {\r\n            const isFind = genreArr.find((itemID) => itemID === genreID)\r\n              if(!isFind) {\r\n                genreArr.push(genreID)\r\n              } \r\n            })\r\n          }\r\n\r\n          if(item.media_type === 'movie'){\r\n            return movieCount ++\r\n          }\r\n          if(item.media_type === 'tv') {\r\n            return null\r\n          }\r\n          if(item.media_type === 'person') {\r\n            return peopleCount ++\r\n          }\r\n        })\r\n        let allCount = movieCount + peopleCount\r\n        setsearchItemGenreID(genreArr)\r\n        setMovies(res.results)\r\n        settypesCount({\r\n          allCount,\r\n          movieCount,\r\n          peopleCount\r\n        })\r\n      })\r\n    }\r\n  }, [query])\r\n\r\n  //取得搜尋電影的評分\r\n  useEffect(() => {\r\n      setRating([])\r\n      let arr = []\r\n      let arr2 = []\r\n      async function getSearchMovieRating() {\r\n        for(let i = 0; i < movies.length; i++) {\r\n          if(movies[i].media_type === 'movie') {\r\n            await getIMDBID(movies[i].id).then((res) => {\r\n              arr.push(res.imdb_id)\r\n            })\r\n          } else {\r\n            arr.push(null)\r\n          }\r\n        }\r\n        for(let i = 0; i < arr.length; i++) {\r\n          await getMovieRating(arr[i]).then((res) => {\r\n            arr2.push(res.Ratings)\r\n            let a = res.Ratings\r\n            setRating(prevCount => [...prevCount, a])\r\n          })\r\n        }\r\n      }\r\n      getSearchMovieRating()\r\n  }, [movies])\r\n\r\n  useEffect(() => {\r\n    getGenre().then((res) => {\r\n      let genreArr = []\r\n      let arr2 = []\r\n      for(let i = 0; i < res.genres.length; i++) {\r\n        genreArr.push(res.genres[i])\r\n      }\r\n      for(let i = 0; i< searchItemGenreID.length; i++) {\r\n        let id = genreArr.find((item) => {\r\n          return item.id === searchItemGenreID[i]\r\n        })\r\n        arr2.push(id)\r\n      }\r\n      setGenre(arr2)\r\n    })\r\n  }, [searchItemGenreID])\r\n  const handleCurrentType = (e) => {\r\n    if(e.target.nodeName === 'LI') {\r\n      if(e.target.dataset.value === '0') {\r\n        setCurrentType(0)\r\n      }\r\n      if(e.target.dataset.value === '1') {\r\n        setCurrentType(1)\r\n      }\r\n      if(e.target.dataset.value === '2') {\r\n        setCurrentType(2)\r\n      }\r\n      if(e.target.dataset.value === '3') {\r\n        setCurrentType(3)\r\n      }\r\n\r\n    }\r\n  }\r\n  const handleisTypeListOpen = () => {\r\n    setIsTypeListOpen(!isTypeListOpen)\r\n  }\r\n  const handleCurrentGenre = (e) => {\r\n    setCurrentGenre(e.target.value)\r\n  }\r\n  const handlePageChange = (page) => {\r\n    window.scrollTo(0, 0)\r\n    getSearchData(query, page).then((res) => {\r\n      setCurrentPage(res.page)\r\n      setTotalPage(res.total_pages)\r\n      let movieCount = 0\r\n      let peopleCount = 0\r\n      let genreArr = []\r\n      res.results.forEach((item) => {\r\n        if(item.media_type === 'movie') {\r\n          item.genre_ids.forEach((genreID) => {\r\n            const isFind = genreArr.find((itemID) => itemID === genreID)\r\n             if(!isFind) {\r\n               genreArr.push(genreID)\r\n              } \r\n            })\r\n        }\r\n\r\n        if(item.media_type === 'movie'){\r\n          return movieCount ++\r\n        }\r\n        if(item.media_type === 'tv') {\r\n          return \r\n        }\r\n        if(item.media_type === 'person') {\r\n          return peopleCount ++\r\n        }\r\n      })\r\n      let allCount = movieCount + peopleCount\r\n      setsearchItemGenreID(genreArr)\r\n     setMovies(res.results)\r\n     settypesCount({\r\n       allCount,\r\n       movieCount,\r\n       peopleCount\r\n     })\r\n    })\r\n  }\r\n  return (\r\n    <Container>\r\n      <Wrapper>\r\n      <ClassificationList>\r\n        <ul onClick={(e) => {handleCurrentType(e)}}>\r\n          <Filter $active={currentType === 0} data-value=\"0\">全部 {typesCount.allCount}</Filter>\r\n          <Filter $active={currentType === 1} data-value=\"1\">電影 {typesCount.movieCount}</Filter>\r\n          <Filter $active={currentType === 2} data-value=\"2\">人物 {typesCount.peopleCount}</Filter>\r\n          <Filter $active={currentType === 3} onClick={handleisTypeListOpen}>類型</Filter>\r\n          {genres && isTypeListOpen &&\r\n            genres.map((genre) => {\r\n              return <li className=\"genre-DDL\" data-value=\"3\" value={genre.id} onClick={(e) => {handleCurrentGenre(e)}}>{genre.name}</li>\r\n          })}\r\n        </ul>\r\n      </ClassificationList>\r\n\r\n\r\n      <ResultContainer>\r\n      {movies.length !== 0 && currentType === 0 && \r\n        movies.map((item, index) => {\r\n          if(item.media_type === 'movie') {\r\n            return <SearchMovie key={item.id} movie={item} rating={rating[index]} /> \r\n          }\r\n          if(item.media_type === 'person') {\r\n            return <People key={item.id} person={item}/>\r\n          } \r\n          return null\r\n        }) }\r\n        {movies && currentType === 1 && typesCount.movieCount !== 0 && \r\n          movies\r\n            .filter((item) => {\r\n              return item.media_type === 'movie'\r\n            })\r\n            .map((item, index) => {\r\n              return <SearchMovie key={item.id} movie={item} rating={rating[index]}/>\r\n          })\r\n        }\r\n        {movies && currentType === 2 && typesCount.peopleCount !== 0 && \r\n          movies\r\n            .filter((item) => {\r\n              return item.media_type === 'person'\r\n            })\r\n            .map((item) => {\r\n              return <People key={item.id} person={item}/>\r\n            }) \r\n        }\r\n        {movies && currentType === 3 && typesCount.allCount !== 0 && \r\n          movies\r\n            .filter((item) => {\r\n              return item.media_type === 'movie'\r\n            })\r\n            .filter((item) => {\r\n              let genreFilter = false\r\n              item.genre_ids.some((genre) => {\r\n                return genre === currentGenre ? genreFilter = true : genreFilter = false\r\n              })\r\n              return genreFilter === true\r\n            })\r\n            .map((item, index) => {\r\n              return <SearchMovie key={item.id} movie={item} rating={rating[index]}/>\r\n          })\r\n        }\r\n        {movies.length === 0 && <NotFoundMessage>找不到任何搜尋結果</NotFoundMessage>}\r\n      </ResultContainer>\r\n      </Wrapper>\r\n      <PageContainer>\r\n        {currentPage !== 1 ? <button onClick={() => {handlePageChange(currentPage - 1)}}>&lt;</button> : \"\"}\r\n         {currentPage}\r\n         {currentPage !== totalPage && totalPage !== 0 ? <button onClick={() => {handlePageChange(currentPage + 1)}}>&gt;</button> : \"\"}\r\n      </PageContainer>\r\n    </Container>\r\n\r\n  )\r\n}","import React, { useEffect, useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useParams } from 'react-router-dom'\r\nimport { getPeopleDetail, getPeopleMovies, getPeopleDetailEng } from '../../WebAPI'\r\nimport Movie from '../../components/Movie'\r\nimport Carousel from '../../components/Carousel'\r\n\r\nconst Container = styled.div`\r\n  background: #1C1C1C;\r\n  color: white;\r\n`\r\nconst ImgContainer = styled.div`\r\n  height: 500px;\r\n  width: 50%;\r\n  background-position: center;\r\n  background-size: contain;\r\n  background-repeat: no-repeat;\r\n  @media (max-width: 415px) {\r\n    width: 100%;\r\n  }\r\n`\r\nconst PersonContainer = styled.div`\r\n  padding: 0 20%; \r\n  padding-top: 10%;\r\n  margin-bottom: 30px;\r\n  display: flex;\r\n  justify-content: center;\r\n  @media (max-width: 415px) {\r\n    display: block;\r\n    padding: 25% 0 10% 0;\r\n  }\r\n`\r\nconst PersonContent = styled.div`\r\n  width: 50%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items:center;\r\n  justify-content: center;\r\n  line-height: 1.5;\r\n  font-size: 0.4rem;\r\n  @media (max-width: 415px) {\r\n    width: 100%;\r\n    font-size: 16px;\r\n  }\r\n`\r\nconst FamousMovieSection = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: center;\r\n  .RWD-S{\r\n    display: none;\r\n  }\r\n  @media (max-width: 415px) {\r\n    .RWD-S{\r\n      display: block;\r\n    }\r\n    .RWD-L{\r\n      display: none;\r\n    }\r\n  }\r\n`\r\nconst Biography = styled.p`\r\n  margin-top: 3%;\r\n  line-height: 1.5;\r\n  @media (max-width: 415px) {\r\n    line-height: 1.5;\r\n    \r\n  }\r\n`\r\nconst Title = styled.h2`\r\n  margin-top: 60px;\r\n`\r\nconst Wrapper = styled.div`\r\n  margin: 0 auto;\r\n  max-width: 80%;\r\n  @media (max-width: 415px) {\r\n    max-wdith: 90%;\r\n  }\r\n`\r\nconst ItemContainer = styled.div`\r\n  width: 23%;\r\n  margin: 1%;\r\n  @media (max-width: 415px) {\r\n    width: 45%;\r\n  }\r\n`\r\nconst CarouselConatiner = styled.div`\r\n  max-width: 95%;\r\n  width: 100%;\r\n  padding: 20px;\r\n  box-sizing: border-box;\r\n  background: #1C1C1C;\r\n`\r\nconst NotFoundMessage = styled.p`\r\n  text-align: center;\r\n  margin-top: 2%;\r\n`\r\nconst LanguageButton = styled.button`\r\n  background: transparent;\r\n  border: 1px solid white;\r\n  color: white;\r\n  cursor: pointer;\r\n  ${(props) => props.$active &&\r\n    `\r\n      background: white;\r\n      color: black;\r\n    `}\r\n`\r\nexport default function CreditPage() {\r\n  const [person, setPerson] = useState({})\r\n  const [biography, setBiography] = useState(\"\")\r\n  const [biographyLang, setBiographyLang] = useState(\"chi\")\r\n  const [famousMovie, setfamousMovie] = useState([])\r\n  const [otherMovie, setotherMovie] = useState([])\r\n  const { id } = useParams()\r\n\r\n  useEffect(() => {\r\n    getPeopleDetail(id).then((res) => {\r\n      setPerson(res)\r\n      setBiography(res.biography)\r\n    }).catch((err) => {\r\n      return err\r\n    })\r\n    getPeopleMovies(id).then((res) => {\r\n      let arr = res.cast\r\n      .sort((a, b) => {\r\n        return b.popularity - a.popularity\r\n      })\r\n      .slice(0, 4)\r\n      let arr2 = res.cast\r\n      .sort((a, b) => {\r\n        return b.popularity - a.popularity\r\n      })\r\n      .slice(4, res.cast.length-1)\r\n      setfamousMovie(arr)\r\n      setotherMovie(arr2)\r\n    }).catch((err) => {\r\n      return err\r\n    })\r\n  }, [id])\r\n\r\n  const handleBioLanguage = (language) => {\r\n    if (language === 'eng') {\r\n      getPeopleDetailEng(id).then((res) => {\r\n        setBiography(res.biography)\r\n        setBiographyLang('eng')\r\n      })\r\n    }\r\n    if (language === 'chi') {\r\n      getPeopleDetail(id).then((res) => {\r\n        setBiography(res.biography)\r\n        setBiographyLang('chi')\r\n      })\r\n    }\r\n\r\n  }\r\n  return (\r\n    <Container>\r\n      <Wrapper>\r\n      <PersonContainer>\r\n        {person.profile_path && \r\n        <ImgContainer style={{backgroundImage: `url(\"https://image.tmdb.org/t/p/w500${person.profile_path}\")`}}>\r\n        </ImgContainer>}\r\n        <PersonContent>\r\n          <h2>{person.name}</h2>\r\n          {person.birthday ? <p>生日：{person.birthday}</p> : <NotFoundMessage>生日：目前沒有資料</NotFoundMessage>}\r\n          {person.place_of_birth ? <p>出生地：{person.place_of_birth}</p> : <NotFoundMessage>出生地：目前沒有資料</NotFoundMessage>}\r\n        </PersonContent>\r\n      </PersonContainer>\r\n      <LanguageButton onClick={() => {handleBioLanguage('chi')}} $active={biographyLang === 'chi'}>中文版</LanguageButton>\r\n      <LanguageButton onClick={() => {handleBioLanguage('eng')}} $active={biographyLang === 'eng'}>英文版</LanguageButton><br />\r\n      <Biography>{biography === \"\" ? \"暫時沒有資料\" : biography}</Biography>\r\n      <Title>著名電影：</Title>\r\n      <FamousMovieSection >\r\n        {famousMovie.length !== 0 ? (famousMovie.map((item) => {\r\n            return <ItemContainer className=\"RWD-L\">\r\n              <Movie key={item.id} movie={item} id={item.id} imgUrl={`https://image.tmdb.org/t/p/w500${item.poster_path}`} /></ItemContainer>            \r\n          })): <NotFoundMessage>目前沒有資料</NotFoundMessage>}\r\n        {famousMovie !== 0 ? (famousMovie.map((item) => {\r\n            return <ItemContainer className=\"RWD-S\"><Movie key={item.id} movie={item} id={item.id} imgUrl={`https://image.tmdb.org/t/p/w500${item.poster_path}`} /></ItemContainer>\r\n          })) : <div className=\"RWD-S\"><NotFoundMessage>目前沒有資料</NotFoundMessage></div>}\r\n      </FamousMovieSection>\r\n      <Title>其他電影：</Title>\r\n      <FamousMovieSection>\r\n      <CarouselConatiner>\r\n      {otherMovie.length !== 0 ?\r\n      (<div className=\"RWD-L\">\r\n      <Carousel cols={5} gap={10}>\r\n          {otherMovie && otherMovie.map((item) => {\r\n            return <Carousel.Item>\r\n              <Movie key={item.id} movie={item} id={item.id} imgUrl={`https://image.tmdb.org/t/p/w500${item.poster_path}`} />\r\n              </Carousel.Item>\r\n          })}\r\n      </Carousel>\r\n      </div>) : <div className=\"RWD-L\"><NotFoundMessage>目前沒有資料</NotFoundMessage></div>}\r\n      {otherMovie.length !== 0 ?\r\n      (<div className=\"RWD-S\">\r\n      <Carousel cols={2} gap={10}>\r\n          {otherMovie && otherMovie.map((item) => {\r\n            return <Carousel.Item>\r\n              <Movie key={item.id} movie={item} id={item.id} imgUrl={`https://image.tmdb.org/t/p/w500${item.poster_path}`} />\r\n              </Carousel.Item>\r\n          })}\r\n          </Carousel>\r\n      </div>) : <div className=\"RWD-S\"><NotFoundMessage>目前沒有資料</NotFoundMessage></div>}\r\n      </CarouselConatiner>\r\n      </FamousMovieSection>\r\n      </Wrapper>\r\n    </Container>\r\n  )\r\n}","import React, { useState, useContext } from 'react'\r\nimport styled from 'styled-components'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport {\r\n  getAuth,\r\n  signInWithEmailAndPassword,\r\n  setPersistence,\r\n  browserLocalPersistence\r\n} from \"firebase/auth\"\r\nimport AuthContext from '../../context'\r\nimport { getUserDeviceType } from '../../utils'\r\n\r\nconst Container = styled.div`\r\n  color: white;\r\n  background-image: linear-gradient(rgba(28, 28, 28, 0.7), rgba(28, 28, 28, 0.7)), url('https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1170&q=80');\r\n  background-repeat: no-repeat;\r\n  background-size: cover;\r\n  background-position: center;\r\n  height: 100vh;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-itemsL center;\r\n  width: 100vw;\r\n  backdrop-filter: blur(10px);\r\n  position: relative;\r\n  input{\r\n    font-size: ${props => props.isMobileDevice ? \"initial\" : \"\"}\r\n  }\r\n`\r\nconst LoginSection = styled.div`\r\n  background: rgba(0, 0, 0, 0.5);\r\n  border: 1px solid white;\r\n  min-width: 20%;\r\n  min-height: 20%;\r\n  padding: 5%;\r\n  position: absolute;\r\n  top:50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  box-shadow: 2px 2px 2px 1px rgba(0, 0, 0, 0.2);\r\n  font-size: 0.45rem;\r\n  h2{\r\n    font-size: 0.7rem;\r\n  }\r\n  a{\r\n    color: white;\r\n  }\r\n  input{\r\n    width: 70%;\r\n  }\r\n  input[type=\"password\"] {\r\n    margin-bottom: 5%;\r\n  }\r\n  @media (max-width: 415px) {\r\n    min-width: 80%;\r\n    padding: 60px 0;\r\n    h2{\r\n      font-size: 20px;\r\n    }\r\n    font-size: 16px;\r\n  }\r\n  \r\n`\r\nconst ErrorMessage = styled.p`\r\n  color: red;\r\n  font-weight: bold;\r\n`\r\nexport default function LoginPage() {\r\n  const [username, setUsername] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n  const { setUser } = useContext(AuthContext)\r\n  const history = useHistory()\r\n  const handleLogin = () => {\r\n    const auth = getAuth()\r\nsetPersistence(auth, browserLocalPersistence)\r\n  .then(() => {\r\n    return signInWithEmailAndPassword(auth, username, password)\r\n    .then((userCredential) => {\r\n        const user = userCredential.user;\r\n        setUser(user.auth.currentUser)\r\n        if(user) {\r\n          history.push('/')\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        const errorCode = error.code\r\n\r\n        if(errorCode === 'auth/wrong-password'){\r\n          setErrorMessage(\"密碼錯誤\")\r\n        }\r\n        if(errorCode === 'auth/user-not-found'){\r\n          setErrorMessage(\"找不到用戶\")\r\n        }\r\n      });\r\n    })\r\n    .catch((error) => {\r\n      return error\r\n    });\r\n  }\r\n  return (\r\n    <Container isMobileDevice={getUserDeviceType()}>\r\n      <LoginSection>\r\n        <h2>登入</h2>\r\n        <label>帳號：</label>\r\n        <input type=\"email\" onChange={(e) => {setUsername(e.target.value)}} placeholder=\"電郵\"/><br />\r\n        <label>密碼：</label>\r\n        <input type=\"password\" onChange={(e) => {setPassword(e.target.value)}} placeholder=\"密碼\"/><br />\r\n        <ErrorMessage>{errorMessage}</ErrorMessage>\r\n        <button onClick={handleLogin}>登入</button><br />\r\n        <Link to=\"/register\">還沒有帳號嗎？點我註冊</Link>\r\n      </LoginSection> \r\n    </Container>\r\n  )\r\n}","import React, { useState, useContext } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { getAuth, createUserWithEmailAndPassword, updateProfile } from \"firebase/auth\"\r\nimport AuthContext from '../../context'\r\nimport { getUserDeviceType } from '../../utils'\r\n\r\nconst Container = styled.div`\r\n  color: white;\r\n  background-image: linear-gradient(rgba(28, 28, 28, 0.7), rgba(28, 28, 28, 0.7)), url('https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1170&q=80');\r\n  background-repeat: no-repeat;\r\n  background-size: cover;\r\n  background-position: center;\r\n  height: 100vh;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-itemsL center;\r\n  width: 100vw;\r\n  backdrop-filter: blur(10px);\r\n  position: relative;\r\n  input{\r\n    font-size: ${props => props.isMobileDevice ? \"initial\" : \"\"}\r\n  }\r\n`\r\nconst LoginSection = styled.div`\r\n  background: rgba(0, 0, 0, 0.5);\r\n  border: 1px solid white;\r\n  min-width: 20%;\r\n  min-height: 20%;\r\n  padding: 5%;\r\n  position: absolute;\r\n  top:50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  box-shadow: 2px 2px 2px 1px rgba(0, 0, 0, 0.2);\r\n  font-size: 0.45rem;\r\n  h2{\r\n    font-size: 0.7rem;\r\n  }\r\n  a{\r\n    color: white;\r\n  }\r\n  input{\r\n    width: 70%;\r\n  }\r\n\r\n  @media (max-width: 415px) {\r\n    min-width: 80%;\r\n    padding: 60px 0;\r\n    h2{\r\n      font-size: 20px;\r\n    }\r\n    font-size: 16px;\r\n  }\r\n`\r\n\r\nexport default function LoginPage() {\r\n  const [username, setUsername] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [nickname, setNickname] = useState('')\r\n  const { setUser } = useContext(AuthContext)\r\n  const history = useHistory()\r\n\r\n  const handleRegister = () => {\r\n    const auth = getAuth();\r\n    createUserWithEmailAndPassword(auth, username, password)\r\n      .then((userCredential) => {\r\n        // Signed in \r\n        const user = userCredential.user\r\n        updateProfile(auth.currentUser, {\r\n          displayName: nickname\r\n        }).then(() => {\r\n        }).catch((error) => {\r\n        })\r\n        setUser(user.auth.currentUser)\r\n        if(user) {\r\n          history.push('/')\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        return error\r\n      });\r\n  }\r\n  return (\r\n    <Container isMobileDevice={getUserDeviceType()}>\r\n      <LoginSection>\r\n      <h2>註冊</h2>\r\n      <label>帳號：</label>\r\n      <input type=\"email\" onChange={(e) => {setUsername(e.target.value)}} placeholder=\"電郵\"/><br />\r\n      <label>密碼：</label>\r\n      <input type=\"password\" onChange={(e) => {setPassword(e.target.value)}} placeholder=\"密碼\"/><br />\r\n      <label>暱稱：</label>\r\n      <input type=\"text\" onChange={(e) => {setNickname(e.target.value)}} placeholder=\"請輸入暱稱\"/><br />\r\n      <button onClick={handleRegister}>註冊</button>\r\n      </LoginSection>\r\n    </Container>\r\n\r\n\r\n  )\r\n}","import React, { useEffect, useState, useContext } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { getAuth, updateProfile } from \"firebase/auth\"\r\nimport {\r\n  getDatabase,\r\n  ref,\r\n  onValue,\r\n  query,\r\n  orderByChild,\r\n  equalTo,\r\n} from 'firebase/database'\r\nimport { getMovieDeatil } from '../../WebAPI'\r\nimport AuthContext from '../../context'\r\nimport Movie from '../../components/Movie'\r\nimport Comment from '../../components/Comments'\r\nimport Loading from '../../components/Loading'\r\n\r\nconst Container = styled.div`\r\n  background: #1C1C1C;\r\n  padding-top: 120px;\r\n  color: white;\r\n  font-size: 0.5rem;\r\n`\r\nconst Wrapper = styled.div`\r\n  max-width: 60%;\r\n  margin: 0 auto;\r\n  .title{\r\n    padding-top: 5%;\r\n    padding-bottom: 5%;\r\n    font-size: 1.5rem;\r\n    text-align: left;\r\n    border-bottom: 1px solid white;\r\n  }\r\n  @media (max-width: 415px) {\r\n    max-width: 80%;\r\n    .title{\r\n      font-size: 20px;\r\n    }\r\n  }\r\n`\r\nconst MemberDetailSection = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 50% 50%;\r\n  border-bottom: 1px solid white;\r\n  @media (max-width: 415px) {\r\n    grid-template-columns: 30% 70%;\r\n  }\r\n`\r\nconst LeftContainer = styled.div`\r\n  font-size: 0.6rem;\r\n  p{\r\n    padding: 5% 0;\r\n  }\r\n  @media (max-width: 415px) {\r\n    font-size: 18px;\r\n  }\r\n`\r\nconst RightContainer = styled.div`\r\n  font-size: 0.45rem;\r\n  button{\r\n    margin-left: 1%;\r\n    font-size: 0.1rem;\r\n  }\r\n  .user-content{\r\n    padding: 5% 0;\r\n    line-height: 1.5;\r\n  }\r\n  @media (max-width: 415px) {\r\n    font-size: 14px;\r\n    button{\r\n      font-size: 14px;\r\n    }\r\n  }\r\n`\r\nconst FavoriteMovieSection = styled.div`\r\n  p{\r\n    font-size: 1rem;\r\n    padding: 5% 0;\r\n  }\r\n  border-bottom: 1px solid white;\r\n`\r\nconst FavoriteContainer = styled.div`\r\n.favorite-movie{\r\n  margin: 1%;\r\n  box-sizing: border-box;\r\n}\r\np{\r\n  font-size: 1rem;\r\n  padding: 5% 0;\r\n}\r\n.RWD-L{\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  .favorite-movie{\r\n    width: 22%;\r\n    margin-right: 5px;\r\n    margin-bottom: 20px;\r\n  }\r\n}\r\n.RWD-S{\r\n  display: none;\r\n}\r\n margin-bottom: 5%;\r\n@media (max-width: 415px) {\r\n  .RWD-S{\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    .favorite-movie{\r\n      width: 45%;\r\n    }\r\n  }\r\n  .RWD-L{\r\n    display: none;\r\n  }\r\n}\r\n\r\n`\r\nconst PhoneSection = styled.div`\r\n display: flex;\r\n justify-content: center;\r\n`\r\nconst PersonalCommentSection = styled.div`\r\n\r\n padding-bottom: 5%;\r\n min-width: 100%;\r\n\r\n`\r\nconst CommentSection = styled.div`\r\n\r\n  margin: 0 auto;\r\n`\r\nconst Pagination = styled.div`\r\n  margin-top: 5%;\r\n`\r\nconst Title = styled.p`\r\n  font-size: 1rem;\r\n  padding: 5% 0;\r\n`\r\nexport default function MemberPage() {\r\n  const [favoriteID, setFavoriteID] = useState([])\r\n  const [favoriteMovie, setFavoriteMovie] = useState([])\r\n  const [personalComments, setPersonalComments] = useState([])\r\n  const [isNicknameEdit, setIsNicknameEdit] = useState(false)\r\n  const [nicknameValue, setNicknameValue] = useState(\"\")\r\n  const [currentCommentPage, setCurrentCommentPage] = useState(1)\r\n  const [totalCommentPage, settotalCommentPage] = useState(1)\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const { user } = useContext(AuthContext)\r\n  const history = useHistory()\r\n  if(!user){\r\n    history.push('/login')\r\n  }\r\n  useEffect(() => {\r\n    if(user){\r\n\r\n      const db = getDatabase()\r\n      const memberFavoriteRef = ref(db, 'favorite/' + user.uid)\r\n      let keyArr = []\r\n      onValue(memberFavoriteRef, (snapshot) => {\r\n        const data = snapshot.val()\r\n        if(data){\r\n          keyArr = Object.keys(data)\r\n          let arr = []\r\n          for(let i = 0; i < keyArr.length; i++) {\r\n            arr.push(keyArr[i])\r\n          }\r\n          setFavoriteID(arr)\r\n        }\r\n\r\n    \r\n        });\r\n\r\n        const posts = query(ref(db, 'comments'), orderByChild(\"uid\"),  equalTo(user.uid))  \r\n        //const posts = query(ref(db, 'comments'), orderByChild(\"created_at\"), limitToFirst(5))\r\n        onValue(posts, (snapshot) => {\r\n          const data = snapshot.val()\r\n          let arr = []\r\n          if(data){\r\n            let keys = Object.keys(data)\r\n            let totalPage = Math.ceil(keys.length / 5)\r\n            settotalCommentPage(totalPage)\r\n            let len\r\n            if(keys.length >= 5) {\r\n              len = 5\r\n            } else {\r\n              len = keys.length\r\n            }\r\n            for(let i = 0; i < len; i++) {\r\n                arr.push(\r\n                  {\r\n                    ...data[keys[i]], \r\n                    isHide: true,\r\n                    id: keys[i]\r\n                  }\r\n                )\r\n            }\r\n            setPersonalComments(arr.reverse())\r\n          }\r\n        });\r\n    }\r\n  }, [user])\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      setIsLoading(true)\r\n      let arr = []\r\n      for(let i = 0; i < favoriteID.length; i++) {\r\n        await getMovieDeatil(favoriteID[i]).then((res) => {\r\n          arr.push(res)\r\n        })\r\n      }\r\n      setFavoriteMovie(arr)\r\n      setIsLoading(false)\r\n    }\r\n    fetchData()\r\n  }, [favoriteID])\r\n\r\n  const handleNicknameInputOpen = () => {\r\n    if(!isNicknameEdit){\r\n      if(user.providerData[0].displayName){\r\n        setNicknameValue(user.providerData[0].displayName)\r\n      } else {\r\n        setNicknameValue(\"\")\r\n      }\r\n\r\n    }\r\n    setIsNicknameEdit(!isNicknameEdit)\r\n  }\r\n  const handleNicknameInputChange = (e) => {\r\n    setNicknameValue(e.target.value)\r\n  }\r\n  const handleNicknameSubmit = () => {\r\n    const auth = getAuth()\r\n    if(nicknameValue.trim() !== \"\") {\r\n      updateProfile(auth.currentUser, {\r\n        displayName: nicknameValue\r\n      }).then(() => {\r\n        setIsNicknameEdit(false)\r\n      }).catch((error) => {\r\n        return error\r\n      })\r\n    }else{\r\n      alert('暱稱不可為空白')\r\n    }\r\n\r\n  }\r\n  const handleCommentOpen = (id) => {\r\n    setPersonalComments(personalComments.map((item) => {\r\n      if (item.id !== id) return item\r\n      return {\r\n        ...item,\r\n        isHide: !item.isHide\r\n      }\r\n    }))\r\n  }\r\n  const handleCommentPage = (isNextPage) => {\r\n    const db = getDatabase()\r\n    const posts = query(ref(db, 'comments'), orderByChild(\"uid\"),  equalTo(user.uid))  \r\n    if(isNextPage) {\r\n      onValue(posts, (snapshot) => {\r\n        const data = snapshot.val()\r\n        let arr = []\r\n        if(data){\r\n          let keys = Object.keys(data)\r\n          let len\r\n          if(keys.length >= currentCommentPage * 5 + 4) {\r\n            len = currentCommentPage * 5 + 4\r\n          } else {\r\n            len = keys.length\r\n          }\r\n          for(let i = currentCommentPage * 5; i < len; i++) {\r\n            // if(data[keys[i]].created_at < personalComments[4]){\r\n              arr.push(\r\n                {\r\n                  ...data[keys[i]], \r\n                  isHide: true,\r\n                  id: keys[i]\r\n                }\r\n              )\r\n            // }\r\n  \r\n          }\r\n          setPersonalComments(arr.reverse())\r\n          setCurrentCommentPage(currentCommentPage + 1)\r\n        }\r\n      });\r\n    } else if (!isNextPage) {\r\n      onValue(posts, (snapshot) => {\r\n        const data = snapshot.val()\r\n        let arr = []\r\n        if(data){\r\n          let keys = Object.keys(data)\r\n          let len\r\n          if(keys.length >= (currentCommentPage-2) * 5 + 4) {\r\n            len = (currentCommentPage-2) * 5 + 4\r\n          } else {\r\n            len = keys.length\r\n          }\r\n          for(let i = (currentCommentPage-2) * 5; i < len; i++) {\r\n            // if(data[keys[i]].created_at < personalComments[4]){\r\n              arr.push(\r\n                {\r\n                  ...data[keys[i]], \r\n                  isHide: true,\r\n                  id: keys[i]\r\n                }\r\n              )\r\n            // }\r\n  \r\n          }\r\n          setPersonalComments(arr.reverse())\r\n          setCurrentCommentPage(currentCommentPage - 1)\r\n        }\r\n      });\r\n    }\r\n\r\n  }\r\n  return (\r\n    <Container>\r\n      <Loading isLoading={isLoading} />\r\n      <Wrapper>\r\n        <h2 className=\"title\">帳戶</h2>\r\n        <MemberDetailSection>\r\n          <LeftContainer>\r\n            <p>會員資料</p>\r\n          </LeftContainer>\r\n          <RightContainer>\r\n            {user && \r\n            <div className=\"user-content\">\r\n            <p>{user.email}</p>\r\n            <p>信箱驗證：{user.emailVerified ? \"已驗證\" : \"尚未驗證\"}</p>\r\n            <PhoneSection>\r\n              <p>暱稱：{!isNicknameEdit ? (user.providerData[0].displayName ? user.providerData[0].displayName : \"尚未填寫\") : false}</p>\r\n              {isNicknameEdit && \r\n              <div>\r\n                <input type=\"text\" value={nicknameValue} onChange={(e) => {handleNicknameInputChange(e)}}/><br />\r\n                <button onClick={handleNicknameSubmit}>確認</button>\r\n                <button onClick={handleNicknameInputOpen}>取消</button>\r\n              </div>\r\n\r\n              }\r\n              {!isNicknameEdit && <button onClick={handleNicknameInputOpen}>修改</button>}\r\n              </PhoneSection>\r\n            </div>\r\n\r\n            }\r\n          </RightContainer>\r\n        </MemberDetailSection>\r\n        <FavoriteMovieSection>\r\n        <Title>喜歡影片</Title>\r\n          <FavoriteContainer>\r\n            <div className=\"RWD-L\">\r\n            {favoriteMovie.map((movie) => {\r\n              return <div className=\"favorite-movie\"><Movie key={movie.id} movie={movie} imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`} id={movie.id} isRating={false} /></div>\r\n            })}\r\n            </div>\r\n            <div className=\"RWD-S\">\r\n            {favoriteMovie.map((movie) => {\r\n              return <div className=\"favorite-movie\"><Movie key={movie.id} movie={movie} imgUrl={`https://image.tmdb.org/t/p/w500${movie.poster_path}`} id={movie.id} isRating={false} /></div>\r\n            })}\r\n            </div>\r\n\r\n\r\n          </FavoriteContainer>\r\n        </FavoriteMovieSection>\r\n        <PersonalCommentSection>\r\n          <Title>歷史評論</Title>\r\n          <CommentSection>\r\n            {personalComments.length !== 0 ? personalComments.map((item, index) => {\r\n              return <Comment handleCommentOpen={handleCommentOpen} comment={item} isThumbsUpOpen={true} isPosterOpen={true}/>\r\n            }) : <p>還沒有任何評論</p>}          \r\n          </CommentSection>\r\n          <Pagination>\r\n              {currentCommentPage !== 1 ? <button onClick={() => {handleCommentPage(false)}}>&lt;</button> : false}\r\n              {currentCommentPage}\r\n              {totalCommentPage !== currentCommentPage ? <button onClick={() => {handleCommentPage(true)}}>&gt;</button>: false}\r\n          </Pagination>\r\n        </PersonalCommentSection>\r\n      </Wrapper>\r\n\r\n      \r\n    </Container>\r\n\r\n\r\n  )\r\n}","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst Container = styled.div`\r\n  color: white;\r\n  background-image: linear-gradient(rgba(28, 28, 28, 0.7), rgba(28, 28, 28, 0.7)), url('https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1170&q=80');\r\n  background-repeat: no-repeat;\r\n  background-size: cover;\r\n  background-position: center;\r\n\r\n  width: 100vw;\r\n  backdrop-filter: blur(10px);\r\n  padding: 0 0 5% 0;\r\n  @media (max-width: 415px) {\r\n    height: auto;\r\n    padding-bottom: 5%;\r\n    padding-top: 18%;\r\n  }\r\n`\r\nconst AboutSection = styled.div`\r\n  padding-top: 8%;\r\n  h2{\r\n    font-size: 1.3rem;\r\n    margin-bottom: 2%;\r\n  }\r\n  p{\r\n    font-size: 0.7rem;\r\n  }\r\n  @media (max-width: 415px) {\r\n    h2{\r\n      font-size: 3rem;\r\n    }\r\n    p{\r\n      font-size: 2rem;\r\n    }\r\n  }\r\n`\r\nconst LogoSection = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 30% 70%;\r\n  gap: 10%;\r\n  margin-bottom: 5%;\r\n  line-height: 1.5;\r\n  font-size: 0.5rem;\r\n  .IMDB, .tomato, .metacritic{\r\n    width: 100%;\r\n  }\r\n  .tomato, .metacritic{\r\n    background: white;\r\n    border-radius: 8px;\r\n    padding: 5% 5%;\r\n    box-sizing: border-box;\r\n  }\r\n  @media (max-width: 415px) {\r\n    display: block;\r\n    font-size: 1.7rem;\r\n    margin-bottom: 20%;\r\n    .IMDB, .tomato, .metacritic{\r\n      width: 35%;\r\n    }\r\n  }\r\n`\r\nconst SubTitle = styled.p`\r\n  fon-size: 0.5rem;\r\n  @media (max-width: 415px) {\r\n    margin-top: 20%;\r\n  }\r\n`\r\nconst Wrapper = styled.div`\r\n  max-width: 50%;\r\n  margin: 0 auto;\r\n  margin-top: 5%;\r\n  ${SubTitle} {\r\n    margin-bottom: 5%;\r\n  }\r\n  @media (max-width: 415px) {\r\n    max-width: 80%;\r\n  }\r\n`\r\n\r\n\r\nexport default function AboutPage() {\r\n  return (\r\n    <Container>\r\n      <AboutSection>\r\n      <h2>About</h2>\r\n      <p>找評分，Fun電影</p>\r\n      </AboutSection>\r\n      <Wrapper>\r\n      <SubTitle>三大評分網，一次滿足</SubTitle>\r\n      <LogoSection>\r\n        <img className=\"IMDB\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/6/69/IMDB_Logo_2016.svg\"/>\r\n        <p>IMDb的用戶即可以以「1～10顆星」為電影評分，之後IMDb會以數據過濾機制及最小投票數量的限制（目前為1250票）來計算出一個加權平均星數作為評分。 因為IMDb以經常投票的用戶來計票，所以評分算是具客觀參考價值。</p>\r\n      </LogoSection>\r\n      <LogoSection>\r\n        <img className=\"tomato\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/6/6f/Rotten_Tomatoes_logo.svg\"/>\r\n        <p>爛番茄的工作人員會追蹤每一部影片的所有評論內容，然後使用使用整合資料的積分來運算，評論正面或負面的新鮮度。當超過60％，即會得到一個鮮紅的番茄作為標記，當低於60％，則會得到綠色被砸爛的番茄作為標記。</p>\r\n      </LogoSection>\r\n      <LogoSection>\r\n        <img className=\"metacritic\" alt=\"\" src=\"https://upload.wikimedia.org/wikipedia/commons/4/48/Metacritic_logo.svg\"/>\r\n        <p>Metacritic是一個專門收集對於電影、電視節目、音樂專輯、遊戲的評論的網站，網站會整合每個評價的分數再做出一個總評分作為這個項目的評分，在項目的多項短評中，從最好的分數到最壞的分數由下排列，最好的評價分數是綠色到最低的評價分數的黃色、紅色排列。</p>\r\n      </LogoSection>\r\n      </Wrapper>\r\n\r\n    </Container>\r\n\r\n\r\n  )\r\n}","const config = {\r\n  apiKey: \"AIzaSyAeGB1c7DrLqz2qCRxCeE5KLG01zFHJ7BE\",\r\n  authDomain: \"movieproject-9c874.firebaseapp.com\",\r\n  databaseURL: \"https://movieproject-9c874-default-rtdb.firebaseio.com\",\r\n  projectId: \"movieproject-9c874\",\r\n  storageBucket: \"movieproject-9c874.appspot.com\",\r\n  messagingSenderId: \"324525504042\",\r\n  appId: \"1:324525504042:web:5d72e2978e40cce4347553\",\r\n  measurementId: \"G-FBP5RRRJM3\"\r\n};\r\n\r\nexport default config;","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faCopyright } from '@fortawesome/free-regular-svg-icons'\r\nimport { faGithub, faFacebook, faInstagram, faTwitter, faYoutube } from '@fortawesome/free-brands-svg-icons'\r\n\r\n\r\nconst FooterContainer = styled.div`\r\n  background: #1C1C1C;\r\n  color: white;\r\n  padding: 40px 0;\r\n  padding-top: 10%;\r\n  font-size: 0.5rem;\r\n  @media (max-width: 415px) {\r\n    font-size: 14px;\r\n  }\r\n`\r\nconst BrandSection = styled.div`\r\n  font-size: 1rem;\r\n  svg{\r\n    padding: 10px;\r\n  }\r\n  a{\r\n    color: white;\r\n  }\r\n  @media (max-width: 415px) {\r\n    font-size: 18px;\r\n  }\r\n`\r\n\r\nexport default function Footer () {\r\n  return (\r\n    <FooterContainer>\r\n      <BrandSection>\r\n        <a href=\"https://github.com/rj603295\" target=\"_blank\" rel=\"noreferrer\"><FontAwesomeIcon icon={faGithub} /></a>\r\n        <a href=\"https://github.com/rj603295\" target=\"_blank\" rel=\"noreferrer\"><FontAwesomeIcon icon={faFacebook} /></a>\r\n        <a href=\"https://github.com/rj603295\" target=\"_blank\" rel=\"noreferrer\"><FontAwesomeIcon icon={faInstagram} /></a>\r\n        <a href=\"https://github.com/rj603295\" target=\"_blank\" rel=\"noreferrer\"><FontAwesomeIcon icon={faTwitter} /></a>\r\n        <a href=\"https://github.com/rj603295\" target=\"_blank\" rel=\"noreferrer\"><FontAwesomeIcon icon={faYoutube} /></a> \r\n      </BrandSection>\r\n      <FontAwesomeIcon icon={faCopyright} /><span>  2021 - Moive Fun Inc.</span>\r\n    </FooterContainer>\r\n  )\r\n}","import { useState,   useRef, useEffect } from 'react'\r\nimport {\r\n  HashRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Redirect\r\n} from 'react-router-dom'\r\nimport './App.css'\r\nimport './style.css'\r\nimport Header from './components/Header'\r\nimport HomePage from './pages/HomePage'\r\nimport MovieDetailPage from './pages/MovieDetailPage'\r\nimport SearchGenrePage from './pages/SearchGenrePage'\r\nimport SearchPage from './pages/SearchPage'\r\nimport CreditPage from './pages/CreditPage'\r\nimport LoginPage from './pages/LoginPage'\r\nimport RegisterPage from './pages/RegisterPage'\r\nimport MemberPage from './pages/MemberPage'\r\nimport AboutPage from './pages/AboutPage'\r\nimport config from './config';\r\nimport { initializeApp } from \"firebase/app\";\r\nimport { getDatabase, ref, onValue } from \"firebase/database\"\r\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\r\nimport AuthContext from './context'\r\nimport Footer from './components/Footer'\r\n\r\nfunction App() {\r\n  const [user, setUser] = useState(null)\r\n  const [isHide, setIsHide] = useState(false)\r\n  const [userFavorite, setUserFavorite] = useState({})\r\n  let lastScrollY = useRef(0)\r\n  const app = initializeApp(config);\r\n  const db = getDatabase();\r\n\r\n  const auth = getAuth();\r\n  onAuthStateChanged(auth, (user) => {\r\n    if (user) {\r\n      setUser(user.auth.currentUser)\r\n    } else {\r\n\r\n    }\r\n  });\r\n\r\n  const handleScroll = () => {\r\n    let st = window.scrollY //目前距離頂部位置\r\n    if(st < lastScrollY) {\r\n      setIsHide(false)\r\n    }else if(st > lastScrollY) {\r\n      setIsHide(true)\r\n    }\r\n    lastScrollY = st\r\n  }\r\n\r\n    window.addEventListener('scroll', () => {  \r\n      handleScroll()\r\n    });\r\n\r\n    useEffect(() => {\r\n      function getFavorite() {\r\n        const movieRef = ref(db, 'favorite/' + user.uid)\r\n        onValue(movieRef, (snapshot) => {\r\n          const data = snapshot.val()\r\n          setUserFavorite(data)\r\n        });\r\n      }\r\n    \r\n        if(user){\r\n          getFavorite()\r\n        }\r\n    }, [user])\r\n  return (\r\n    <AuthContext.Provider value={{\r\n      user,\r\n      setUser,\r\n      userFavorite\r\n    }}>\r\n    <div className=\"App\">\r\n      <Router>\r\n        <Header className=\"header\" isHide={isHide}/>\r\n          <Switch>\r\n          <Route exact path=\"/\">\r\n              <HomePage />\r\n            </Route>\r\n            <Route exact path=\"/movie/:id\">\r\n              <MovieDetailPage />\r\n            </Route>\r\n            <Route exact path=\"/search/genre/:id\">\r\n              <SearchGenrePage />\r\n            </Route>\r\n            <Route exact path=\"/search/movie/:query\">\r\n              <SearchPage />\r\n            </Route>\r\n            <Route exact path=\"/credit/:id\">\r\n              <CreditPage />\r\n            </Route>\r\n            <Route exact path=\"/login\">\r\n              {!user ? <LoginPage /> : <Redirect to=\"/\" />}      \r\n            </Route>\r\n            <Route exact path=\"/register\">\r\n              <RegisterPage />\r\n            </Route>\r\n            <Route exact path=\"/member\">\r\n              <MemberPage />\r\n            </Route>\r\n            <Route exact path=\"/about\">\r\n              <AboutPage />\r\n            </Route>\r\n          </Switch>\r\n          <Footer />\r\n      </Router>\r\n    </div>\r\n    </AuthContext.Provider>\r\n\r\n    \r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport SimpleReactLightbox from 'simple-react-lightbox'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <SimpleReactLightbox>\r\n    <App />\r\n    </SimpleReactLightbox>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}